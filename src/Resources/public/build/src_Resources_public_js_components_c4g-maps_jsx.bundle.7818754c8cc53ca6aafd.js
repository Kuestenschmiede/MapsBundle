/*! For license information please see src_Resources_public_js_components_c4g-maps_jsx.bundle.7818754c8cc53ca6aafd.js.LICENSE.txt */
"use strict";(self.webpackChunkmapsbundle=self.webpackChunkmapsbundle||[]).push([["src_Resources_public_js_components_c4g-maps_jsx","src_Resources_public_js_components_c4g-titlebar_jsx"],{"./src/Resources/public/js/c4g-baselayer-controller.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.OSM_REL_ATTRIBUTION=t.C4gBaselayerController=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=o("./src/Resources/public/js/c4g-baselayer.js"),l=o("./src/Resources/public/js/c4g-overlay.js"),i=o("./src/Resources/public/js/c4g-maps-config.js"),c=o("./src/Resources/public/js/c4g-maps-utils.js"),u=r(o("./node_modules/ol/layer/Tile.js")),p=(r(o("./node_modules/ol/source/TileJSON.js")),o("./node_modules/ol/source.js")),d=(r(o("./node_modules/ol/source/VectorTile.js")),o("./node_modules/ol/layer.js")),m=r(o("./node_modules/ol/Collection.js")),h=r(o("./node_modules/olcs/lib/olcs/OLCesium.js")),y=(r(o("./node_modules/ol/layer/VectorTile.js")),r(o("./node_modules/ol-ext/source/GeoImage.js"))),f=r(o("./node_modules/ol/source/GeoTIFF.js")),g=r(o("./node_modules/ol/layer/WebGLTile.js")),_=r(o("./node_modules/ol/proj/Projection.js")),v=t.OSM_REL_ATTRIBUTION='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="noopener">OpenStreetMap</a> contributors.';t.C4gBaselayerController=function(){return(0,s.default)(function e(t){(0,a.default)(this,e),this.proxy=t,this.mapController=t.options.mapController,this.arrBaselayers={},this.baselayerIds=[],this.baseKeys=this.mapController.data.base_keys},[{key:"loadBaseLayers",value:function(){var e;e=this,jQuery.ajax(this.proxy.api_baselayer_url,{dataType:this.mapController.data.jsonp?"jsonp":"json"}).done(function(t){return t.baselayer&&(e.addBaseLayers(t.baselayer),c.utils.callHookFunctions(window.c4gMapsHooks.proxy_baselayer_loaded)),!0}).fail(function(){return console.warn("An error occured while trying to load the baselayers. Do you have configured a default profile with baselayers?"),e.mapController.spinner.hide(),!1}).always(function(){})}},{key:"addBaseLayers",value:function(e){var t,o,r;if(e.length>0)for(r=0;r<e.length;r+=1)o=(t=e[r]).id||c.utils.getUniqueId(),this.baselayerIds.push(o),this.arrBaselayers[o]||(this.arrBaselayers[o]=new n.C4gBaselayer(t,this)),(this.mapController.data.baselayer&&parseInt(o,10)===parseInt(this.mapController.data.baselayer,10)||this.mapController.data.default_baselayer&&parseInt(o,10)===parseInt(this.mapController.data.default_baselayer,10))&&this.showBaseLayer(o);this.mapController.state.activeBaselayerId||(e.length>0&&e[0].id?o=e[0].id:(o=0,this.baselayerIds.push(o),this.arrBaselayers[o]||(this.arrBaselayers[o]={id:0,name:"c4g_default",provider:"osm",style:"Mapnik"})),this.showBaseLayer(o)),this.proxy.baselayers_loaded=!0,c.utils.callHookFunctions(this.proxy.hook_baselayer_loaded,this.baselayerIds)}},{key:"createBaseLayer",value:function(e,t,o){var r,a={};e=e||{},window.isSecureContext&&(e.crossOrigin="anonymous");var s=1,n=this.mapController.data;if(n.cookie){s=0;var l=document.cookie.split(";");for(var i in l)l.hasOwnProperty(i)&&l[i].indexOf(n.cookie.name)>-1&&(!n.cookie.value||l[i].indexOf(n.cookie.value)>-1)&&(s=2)}var c="../../../"+this.mapController.data.dummyBaselayer,h=null;if(c&&(h=new p.XYZ({url:c})),h&&0===s)(a=new u.default).setSource(h);else switch(t.provider){case"custom":var b=!0;t.url?(e.url=t.url,b=!1):t.urls&&(e.urls=t.urls,b=!1),t.attribution&&(e.attributions=t.attribution),b?console.warn("custom url(s) missing -> switch to default"):a=new u.default({source:new p.XYZ(e),extent:t.extend});break;case"osm":if(o.osm[t.style])a=new u.default({source:new p.OSM(jQuery.extend(o.osm[t.style],e))});else if("osm_custom"===t.style){var C=!0;t.url?(e.url=t.url,C=!1):t.urls&&(e.urls=t.urls,C=!1),C?console.warn("custom url(s) missing -> switch to default"):a=new u.default({source:new p.XYZ(e)})}else console.warn("unsupported osm-style -> switch to default");break;case"stadiaMaps":var R,S;if(o.stadiaMaps[t.style])if("Watercolor"===t.style?(a=new d.Group({layers:[new u.default,new u.default]}),R=new p.StadiaMaps({layer:"stamen_watercolor"}),S=new p.StadiaMaps({layer:"stamen_terrain_labels"})):(a=new u.default,R=new p.StadiaMaps(jQuery.extend(o.stadiaMaps[t.style]))),R.apiKey=t.api_key,a instanceof d.Group){var E=a.getLayers().getArray();E[0].setSource(R),E[1].setSource(S)}else a.setSource(R);else console.warn("unsupported osm-style -> switch to default");break;case"con4gisIo":if(this.baseKeys[t.id]){var O=this.baseKeys[t.id];e.url=t.url.replace("{key}",O.key),e.attributions=O.attribution+" "+e.attributions;var w=new p.XYZ(e);(a=new u.default).setSource(w)}break;case"mapbox":t.api_key&&t.app_id&&t.mapbox_type?(a=new u.default,"Mapbox"===t.mapbox_type?(e.url=t.url+t.app_id+"/tiles/{z}/{x}/{y}?access_token="+t.api_key,r=new p.XYZ(jQuery.extend(o.mapbox[t.mapbox_type],e))):(e.url=t.url_classic+t.app_id+"/{z}/{x}/{y}.png?access_token="+t.api_key,r=new p.XYZ(jQuery.extend(o.mapbox[t.mapbox_type],e))),a.setSource(r)):t.hide_in_be?(e.url="con4gis/baseLayerTileService/"+t.id+"/{z}/{x}/{y}",a=new u.default({source:new p.XYZ(jQuery.extend(o.mapbox[t.mapbox_type],e))})):console.warn("wrong mapbox configuration!");break;case"mapz":a=new u.default,r=new p.XYZ(jQuery.extend(o.mapz,e)),a.setSource(r);break;case"otm":a=new u.default,r=new p.XYZ(jQuery.extend(o.otm,e)),a.setSource(r);break;case"klokan":console.warn("wrong klokan configuration!");break;case"here":t.api_key&&t.app_id&&t.here_type?("normal"===t.style?e.url="https://{1-4}.base.maps.cit.api.here.com/maptile/2.1/maptile/newest/normal.day/{z}/{x}/{y}/256/png?app_id="+t.app_id+"&app_code="+t.api_key:"transit"===t.style?e.url="https://{1-4}.base.maps.cit.api.here.com/maptile/2.1/maptile/newest/normal.day.transit/{z}/{x}/{y}/256/png?app_id="+t.app_id+"&app_code="+t.api_key:"pedestrian"===t.style?e.url="https://{1-4}.base.maps.cit.api.here.com/maptile/2.1/maptile/newest/pedestrian.day/{z}/{x}/{y}/256/png?app_id="+t.app_id+"&app_code="+t.api_key:"terrain"===t.style?e.url="https://{1-4}.aerial.maps.cit.api.here.com/maptile/2.1/maptile/newest/terrain.day/{z}/{x}/{y}/256/png?app_id="+t.app_id+"&app_code="+t.api_key:"satellite"===t.style?e.url="https://{1-4}.aerial.maps.cit.api.here.com/maptile/2.1/maptile/newest/satellite.day/{z}/{x}/{y}/256/png?app_id="+t.app_id+"&app_code="+t.api_key:"hybrid"===t.style&&(e.url="https://{1-4}.aerial.maps.cit.api.here.com/maptile/2.1/maptile/newest/hybrid.day/{z}/{x}/{y}/256/png?app_id="+t.app_id+"&app_code="+t.api_key),r=new p.XYZ(jQuery.extend(o.here[t.here_type],e)),(a=new u.default({preload:1/0})).setSource(r)):t.hide_in_be?(e.url=e.url="con4gis/baseLayerTileService/"+t.id+"/{z}/{x}/{y}",a=new u.default({source:new p.XYZ(jQuery.extend(o.mapbox[t.here_type],e))})):console.warn("wrong HERE configuration!");break;case"thunder":t.api_key&&t.thunderforest_type?(t.style&&(e.url="https://tile.thunderforest.com/"+t.style+"/{z}/{x}/{y}.png?apikey="+t.api_key),a=new u.default,r=new p.XYZ(jQuery.extend(o.thunderforest[t.thunderforest_type],e)),a.setSource(r)):t.hide_in_be?(e.url="con4gis/baseLayerTileService/"+t.id+"/{z}/{x}/{y}",a=new u.default({source:new p.XYZ(jQuery.extend(o.mapbox[t.thunderforest_type],e))})):console.warn("wrong Thunderforest configuration!");break;case"google":console.warn("google-maps are currently unsupported");break;case"bing":t.api_key&&t.style?(a=new u.default,r=new p.BingMaps({culture:navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,key:t.api_key,imagerySet:t.style}),a.setSource(r)):console.warn("wrong bing-key or invalid imagery-set!");break;case"wms":a=-1!==t.url.indexOf("https")?new u.default({source:new p.TileWMS({url:t.url,params:{LAYERS:t.params.layers,VERSION:t.params.version,TRANSPARENT:t.params.transparent},gutter:t.gutter,attributions:t.attribution+" "+v,crossOrigin:"anonymous"})}):new u.default({source:new p.TileWMS({url:t.url,params:{LAYERS:t.params.layers,VERSION:t.params.version,TRANSPARENT:t.params.transparent},gutter:t.gutter,attributions:t.attribution+" "+v})});break;case"image":var T=new _.default({code:"image",units:"pixels",extent:t.extent?t.extent:[0,0,1920,1080]});a=new d.Image({source:new p.ImageStatic({url:t.imageSrc,imageExtent:t.extent?t.extent:[0,0,1920,1080],projection:T})});break;case"geoimage":var k=JSON.parse(t.geoImageJson);k.url=t.imageSrc?t.imageSrc:arrSource.url,a=new d.Image(jQuery.extend({source:new y.default(k)},e));break;case"geotiff":var I=[{url:t.imageSrc?t.imageSrc:""}];a=new g.default(jQuery.extend({source:new f.default({sources:I,nodata:0})},e));break;case"owm":a=new u.default({source:new p.XYZ({url:t.url+t.app_id+"/{z}/{x}/{y}?hash="+t.api_key,attributions:t.attribution+" "+v})});break;case"group":var L=[];for(var j in t.layerGroup)if(t.layerGroup.hasOwnProperty(j)){var P={};P=this.getAttributions(P,t.layerGroup[j],o);var x=this.createBaseLayer(P,t.layerGroup[j],o),A=this.proxy.options.mapController.map.getView().getResolutionForZoom(t.layerGroup[j].minZoom),F=this.proxy.options.mapController.map.getView().getResolutionForZoom(t.layerGroup[j].maxZoom);x.setMinResolution(F),x.setMaxResolution(A),L.push(x)}a=new d.Group({layers:L});break;default:console.warn("unsupported provider")}if(t.consentId)if("undefined"!=typeof klaro&&klaro.getManager&&klaro.getManager()){var N,D=klaro.getManager();if(a instanceof u.default||a instanceof g.default)r=a.getSource(),D.getConsent(t.consentId)||a.setSource(h),N={update:function(e,o,s){s[t.consentId]?a.setSource(r):a.setSource(h)}};else if(a instanceof d.Group){var U=a.getLayers();D.getConsent(t.consentId)||a.setLayers(new m.default([new u.default({source:h})])),N={update:function(e,o,r){r[t.consentId]?a.setLayers(U):a.setLayers(new m.default([new u.default({source:h})]))}}}D.watch(N)}else if("undefined"!=typeof HofffConsentManager)if(a instanceof u.default||a instanceof g.default)r=a.getSource(),HofffConsentManager.addEventListener("consent:accepted",function(e){e.consentId==t.consentId&&a.setSource(r)}),HofffConsentManager.addEventListener("consent:revoked",function(e){e.consentId==t.consentId&&a.setSource(h)}),HofffConsentManager.requiresConsent(t.consentId)||a.setSource(h);else if(a instanceof d.Group){var M=a.getLayers();HofffConsentManager.addEventListener("consent:accepted",function(e){e.consentId==t.consentId&&a.setLayers(M)}),HofffConsentManager.addEventListener("consent:revoked",function(e){e.consentId==t.consentId&&a.setLayers(new m.default)}),HofffConsentManager.requiresConsent(t.consentId)||a.setLayers(new m.default)}return(a instanceof u.default||a instanceof g.default)&&a.setZIndex(-2),a}},{key:"filterLayersForBaselayer",value:function(e){var t=this.proxy.layerController.arrLayers;for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];if(r){var a=!1;if("all"===r.activeForBaselayers||r.renderSpecial)continue;r.activeForBaselayers&&(a=!!r.activeForBaselayers.includes(e)),a?(t[o].display=!0,this.proxy.layerController&&this.proxy.layerController.show(o)):(t[o].display=!1,this.proxy.layerController&&this.proxy.layerController.hide(o))}}}},{key:"getAttributions",value:function(e,t,o){var r;if(t.attribution)e.attributions?e.attributions=e.attributions+" "+t.attribution:e.attributions=v+" "+t.attribution;else if(!e.attributions)switch(t.provider){case"osm":o.osm[t.style]?e.attributions=o.osm[t.style].attributions:e.attributions=v;break;case"stadiaMaps":e.attributions=o.stadiaMaps[t.style].attributions;break;case"mapbox":e.attributions=o.mapbox[t.mapbox_type].attributions;break;case"mapz":e.url=t.url,e.attributions=o.mapz.attributions;break;case"otm":e.url=t.url,e.attributions=o.otm.attributions;break;case"klokan":e.attributions=o.klokan[t.klokan_type].attributions;break;case"here":e.attributions=o.here[t.here_type].attributions;break;case"thunder":e.attributions=o.thunderforest[t.thunderforest_type].attributions;break;case"geoimage":case"geotiff":break;default:e.attributions=v}if(this.mapController.data&&this.mapController.data.attribution&&this.mapController.data.attribution.additional)if(e.attributions){var a=this.mapController.data.attribution.additional;for(n=!1,r=0;r<e.attributions.length;r+=1)if(e.attributions[r]===a){n=!0;break}n||(e.attributions=e.attributions+" "+a)}else e.attributions=this.mapController.data.attribution.additional;if(this.mapController.data.geosearch&&this.mapController.data&&this.mapController.data.attribution){var s=this.mapController.data.attribution.geosearch?this.mapController.data.attribution.geosearch:"",n=!1;for(e.attributions||(e.attributions=[]),r=0;r<e.attributions.length;r+=1)if(e.attributions[r]===s){n=!0;break}e.attributions=n?s:e.attributions+" "+s;var l=this.mapController.data.attribution.router?" - "+this.mapController.data.attribution.router:"";for(n=!1,e.attributions||(e.attributions=[]),r=0;r<e.attributions.length;r+=1)if(e.attributions[r]===l){n=!0;break}e.attributions=n?l:e.attributions+" "+l}return e}},{key:"showBaseLayer",value:function(e){var t,o,r,a,s,n,u,p,d=this,m=[],y=this.arrBaselayers[e];if(this.proxy.layers_loaded?this.filterLayersForBaselayer(e):this.proxy.hook_layer_loaded.push(function(){d.filterLayersForBaselayer(e)}),void 0===y||y.layer){if(void 0===y)return void console.log("config "+e+" not found")}else{if(m.osm=i.config.osm,m.stadiaMaps=i.config.stadiaMaps,m.otm=i.config.otm,m.mapbox=i.config.mapbox,m.mapz=i.config.mapz,m.klokan=i.config.klokan,m.here=i.config.here,m.thunderforest=i.config.thunderforest,n={},n=this.getAttributions(n,y,m),y.sorting&&(n.sort=y.sorting),y.minZoom&&y.minZoom>=0&&(n.minZoom=y.minZoom),y.maxZoom&&y.maxZoom>=0&&(n.maxZoom=y.maxZoom),s=this.createBaseLayer(n,y,m),y.hasOverlays)for(u=0;u<y.overlays.length;u++)y.overlayController.arrOverlays[y.overlays[u].id]||(y.overlayController.arrOverlays[y.overlays[u].id]=new l.C4gOverlay(y.overlays[u],this.mapController),y.overlayController.arrOverlays[y.overlays[u].id].layer=y.overlayController.showOverlayLayer(y.overlays[u].id));this.arrBaselayers[e].layer=s}if(this.mapController.state.activeBaselayerId&&this.mapController.state.activeBaselayerId!==e){var f=this.arrBaselayers[this.mapController.state.activeBaselayerId];if(f.overlayController&&f.overlayController.arrOverlays&&f.overlayController.arrOverlays.length>0)for(var g in f.overlayController.arrOverlays)f.overlayController.arrOverlays.hasOwnProperty(g)&&"length"!==g&&f.overlayController.arrOverlays[g].changeOpacity(0)}if((o=this.arrBaselayers[e]).overlayController&&o.overlayController.arrOverlays&&o.overlayController.arrOverlays.length>0)for(var _ in o.overlayController.arrOverlays)if(o.overlayController.arrOverlays.hasOwnProperty(_)&&"length"!==_){var v=o.overlayController.arrOverlays[_];v.changeOpacity(v.opacity)}if("baseMapsLayer"===(t=this.mapController.map.getLayers()).item(0).get("checkSum")&&(a=t.item(0).getLayers(),void 0!==this.arrBaselayers[e])&&((o=this.arrBaselayers[e].layer)&&(r=!0,a.forEach(function(e,t,a){e&&e===o?(e.setVisible(!0),r=!1):e?e.setVisible(!1):r=!1},this),r&&a.push(o)),(p=this.mapController.map.getView()).getZoom(),p.getCenter(),y.minZoom&&y.minZoom>=0||y.maxZoom&&y.maxZoom>=0)){y.minZoom&&p.getZoom()<y.minZoom?p.setZoom(y.minZoom):y.maxZoom&&p.getZoom()>y.maxZoom&&p.setZoom(y.maxZoom);var b=this.mapController.data;p.setMinZoom(parseInt(y.minZoom,10)||0),p.setMaxZoom(parseInt(y.maxZoom,10)||19),this.mapController.map.setView(p)}void 0!==y&&(this.mapController.setBaselayerId(y.id),c.utils.callHookFunctions(this.proxy.hook_baselayer_visibility,y),void 0!==y&&((b=this.mapController.data).cesium&&b.cesium.enable&&(b.cesium.always||y.cesium)?(this.ol3d||(this.ol3d=new h.default({map:this.mapController.map,createSynchronizers:!1})),this.ol3d.setEnabled(!0),jQuery(".c4g-control-container-top-left").hasClass("c4g-cesium-enabled")||jQuery(".c4g-control-container-top-left").addClass("c4g-cesium-enabled")):(this.ol3d&&this.ol3d.getEnabled()&&this.ol3d.setEnabled(!1),jQuery(".c4g-control-container-top-left").hasClass("c4g-cesium-enabled")&&jQuery(".c4g-control-container-top-left").removeClass("c4g-cesium-enabled"))))}}])}()},"./src/Resources/public/js/c4g-baselayer.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.C4gBaselayer=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=o("./src/Resources/public/js/c4g-overlay-controller.js");t.C4gBaselayer=(0,a.default)(function e(t,o){if((0,s.default)(this,e),this.id=t.id,this.pid=t.pid,this.name=t.name,this.display_name=t.display_name,this.provider=t.provider,this.osm_style=t.osm_style,this.osm_style_url1=t.osm_style_url1,this.osm_style_url2=t.osm_style_url2,this.osm_style_url3=t.osm_style_url3,this.osm_style_url4=t.osm_style_url4,this.osm_keyname=t.osm_keyname,this.mapbox_type=t.mapbox_type,this.bing_style=t.bing_style,this.style=t.style,this.attribution=t.attribution,this.infopage=t.infopage,this.params=t.params,this.wms_gutter=t.wms_gutter,this.minZoom=t.minZoom,this.maxZoom=t.maxZoom,this.protect_baselayer=t.protect_baselayer,this.permitted_groups=t.permitted_groups,this.api_key=t.apiKey?t.apiKey:t.api_key,this.app_id=t.app_id,this.thunderforest_type=t.thunderforest_type,this.here_type=t.here_type,this.cesium=t.cesium,this.hide_in_be=t.hide_in_be,this.url=t.url,this.urls=t.urls,this.klokan_type=t.klokan_type,this.style_url=t.style_url,this.hasOverlays=t.hasOverlays,this.overlays=t.overlays,this.imageSrc=t.image_src,this.geoImageJson=t.geoimage_json,this.preview_image=t.preview_image,t.layerGroup){var r=[];for(var a in t.layerGroup)t.layerGroup.hasOwnProperty(a)&&(r[a]=new e(t.layerGroup[a].entry),r[a].minZoom=t.layerGroup[a].minZoom,r[a].maxZoom=t.layerGroup[a].maxZoom);this.layerGroup=r}this.consentId=!!t.consentId&&t.consentId,this.overlayController=new n.C4gOverlayController(this),this.layer=!1,this.controller=o})},"./src/Resources/public/js/c4g-layer-controller.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.BetterLayerController=void 0;var s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=o("./node_modules/ol/source.js"),i=o("./node_modules/ol/proj.js"),c=r(o("./node_modules/ol/format/OSMXML.js")),u=r(o("./node_modules/ol/format/GML3.js")),p=r(o("./node_modules/ol/format/GML32.js")),d=r(o("./node_modules/ol/format/GML2.js")),m=o("./node_modules/ol/loadingstrategy.js"),h=o("./node_modules/ol/layer.js"),y=w(o("./node_modules/ol/format.js")),f=r(o("./node_modules/proj4/lib/index.js")),g=o("./node_modules/ol/proj/proj4.js"),_=r(o("./node_modules/ol/proj/Projection.js")),v=r(o("./node_modules/ol/Collection.js")),b=o("./src/Resources/public/js/c4g-maps-utils.js"),C=o("./node_modules/ol/style.js"),R=r(o("./node_modules/ol/style/Circle.js")),S=o("./node_modules/ol/geom.js"),E=r(o("./node_modules/ol/Feature.js")),O=w(o("./node_modules/ol/extent.js"));function w(e,t){if("function"==typeof WeakMap)var o=new WeakMap,r=new WeakMap;return(w=function(e,t){if(!t&&e&&e.__esModule)return e;var s,n,l={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return l;if(s=t?r:o){if(s.has(e))return s.get(e);s.set(e,l)}for(var i in e)"default"!==i&&{}.hasOwnProperty.call(e,i)&&((n=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,i))&&(n.get||n.set)?s(l,i,n):l[i]=e[i]);return l})(e,t)}var T=jQuery.extend({OSMXML:c.default,GML2:d.default,GML32:p.default,GML3:u.default},y);t.BetterLayerController=function(){return(0,n.default)(function e(t){(0,s.default)(this,e),this.handleZoom=this.handleZoom.bind(this),this.geometryFunction=this.geometryFunction.bind(this);var o=this;this.proxy=t,this.loaders=[],this.controllers={},this.arrLocstyles=[],this.objIds={},this.currentZoomLevel=0,this.extent={maxX:-1/0,maxY:-1/0,minX:1/0,minY:1/0},this.mapController=t.options.mapController,this.vectorCollection=new v.default,this.loaderFunction=function(e,t,r){var a=function(){if(o.loaders.hasOwnProperty(s)){var a=o.loaders[s];if(a.preventLoading)a.arrExtents.push(e);else if(a.params||a.url){var n=o.objLayers.find(function(e){return e.id==a.layerId})||{};o.performOvp({url:a.url,params:a.params,locstyleId:a.locstyle,chain:a.chain,layer:n},{extent:e,resolution:t,projection:r})}else o.performOwnData(a,{extent:e,resolution:t,projection:r},function(e){for(var t=[],r=o.objLayers.find(function(e){return e.id==a.layerId})||{},s=0;s<e.length;s++){var n=e[s],l=o.parseOwnData(n,r);t.push(l)}o.addFeatures(t,a.chain),o.mapController.setObjLayers(o.arrLayers)})}};for(var s in o.loaders)a()},this.vectorSource=new l.Vector({features:this.vectorCollection,loader:this.loaderFunction,strategy:m.bbox}),this.vectorSources=[],this.clusterStyleFunction=function(e,t){var r=!1,a=[];if(e&&e.get&&e.get("features")){var s=e.get("features");r=s.length,e=s.length>0?s[0]:null}if(e&&e.getStyle&&e.getStyle())a=e.getStyle();else{var n=e?e.get("locstyle"):null;if(!n&&e&&e.get("locationStyle")&&(n=e.get("locationStyle")),!n&&e&&e.get("layerId")){var l=o.objLayers.find(function(t){return t.id==e.get("layerId")});l&&(n=l.locstyle)}if(n&&o.proxy.locationStyleController.arrLocStyles&&o.proxy.locationStyleController.arrLocStyles[n]){o.proxy.locationStyleController.arrLocStyles[n].style||(o.proxy.locationStyleController.arrLocStyles[n].style=o.proxy.locationStyleController.arrLocStyles[n].getStyleFunction());var i=o.proxy.locationStyleController.arrLocStyles[n].style;a="function"==typeof i?i(e,t,!1):o.proxy.locationStyleController.arrLocStyles[n].style}}if((!a||Array.isArray(a)&&0===a.length)&&(r&&1!==r||(a=[new C.Style({image:new R.default({radius:5,fill:new C.Fill({color:"red"}),stroke:new C.Stroke({color:"white",width:2})})})])),r>1&&a&&Array.isArray(a)){var c=0;if(e&&a[0]&&a[0].setZIndex&&e.get("zindex")&&(c+=e.get("zindex")),e&&a[0]&&a[0].setZIndex){var u=e.getGeometry()?e.getGeometry().clone().transform("EPSG:3857","EPSG:4326").getCoordinates():null;u&&Array.isArray(u)&&(u="number"==typeof u[0]?u:Array.isArray(u[0])?u[0]:Array.isArray(u[0][0])?u[0][0]:u)&&"number"==typeof u[1]&&(c+=100-u[1]),a[0].setZIndex(c)}var p=[0,0],d=1;if(a[0]){if(a[0].getImage()&&a[0].getImage().getRadius&&"function"==typeof a[0].getImage().getRadius){var m=parseInt(a[0].getImage().getRadius(),10);m&&(p=[-m,m])}else a[0].getImage()&&a[0].getImage().getAnchor&&"function"==typeof a[0].getImage().getAnchor&&(p=a[0].getImage().getAnchor()||[0,0]);if(a[0].getImage()&&a[0].getImage().getScale()&&1!==a[0].getImage().getScale()&&(d=a[0].getImage().getScale(),p=[p[0]*d,p[1]*d]),o.proxy.mapData.cluster_fillcolor){var h=(r-1)/o.vectorCollection.getLength();h!==1/0&&(d+=h)}}var y=b.utils.getRgbaFromHexAndOpacity(o.proxy.mapData.cluster_fillcolor,{unit:"%",value:70}),f=o.proxy.mapData.cluster_fontcolor;if(e&&e.get("cluster_fillcolor")&&(y=b.utils.getRgbaFromHexAndOpacity(e.get("cluster_fillcolor"),{unit:"%",value:70})),e&&e.get("cluster_fontcolor")&&(f=e.get("cluster_fontcolor")),f=b.utils.getRgbaFromHexAndOpacity(f),a.push(new C.Style({text:new C.Text({text:"●",font:"60px sans-serif",offsetX:-1*p[0],offsetY:-1*p[1],scale:d,fill:new C.Fill({color:y})}),zIndex:c})),a.push(new C.Style({text:new C.Text({text:r.toString(),offsetX:-1*p[0],offsetY:-1*p[1]+3,scale:d,fill:new C.Fill({color:f})}),zIndex:c})),e&&e.get("markLocstyle")){var g,_="#"+o.proxy.mapData.starboard.colorZoomMarker,v=new C.Fill({color:_});g=a[0].getImage()&&a[0].getImage().getRadius&&a[0].getImage().getRadius()?parseInt(a[0].getImage().getRadius()):a[0].getImage()&&a[0].getImage().getIcon&&a[0].getImage()&&a[0].getImage().getIcon()&&(g=a[0].getImage().getIcon().getSize())?g[0]:25;var S=new C.Style({image:new R.default({fill:v,radius:g}),fill:v});a.push(S)}}else if(a&&Array.isArray(a)){var E=0;if(e&&a[0]&&a[0].setZIndex&&e.get("zindex")&&(E+=e.get("zindex")),e&&a[0]&&a[0].setZIndex){var O=e.getGeometry()?e.getGeometry().clone().transform("EPSG:3857","EPSG:4326").getCoordinates():null;O&&Array.isArray(O)&&(O="number"==typeof O[0]?O:Array.isArray(O[0])?O[0]:Array.isArray(O[0][0])?O[0][0]:O)&&"number"==typeof O[1]&&(E+=100-O[1]),a[0].setZIndex(E)}if(e&&e.get("markLocstyle")){var w,T="#"+o.proxy.mapData.starboard.colorZoomMarker,k=new C.Fill({color:T});w=a[0].getImage()&&a[0].getImage().getRadius&&a[0].getImage().getRadius()?parseInt(a[0].getImage().getRadius()):a[0].getImage()&&a[0].getImage().getIcon&&a[0].getImage()&&a[0].getImage().getIcon()&&(w=a[0].getImage().getIcon().getSize())?w[0]:25;var I=new C.Style({image:new R.default({fill:k,radius:w}),fill:k});a.push(I)}}return a},this.mapController.data.cluster_all&&(this.vectorSource=new l.Cluster({source:this.vectorSource,geometryFunction:this.geometryFunction,distance:this.mapController.data.cluster_distance||20})),this.vectorLayer=new h.Vector({source:this.vectorSource,zIndex:100}),this.vectorLayers=[],this.layerRequests={},this.ovpKey=this.mapController.data.ovp_key,window.c4gMapsHooks.hook_map_zoom=window.c4gMapsHooks.hook_map_zoom||[],window.c4gMapsHooks.hook_map_zoom.push(this.handleZoom)},[{key:"hide",value:function(e,t,o,r){var a,s;if(Array.isArray(t)?a=t:t instanceof h.Vector?s=t:a=this.objIds[o],a){if(this.mapController.map.getView().dispatchEvent({type:"change:resolution"}),e>=0){var n=this.loaders[e];n&&(this.loaders[e].preventLoading=!0,n.request&&n.request.abort())}if(a.length>0)for(var l in a)a.hasOwnProperty(l)&&this.vectorCollection.remove(a[l])}else s&&this.mapController.map.removeLayer(s)}},{key:"show",value:function(e,t,o,r){var a,s;if(Array.isArray(t))for(var n in a=t,this.currentZoomLevel++,a)a.hasOwnProperty(n)&&this.mapController.filter&&(a[n].set("zindex",this.currentZoomLevel),parseFloat(this.mapController.data.filterHandling)?this.mapController.filter.hideFeatureMulti(a[n]):this.mapController.filter.hideFeature(a[n]));else t instanceof h.Vector?(s=t,this.mapController.filter&&(parseFloat(this.mapController.data.filterHandling)?this.mapController.filter.filterLayerMulti(s):this.mapController.filter.filterLayer(s))):a=this.objIds[o];if(e>=0&&this.loaders[e]&&this.loaders[e].preventLoading){for(var l in this.loaders[e].preventLoading=!1,this.loaders[e].arrExtents)if(this.loaders[e].arrExtents.hasOwnProperty(l)&&this.vectorSource){var i=this.loaders[e].arrExtents[l];this.vectorSource.removeLoadedExtent(i)}this.loaders[e].arrExtents=[]}if(a){for(var c in a)if(a.hasOwnProperty(c)){var u=this.vectorCollection.getArray(),p=!1;for(var d in u)u[d].ol_uid==a[c].ol_uid&&(p=!0);p||this.vectorCollection.push(a[c])}}else s&&this.mapController.map.addLayer(s)}},{key:"zoomTo",value:function(e){var t,o,r=this;if(e.childs&&e.childs.length)for(var a in e.childs)e.childs.hasOwnProperty(a)&&(t=this.getChildsExtent(t,e.childs[a]));for(var s in o=e.features&&0!==e.features.length?e.features:this.objIds[e.id])if(o.hasOwnProperty(s)){var n=o[s].getGeometry()&&"function"==typeof o[s].getGeometry().getExtent?o[s].getGeometry().getExtent():null;n&&Array.isArray(n)&&n.length>=4&&(t=t?O.extend(t,n):n)}if(!t)return!1;var l=jQuery(".c4g-starboard-container").css("width");l?(l=l.split("."),l=Array.isArray(l)?l[0]:l,l=parseInt(l)+50):l=50;var i=parseInt(this.proxy.mapData.starboard.maxZoom)||22;return o&&1===o.length?this.mapController.map.getView().fit(t,{padding:[50,l,50,50],duration:500,maxZoom:i,callback:function(e){e&&window.setTimeout(function(){var e=o[0]&&o[0].getGeometry()?o[0].getGeometry().clone().getExtent():null;if(e&&Array.isArray(e)&&e.length>=4){var t=r.mapController.map.getPixelFromCoordinate([(e[0]+e[2])/2,(e[1]+e[3])/2]),a=r.mapController.map.getFeaturesAtPixel(t,{hitTolerance:10});a&&a[0]&&a[0].get("features")&&a[0].get("features").length>1&&a[0].getGeometry()&&"function"==typeof a[0].getGeometry().getCoordinates&&a[0].getGeometry().getCoordinates()&&r.mapController.map.dispatchEvent({type:"click",pixel:t})}},100)}}):this.mapController.map.getView().fit(t,{padding:[50,l,50,50],duration:500,maxZoom:i}),!0}},{key:"getChildsExtent",value:function(e,t){if(t.childs&&t.childs.length)for(var o in t.childs)t.childs.hasOwnProperty(o)&&(e=this.getChildsExtent(e,t.childs[o]));if(t.features&&t.features.length){for(var r in t.features)if(t.features.hasOwnProperty(r)){var a=t.features[r].getGeometry()&&"function"==typeof t.features[r].getGeometry().getExtent?t.features[r].getGeometry().getExtent():null;a&&Array.isArray(a)&&a.length>=4&&(e=e?O.extend(e,a):a)}}else e=this.getExtentForLayer(e,t.key);return e}},{key:"getExtentForLayer",value:function(e,t){var o=this.objIds[t];if(o&&o.length)for(var r in o)if(o.hasOwnProperty(r)){var a=o[r].getGeometry()&&"function"==typeof o[r].getGeometry().getExtent?o[r].getGeometry().getExtent():null;a&&Array.isArray(a)&&a.length>=4&&(e=e?O.extend(e,a):a)}return e}},{key:"setChildFeatureFlag",value:function(e,t,o){if(e.childs&&e.childs.length)for(var r in e.childs)e.childs.hasOwnProperty(r)&&this.setChildFeatureFlag(e.childs[r],t,o);if(e.features&&e.features.length)for(var a in e.features)e.features.hasOwnProperty(a)&&e.features[a].set(t,o)}},{key:"loadLayers",value:function(){var e=this;if(0===this.proxy.mapId)return window.setTimeout(function(){e.mapController.setLayersInitial([],[])},50),!1;jQuery.ajax(this.proxy.api_layer_url,{dataType:this.mapController.data.jsonp?"jsonp":"json"}).done(function(t){e.proxy.mapData.layers&&(t.layer=t.layer||{},e.proxy.mapData.layers.forEach(function(e){e.id&&(t.layer[e.id]=e)})),t.map=e.mapController.map,t.map.fromLonLat=i.fromLonLat,b.utils.callHookFunctions(window.c4gMapsHooks.hook_layer,t),b.utils.callHookFunctions(window.c4gMapsHooks.loaded,e.proxy),e.objLayers=t.layer;var o=[],r=[],a=[];for(var s in t.layer)if(t.layer.hasOwnProperty(s))if("startab"===t.layer[s].type){var n=[e.getStructureFromLayer(t.layer[s],a.length)];n.awesomeIcon=t.layer[s].awesomeicon,a.push(n)}else{var l=e.getStructureFromLayer(t.layer[s],o.length);l.hide_in_starboard?(o=l.childs?o.concat(l.childs):o,r=l.features?r.concat(l.features):r,l.vectorLayer&&(e.vectorLayers.push(l.vectorLayer),l.hide||l.greyed||-1===e.mapController.map.getLayers().getArray().indexOf(l.vectorLayer)&&e.mapController.map.addLayer(l.vectorLayer))):o.push(l)}var c=[];for(var u in o)o.hasOwnProperty(u)&&(c.push(e.getInitialStates(o[u])),r&&(r=r.concat(e.getFeaturesFromStruct(o[u]))));var p=[];for(var d in a)a.hasOwnProperty(d)&&p.push(e.getInitialStates(a[d][0]));if(e.arrLayers=o,e.proxy.locationStyleController.loadLocationStyles(e.arrLocstyles,{done:function(t){e.mapController.setLocStyles(t,function(){window.setTimeout(function(){var t=e.mapController.map.getView().getZoom();e.mapController.map.getView().setZoom(t+.265)},100),window.setTimeout(function(){var t=e.mapController.map.getView().getZoom();e.mapController.map.getView().setZoom(t-.265)},300)})}}),r&&Array.isArray(r)){var m=e.vectorCollection.getArray(),h=new Set;m.forEach(function(e){"function"==typeof e.getId&&e.getId()&&h.add(e.getId())});var y=r.filter(function(e){return-1===m.indexOf(e)&&("function"!=typeof e.getId||!e.getId()||!h.has(e.getId()))&&(!e.ol_uid||m.every(function(t){return t.ol_uid!==e.ol_uid}))});e.vectorCollection.extend(y)}if(-1===e.mapController.map.getLayers().getArray().indexOf(e.vectorLayer)&&e.mapController.map.addLayer(e.vectorLayer),e.mapController.setLayersInitial(e.arrLayers,c),e.mapController.setTabLayers(a,p),"LOCATIONS"===e.proxy.mapData.calc_extent||"CENTERLOCS"===e.proxy.mapData.calc_extent){var f=r;if(!f||0===f.length)for(var g in f=[],e.objIds)e.objIds.hasOwnProperty(g)&&(f=f.concat(e.objIds[g]));if(e.extent&&e.extent.maxX!==1/0&&e.extent.maxX!==-1/0){var _=e.mapController.map.getView(),v=[parseInt(e.mapController.props.mapData.min_gap,10),parseInt(e.mapController.props.mapData.min_gap,10),parseInt(e.mapController.props.mapData.min_gap,10),parseInt(e.mapController.props.mapData.min_gap,10)],C=[e.extent.minX,e.extent.minY,e.extent.maxX,e.extent.maxY];"CENTERLOCS"===e.proxy.mapData.calc_extent?_.fit(C,{maxZoom:e.mapController.data.center.zoom}):_.fit(C,{padding:v})}}return b.utils.callHookFunctions(window.c4gMapsHooks.layer_loaded,e),e.proxy.layers_loaded=!0,!0}).fail(function(){return console.warn("An error occured while trying to load the layers..."),!1}).always(function(){})}},{key:"getInitialStates",value:function(e){var t=[];if(e.childs&&e.childs.length>0)for(var o in e.childs)e.childs.hasOwnProperty(o)&&t.push(this.getInitialStates(e.childs[o]));return this.mapController.map.getView().getZoom(),{active:!e.hide,collapsed:!parseFloat(e.initial_opened),greyed:e.zoom&&!this.compareZoom(e.zoom),id:e.id,childStates:t,cssClass:e.cssClass}}},{key:"getFeaturesFromStruct",value:function(e){var t=[],o=(this.mapController.map.getView().getZoom(),e.zoom&&!this.compareZoom(e.zoom));if(e.childs&&e.childs.length>0)for(var r in e.childs)e.childs.hasOwnProperty(r)&&(t=t.concat(this.getFeaturesFromStruct(e.childs[r])));return!e.features||o||e.hide||(t=t.concat(e.features)),t}},{key:"getStructureFromLayer",value:function(e,t){var o,r,a=this,s=this,n=!1,c=[],u=[],p=!!e.hide;s.mapController.data.layers&&s.mapController.data.layers.length>0&&(p=!("string"==typeof s.mapController.data.layers||s.mapController.data.layers instanceof String?s.mapController.data.layers.split(","):s.mapController.data.layers).find(function(t){return t==e.id})&&"current_geojson"!==e.id),e.activeForBaselayers&&"all"!==e.activeForBaselayers&&(p=!e.activeForBaselayers.includes(s.mapController.state.activeBaselayerId||s.mapController.data.default_baselayer));var d=e.locstyle;if(e.content&&e.content.length>0&&(c=this.getFeaturesForLayer(e),d=e.locstyle||e.content[0].locationStyle),d&&"0"!==d&&-1===this.arrLocstyles.findIndex(function(e){return e===d})&&this.arrLocstyles.push(d),e.async_content&&0!=e.async_content&&!e.excludeFromSingleLayer){var y,v,R="",S=0,E="",O=!1,w=!1,k=e.id;if(e.content&&e.content[0]&&e.content[0].data){var I=e.content[0].data;R=I.url,n=I.popup,y=I.hover_location,v=I.hover_style,E=I.params,S=e.locstyle}e.content&&e.content[0]&&e.content[0].settings&&(O=e.content[0].settings.forceNodes,w=!!e.content[0].settings.showAdditionalGeometries),S&&"0"!==S&&-1===this.arrLocstyles.findIndex(function(e){return e===S})&&this.arrLocstyles.push(S),r=this.loaders.length,this.loaders.push({chain:t,url:R,preventLoading:p,forceNodes:O,arrExtents:[],popup:n,showAddGeoms:w,locstyleId:S,hover_location:y,hover_style:v,params:E,layerId:k})}if(e.childs&&e.childs.length>0){for(var L in e.childs)if(e.childs.hasOwnProperty(L)){var j=t+","+u.length,P=this.getStructureFromLayer(e.childs[L],j);P.hide_in_starboard?(u=P.childs?u.concat(P.childs):u,c=P.features?c.concat(P.features):c,this.mapController.filter&&P.vectorLayer&&(parseFloat(this.mapController.data.filterHandling)?this.mapController.filter.filterLayerMulti(P.vectorLayer):this.mapController.filter.filterLayer(P.vectorLayer))):u.push(P)}u.filter(function(e,t){return t===u.findIndex(function(t){return e.id===t.id})})}else if(e.split_geojson){var x=e.geojson_attributes.split(",")[0],A=!!e.geojson_zoom;for(var F in c)c.hasOwnProperty(F)&&u.push({features:[c[F]],vectorLayer:!1,zoom:e.zoom,initial_opened:e.initial_opened,locstyle:d,zoomTo:A,activeForBaselayers:e.activeForBaselayers,id:c[F].ol_uid,key:e.key,name:c[F].get(x),hide:p,childs:[],cssClass:e.cssClass});c=[]}if(e.excludeFromSingleLayer){var N=!1,D=new l.Vector;if(e.async_content&&"0"!==e.async_content){var U="table"===e.type||e.content&&e.content[0].settings&&e.content[0].settings.boundingBox?m.bbox:m.all;D=new l.Vector({strategy:U});var M=this,G=function(t,o,r){if(e.content&&e.content[0].settings&&e.content[0].settings.boundingBox&&(t[0]===1/0||t[0]===-1/0))D.removeLoadedExtent();else if("overpass"===e.type){var a=e.content[0].data;M.performOvp({url:a.url,layerId:e.id,layer:e,vectorSource:D,params:a.params,locstyleId:e.locstyle},{extent:t,resolution:o,projection:r})}else if("table"===e.type)M.performOwnData({layerId:e.id,locstyleId:e.locstyle},{extent:t,resolution:o,projection:r},function(t){for(var o=[],r=0;r<t.length;r++){var a=t[r],s=M.parseOwnData(a,e);o.push(s)}D instanceof l.Cluster?D.getSource().addFeatures(o):D.addFeatures(o)});else if(e.content&&e.content[0]&&e.content[0].data){var s=e.content[0];M.performOtherData(s,function(t){t.json().then(function(t){if(D.clear(),T[s.format]){var o=new T[s.format]({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).readFeatures(t);if(e.split_geojson){var r=e.geojson_attributes.split(",")[0];e.childs=[];var a=M.arrLayers,n=M.mapController.state.arrLayerStates,i=a.findIndex(function(t){return t.id===e.id});for(var c in n[i].childStates=[],a[i].childs=[],o)if(o.hasOwnProperty(c)){var u=e.locationStyle||s.locationStyle;o[c].get("locstyle")?u=o[c].get("locstyle"):o[c].set("locstyle",e.locationStyle||s.locationStyle),a[i].childs.push({features:[o[c]],vectorLayer:!1,zoom:e.zoom,initial_opened:e.initial_opened,locstyle:u,zoomTo:!0,activateWithBl:!1,id:o[c].get("positionId"),key:e.key,name:o[c].get(r),childs:[],cssClass:e.cssClass}),a[i].ignoreChilds=!0,n[i].childStates.push({active:!0,childStates:[],collapsed:!1,greyed:void 0,id:o[c].get("positionId")})}M.mapController.setLayersInitial(a,n)}else for(var p in o)o.hasOwnProperty(p)&&(o[p].get("locstyle")||o[p].set("locstyle",e.locationStyle||s.locationStyle));D instanceof l.Cluster?D.getSource().addFeatures(o):D.addFeatures(o)}})})}};if(D.setLoader(G),e.content&&e.content[0]&&e.content[0].settings&&e.content[0].settings.refresh){var z=e.content[0].settings.interval||1e4;window.setInterval(function(){G()},z)}}else if(c&&c.length)D.addFeatures(c);else{var H=e.content[0],B="EPSG:4326";if(N=function(t,o){var r=!1,a=[];if(t&&t.get&&t.get("features")){var n=t.get("features");r=n.length,t=n[0]}if(e&&e.locstyle&&"0"!==e.locstyle&&s.proxy.locationStyleController.arrLocStyles&&s.proxy.locationStyleController.arrLocStyles[e.locstyle]&&s.proxy.locationStyleController.arrLocStyles[e.locstyle]){s.proxy.locationStyleController.arrLocStyles[e.locstyle].style||(s.proxy.locationStyleController.arrLocStyles[e.locstyle].style=s.proxy.locationStyleController.arrLocStyles[e.locstyle].getStyleFunction());var l=s.proxy.locationStyleController.arrLocStyles[e.locstyle].style;a="function"==typeof l?l(t,o,!1):s.proxy.locationStyleController.arrLocStyles[locstyle].style}if(r>1&&a&&Array.isArray(a)){var i=[0,0];if(a[0])if(a[0].getImage()&&a[0].getImage().getRadius&&"function"==typeof a[0].getImage().getRadius){var c=parseInt(a[0].getImage().getRadius(),10);c&&(i=[-c,c])}else a[0].getImage()&&a[0].getImage().getAnchor&&"function"==typeof a[0].getImage().getAnchor&&(i=a[0].getImage().getAnchor()||[0,0]);var u=b.utils.getRgbaFromHexAndOpacity("4975A8",{unit:"%",value:70});a.push(new C.Style({text:new C.Text({text:"●",font:"60px sans-serif",offsetX:-1*i[0],offsetY:-1*i[1],fill:new C.Fill({color:u})})})),a.push(new C.Style({text:new C.Text({text:r.toString(),offsetX:-1*i[0],offsetY:-1*i[1]+3,fill:new C.Fill({color:"#FFFFFF"})})}))}return a},H){H.data&&H.data.properties&&H.data.properties.projection&&H.data.properties.projCode&&(f.default.defs(H.data.properties.projection,H.data.properties.projCode),(0,g.register)(f.default),B=new _.default({code:H.data.properties.projection}));var V=new T[H.format]({featureProjection:"EPSG:3857",dataProjection:B});if("wfs"===e.type){if(H.locstyleWfs){var Z=function(){if(H.locstyleWfs.hasOwnProperty(W)){var e=H.locstyleWfs[W].locstyle;-1===a.arrLocstyles.findIndex(function(t){return t===e})&&e&&a.arrLocstyles.push(e)}};for(var W in H.locstyleWfs)Z()}D=new l.Vector({format:new T.WFS({version:H.data.version,gmlFormat:V}),loader:function(e,t,o,r,a){o.getCode();var n=(0,i.transformExtent)(e,o,"EPSG:4326");n=[n[1],n[0],n[3],n[2]];var l=H.data.url+n.join(",");fetch(l,{headers:{"Content-Type":"application/json"}}).then(function(e){e.json().then(function(e){var t=V.readFeatures(e);for(var o in t)if(t.hasOwnProperty(o)){var a=t[o],n=s.getWfsStyle(a,H);a.set("locstyle",n);var l=a.getId();D.getFeatureById(l)||D.addFeature(a)}r(t)})}).catch(function(){D.removeLoadedExtent(e),a()})},strategy:m.bbox}),N=!1,n=!(!H.data||!H.data.popup)&&H.data.popup}else D=new l.Vector({format:V,url:H.data.url}),n=!(!H.data||!H.data.popup)&&H.data.popup}}e.hideInStarboard||this.vectorSources.push(D),e.cluster&&(D=new l.Cluster({source:D,geometryFunction:this.geometryFunction,distance:parseInt(e.cluster.distance,10)})),o=new h.Vector({source:D,style:N||this.clusterStyleFunction,zIndex:parseInt(e.zIndex||"0")}),this.vectorLayers.push(o),o.popup=n,s.proxy.hook_locstyles_loaded.push(function(e){o.changed()});var Q=e.zoom&&!this.compareZoom(e.zoom);p||Q||-1===this.mapController.map.getLayers().getArray().indexOf(o)&&this.mapController.map.addLayer(o),c&&c.forEach(function(e){var t=D.getFeatures();-1!==t.indexOf(e)||"function"==typeof e.getId&&e.getId()&&D.getFeatureById(e.getId())||e.ol_uid&&t.some(function(t){return t.ol_uid===e.ol_uid})||D.addFeature(e)}),c=!1}return e.hideInStarboard?{childs:u,features:c,vectorLayer:o,hide_in_starboard:!0}:{features:c,vectorLayer:o,loader:r,zoom:e.zoom,initial_opened:e.initial_opened,locstyle:d,activeForBaselayers:e.activeForBaselayers,popup:n||e.popup,id:e.id,key:e.key,name:e.name,tags:e.tags,hide:p,childs:u,zoomTo:e.zoomTo,cssClass:e.cssClass}}},{key:"getFeaturesForLayer",value:function(e){var t=this,o=[],r=function(){if(e.content.hasOwnProperty(a)){var r=e.content[a],s=r.data;if(s){var n="EPSG:4326";s.properties&&s.properties.projection&&s.properties.projCode&&(f.default.defs(s.properties.projection,s.properties.projCode),(0,g.register)(f.default),n=new _.default({code:s.properties.projection}));var l,i=e.content[a].type||e.type||"GeoJSON";try{l=new T[i]({featureProjection:"EPSG:3857",dataProjection:n})}catch(e){return console.error("Error creating format for type",i,e),0}if(!l)return console.error("Could not find format for type",i),0;var c=r.locationStyle||e.locstyle;if(c&&"0"!==c&&-1===t.arrLocstyles.findIndex(function(e){return e===c})&&t.arrLocstyles.push(c),"GeoJSON"===e.content[a].type||"GeoJSON"===e.type){if("FeatureCollection"===s.type){var u=function(){if(s.features.hasOwnProperty(p)){var e=l.readFeature(s.features[p]);e.get("locstyle")||e.set("locstyle",s.features[p].properties&&(s.features[p].properties.locstyle||s.features[p].properties.styleId||s.features[p].properties.locationStyle)||c);var a=e.get("locstyle");a&&"0"!==a&&-1===t.arrLocstyles.findIndex(function(e){return e===a})&&t.arrLocstyles.push(a),!e.get("zindex")&&s.features[p].properties&&s.features[p].properties.zindex&&e.set("zindex",s.features[p].properties.zindex),r.hover_location&&(e.set("hover_style",r.hover_style),e.set("hover_location",r.hover_location)),r.loc_linkurl&&e.set("loc_linkurl",r.loc_linkurl),s.properties&&(e.get("tooltip")||e.set("tooltip",s.properties.tooltip),e.get("label")||e.set("label",s.properties.label),e.get("popup")||e.set("popup",s.properties.popup)),o.push(e)}};for(var p in s.features)u()}else if(s&&s.type){var d=l.readFeature(s);d.get("locstyle")||d.set("locstyle",s.properties&&(s.properties.locstyle||s.properties.styleId||s.properties.locationStyle)||c);var m=d.get("locstyle");m&&"0"!==m&&-1===t.arrLocstyles.findIndex(function(e){return e===m})&&t.arrLocstyles.push(m),!d.get("zindex")&&s.properties&&s.properties.zindex&&d.set("zindex",s.properties.zindex),d.set("noFilter",e.noRealFilter),r.hover_location&&(d.set("hover_style",r.hover_style),d.set("hover_location",r.hover_location)),s.loc_linkurl&&d.set("loc_linkurl",s.loc_linkurl),o.push(d)}}else l&&fetch(s.url).then(function(e){e.text().then(function(e){var t=(new DOMParser).parseFromString(e,"text/xml"),r=l.readFeature(t.childNodes[0].outerHTML);for(var a in r)if(r.hasOwnProperty(a)){var n=r[a];n.set("locstyle",c),s.hover_location&&(n.set("hover_style",s.hover_style),n.set("hover_location",s.hover_location)),s.loc_linkurl&&n.set("loc_linkurl",s.loc_linkurl),o.push(n)}})})}}};for(var a in e.content)r();if("LOCATIONS"===this.proxy.mapData.calc_extent||"CENTERLOCS"===this.proxy.mapData.calc_extent){var s=o;for(var n in s&&0!==s.length||(s=this.objIds[e.id]||[]),s)if(s.hasOwnProperty(n)&&s[n].getGeometry()&&"function"==typeof s[n].getGeometry().getExtent){var l=s[n].getGeometry().getExtent();l&&Array.isArray(l)&&l.length>=4&&(this.extent.maxX<l[2]&&(this.extent.maxX=l[2]),this.extent.maxY<l[3]&&(this.extent.maxY=l[3]),this.extent.minX>l[0]&&(this.extent.minX=l[0]),this.extent.minY>l[1]&&(this.extent.minY=l[1]))}}return this.objIds.hasOwnProperty(e.id)?[]:(e.split_geojson||(this.objIds[e.id]=o),o)}},{key:"geometryFunction",value:function(e){if(!e||!e.getGeometry)return null;var t=e.getGeometry();if(t instanceof S.Point)return t;if(t&&"function"==typeof t.getInteriorPoint)return t.getInteriorPoint();if(t&&"function"==typeof t.getClosestPoint){if(this.mapController&&this.mapController.map&&this.mapController.map.getView()){var o=this.mapController.map.getView().getCenter();if(o)return new S.Point(t.getClosestPoint(o))}return null}return null}},{key:"performOvp",value:function(e,t){this.controllers[e.layerId]&&(this.controllers[e.layerId].abort(),delete this.controllers[e.layerId]);var o=this;this.controllers[e.layerId]=new AbortController;var r=this.controllers[e.layerId].signal,a=(0,i.transformExtent)(t.extent,t.projection,"EPSG:4326"),s="",n=e.url,l=decodeURIComponent(e.params);if(n){n.indexOf("{key}")>-1&&(n=n.replace("{key}",o.ovpKey));var c=l.indexOf("(bbox)")>=0?/\(bbox\)/g:/\{{bbox\}}/g;n+=n.includes("?")?"&":"?",l&&"<"===l.substr(0,1).trim()?(s='<bbox-query s="'+a[1]+'" n="'+a[3]+'" w="'+a[0]+'" e="'+a[2]+'"/>',n=(n+="data="+encodeURIComponent(l.replace(c,s))).replace("output=json","output=xml"),fetch(n,{signal:r}).then(function(t){t.text().then(function(t){o.parseOvpData(t,e)}).catch(function(e){console.log(e.message)})}).catch(function(e){e.code&&20!==e.code&&console.log("Fetch Error :-S",e.message)})):(s=a[1]+","+a[0]+","+a[3]+","+a[2],n+="data="+encodeURIComponent(l.replace(c,s).replace("out:json","out:xml")),fetch(n,{signal:r}).then(function(t){t.text().then(function(t){o.parseOvpData(t,e)}).catch(function(e){console.log(e.message)})}).catch(function(e){e.code&&20!==e.code&&console.log("Fetch Error :-S",e.message)}))}}},{key:"parseOvpData",value:function(e,t){var o,r=t.layer,a=r.content[0],s=a.data;if("string"!=typeof e)return!1;var n=e;if(!a.settings.showAdditionalGeometries){for(var i=(new DOMParser).parseFromString(e,"text/xml"),u=i.getElementsByTagName("way"),p=0;p<u.length;p++)for(var d=u[p],m=0;m<d.children.length;m++)for(var h=d.children[m].getAttribute("ref"),y=i.getElementById(h);y&&y.children.length>0;)y.removeChild(y.children[0]);n=(new XMLSerializer).serializeToString(i)}var f=new c.default;try{o=f.readFeatures(n,{featureProjection:"EPSG:3857"})}catch(e){console.warn("Can not read feature.")}if(s.popup)for(var g=0;g<o.length;g++){var _={};for(var v in s.popup)s.popup.hasOwnProperty(v)&&(_[v]=s.popup[v]);o[g].set("popup",_),o[g].set("noFilter",r.noRealFilter)}var b=r.content&&r.content[0].settings?r.content[0].settings:{};for(var C in o)o.hasOwnProperty(C)&&(o[C].getGeometry()&&"function"==typeof o[C].getGeometry().getType&&("Polygon"===o[C].getGeometry().getType()?(b.forceNodes&&"function"==typeof o[C].getGeometry().getInteriorPoint&&o[C].setGeometry(o[C].getGeometry().getInteriorPoint()),o[C].getId().includes("way")||o[C].set("osm_type","way")):"MultiPolygon"===o[C].getGeometry().getType()?(b.forceNodes&&Array.isArray(o[C].getGeometry())&&o[C].getGeometry()[0]&&"function"==typeof o[C].getGeometry()[0].getInteriorPoint&&o[C].setGeometry(o[C].getGeometry()[0].getInteriorPoint()),o[C].getId().includes("relation")||o[C].set("osm_type","relation")):"Point"===o[C].getGeometry().getType()&&(o[C].getId().includes("node")||o[C].set("osm_type","node"))),this.mapController.filter&&(parseFloat(this.mapController.data.filterHandling)?this.mapController.filter.hideFeatureMulti(o[C]):this.mapController.filter.hideFeature(o[C])),o[C].set("locstyle",r.locstyle),a.hover_location&&(o[C].set("hover_style",a.hover_style),o[C].set("hover_location",a.hover_location)),a.loc_linkurl&&o[C].set("loc_linkurl",a.loc_linkurl),a.cluster_fillcolor&&a.cluster_fontcolor&&(o[C].set("cluster_fillcolor",a.cluster_fillcolor),o[C].set("cluster_fontcolor",a.cluster_fontcolor)));t.chain||t.chain>-1?(this.addFeatures(o,t.chain),this.mapController.setObjLayers(this.arrLayers)):t.vectorSource instanceof l.Cluster?t.vectorSource.getSource().addFeatures(o):t.vectorSource.addFeatures(o)}},{key:"performOwnData",value:function(e,t,o){if(this.controllers[e.layerId]&&(this.controllers[e.layerId].abort(),delete this.controllers[e.layerId]),t.extent[0]===1/0||t.extent[0]===-1/0||t.extent[1]===1/0||t.extent[1]===-1/0||t.extent[2]===1/0||t.extent[2]===-1/0||t.extent[3]===1/0||t.extent[3]===-1/0)return!1;var r=(0,i.transformExtent)(t.extent,t.projection,"EPSG:4326"),a=r[0]+","+r[1]+";"+r[2]+","+r[3],s=this.proxy.api_layercontentdata_url+"/"+e.layerId+"/"+a;this.controllers[e.layerId]=new AbortController;var n=this.controllers[e.layerId].signal;fetch(s,{signal:n}).then(function(e){e.json().then(o).catch(function(e){console.log(e)})}).catch(function(e){e.code&&20!==e.code&&console.log("Fetch Error :-S",e.message)})}},{key:"performOtherData",value:function(e,t){var o=e.data;e.settings,fetch(o.url).then(function(e){t(e)}).catch(function(){console.log("Tell me why")})}},{key:"parseOwnData",value:function(e,t){var o=(0,i.transform)([parseFloat(e.geox),parseFloat(e.geoy)],"EPSG:4326","EPSG:3857"),r=new S.Point(o),a=new E.default(r);a.setId(e.id),a.set("noFilter",t.noRealFilter),a.set("hover_location",t.hover_location),a.set("hover_style",t.hover_style);var s=e.popup?e.popup:jQuery.extend({},t.popup);s&&s.content&&s.content.search&&s.content.search("itemId")&&(s.content=s.content.replace("itemId",e.id)),e.label&&a.set("label",e.label),e.tooltip&&a.set("tooltip",e.tooltip),e.loc_linkurl&&a.set("loc_linkurl",e.loc_linkurl),a.set("popup",s),a.set("zoom_onclick",t.zoom_onclick),a.set("tid",e.id);var n=e.locstyle||t.locstyle;return a.set("locstyle",n),t.cluster_fillcolor&&t.cluster_fontcolor&&(a.set("cluster_fillcolor",e.cluster_fillcolor),a.set("cluster_fontcolor",e.cluster_fontcolor)),this.mapController.filter&&(parseFloat(this.mapController.data.filterHandling)?this.mapController.filter.hideFeatureMulti(a):this.mapController.filter.hideFeature(a)),a}},{key:"addFeatures",value:function(e,t){var o,r,a=this,s=a.vectorCollection.getLength();if(e&&Array.isArray(e)){var n=a.vectorCollection.getArray(),l=new Set;n.forEach(function(e){"function"==typeof e.getId&&e.getId()&&l.add(e.getId())});var i=e.filter(function(e){return!(-1!==n.indexOf(e)||"function"==typeof e.getId&&e.getId()&&l.has(e.getId()))});a.vectorCollection.extend(i)}if(o=a.vectorCollection.getArray().slice(s),"string"==typeof t){var c=t.split(","),u=1;for(r=a.arrLayers[c[0]];r&&c[u];)r=r.childs[c[u]],u++}else r=a.arrLayers[t];r&&r.features?r.features=r.features.concat(o):r&&r.vectorLayer&&r.vectorLayer.getSource().getSource().addFeatures(e)}},{key:"handleZoom",value:function(e){var t=e.options.mapController,o=t.state.arrLayerStates,r=t.state.objLayers,a=t.map.getView().getZoom();for(var s in o)o.hasOwnProperty(s)&&r[s]&&(o[s]=this.handleZoomChilds(a,o[s],r[s]));this.mapController&&this.mapController.setLayerStates(o)}},{key:"handleZoomChilds",value:function(e,t,o){for(var r in t.childStates)t.childStates.hasOwnProperty(r)&&(t.childStates[r]=this.handleZoomChilds(e,t.childStates[r],o.childs[r]));var a=o.zoom&&!this.compareZoom(o.zoom);return t.greyed!==a&&(a||o.hide?this.hide(o.loader,o.features||o.vectorLayer):this.show(o.loader,o.features||o.vectorLayer)),t.greyed=a,t}},{key:"compareZoom",value:function(e){var t=this.mapController.map.getView().getZoom();return parseInt(e.min,10)<t&&parseInt(e.max,10)>t}},{key:"getWfsStyle",value:function(e,t){if(!e||!e.get)return t.locationStyle;var o=t.locstyleWfs;for(var r in o)if(o.hasOwnProperty(r)){var a=o[r],s=e.get(a.key);switch(a.compare){case"==":if(s==a.value)return a.locstyle;break;case">":if(s>a.value)return a.locstyle;break;case"<":if(s<a.value)return a.locstyle}}return t.locationStyle}}])}()},"./src/Resources/public/js/c4g-locationstyle-controller.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.C4gLocationStyleController=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/typeof.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=o("./src/Resources/public/js/c4g-locationstyle.js"),i=o("./src/Resources/public/js/c4g-maps-utils.js");function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=Array(t);o<t;o++)r[o]=e[o];return r}t.C4gLocationStyleController=function(){return(0,n.default)(function e(t){(0,s.default)(this,e),this.proxy=t,this.mapController=t.options.mapController,this.arrLocStyles={},this.resizeOnZoom=t.options.mapController.data.resizeLocstyles},[{key:"loadLocationStyles",value:function(e,t){var o,r,s={},n={},u=this,p=1;if(o=t&&"object"===(0,a.default)(t)?t:{},r=function(e,t){t&&(s[t]=!1,n[t]=!1),jQuery.ajax({dataType:u.proxy.options.mapController.data.jsonp?"jsonp":"json",url:u.proxy.api_locstyle_url,data:{ids:e}}).done(function(e){var r,a,s=!0;if(e.length>0){for(r=0;r<e.length;r+=1){a=e[r];var p=new l.C4gLocationStyle(a,u);u.arrLocStyles[a.id]=p}if(u.proxy.layerController.vectorLayer&&u.proxy.layerController.vectorLayer.setStyle(u.proxy.layerController.clusterStyleFunction),u.proxy.layerController.vectorLayers){var d,m=function(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(e){if("string"==typeof e)return c(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,n=!0,l=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){l=!0,s=e},f:function(){try{n||null==o.return||o.return()}finally{if(l)throw s}}}}(u.proxy.layerController.vectorLayers);try{for(m.s();!(d=m.n()).done;)d.value.changed()}catch(e){m.e(e)}finally{m.f()}}}if(t)for(var h in n[t]=!0,n)if(n.hasOwnProperty(h)&&!n[h]){s=!1;break}!o.done||"function"!=typeof o.done||t&&!s||(o.done(u),i.utils.callHookFunctions(u.proxy.hook_locstyles_loaded,{locstyleController:u})),u.proxy.layerController.vectorLayer&&u.proxy.layerController.vectorLayer.changed()}).always(function(e,r){var a=!0;if(t)for(var n in s[t]=!0,s)if(s.hasOwnProperty(n)&&!s[n]){a=!1;break}!o.always||"function"!=typeof o.always||t&&!a||o.always()}).fail(function(e,t,o){console.warn(o)})},(e=e.filter(function(e){return e&&"0"!==e&&0!==e})).length>100)for(;e.length>0;)r(e.splice(0,100),p),p++;else e.length>0&&r(e)}}])}()},"./src/Resources/public/js/c4g-locationstyle.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.C4gLocationStyle=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/typeof.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=o("./src/Resources/public/js/c4g-maps-utils.js"),i=o("./node_modules/ol/style.js"),c=o("./node_modules/ol/geom.js"),u=r(o("./node_modules/ol/style/Circle.js")),p=r(o("./node_modules/ol-ext/style/Photo.js"));t.C4gLocationStyle=function(){return(0,n.default)(function e(t,o){(0,s.default)(this,e),this.id=t.id,this.editor=this.getStyleEditorConfig(t),this.name=t.name,this.tooltip=t.tooltip,this.label=t.label,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.fnStyleFunction=t.style_function_js,this.fnStyleFunction&&"string"==typeof this.fnStyleFunction&&(this.fnStyleFunction=this.fnStyleFunction.replace(/ol.Style./gi,"window.olStyle."),this.fnStyleFunction=this.fnStyleFunction.replace(/ol.Geom./gi,"window.olStyle."),window.olStyle||(window.olStyle={Stroke:i.Stroke,Style:i.Style,Icon:i.Icon,Fill:i.Fill,Point:c.Point,CircleStyle:u.default,Circle:c.Circle,Text:i.Text})),this.controller=o,this.locStyleArr=t},[{key:"getStyleFunction",value:function(){var e,t,o,r,s,n,c,u,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e=this,p||(p=this.locStyleArr),r=new i.Stroke({color:l.utils.getRgbaFromHexAndOpacity(p.strokecolor[0],p.strokecolor[1]),width:parseInt(p.strokewidth.value?p.strokewidth.value:2,10)}),s=new i.Fill({color:l.utils.getRgbaFromHexAndOpacity(p.fillcolor[0],p.fillcolor[1])}),o=this.createImageStyle(p,r,s),t=function(t,d,m){var h,y,f=e.controller.mapController.map.getView().getZoom();if(parseInt(e.locStyleArr.maxzoom,10)&&parseInt(e.locStyleArr.maxzoom,10)<f)return null;if(parseInt(e.locStyleArr.minzoom,10)&&parseInt(e.locStyleArr.minzoom,10)>f)return null;if(m)return p.id;t||(t=this),h=[],y=t&&"function"==typeof t.get&&t.get("label")?t.get("label"):!!p.label&&p.label;var g=e.controller.mapController.data.default_label_color,_=e.getScaleFactor(p);if(y){p.label_outl_color&&p.label_outl_width.value&&(c=new i.Stroke({color:l.utils.getRgbaFromHexAndOpacity(p.label_outl_color||g,{unit:"%",value:100}),width:parseInt(p.label_outl_width.value,10)}),"1"===p.label_outl_box&&(u=new i.Fill({color:l.utils.getRgbaFromHexAndOpacity(p.label_outl_color||g,{unit:"%",value:100})}))),p.label_offset||(p.label_offset=[0,0,"px"]);var v=p.font_size&&"object"===(0,a.default)(p.font_size)&&null!==p.font_size?p.font_size.value:p.font_size?p.font_size:"13",b={text:y,font:(p.font_weight||"normal")+" "+(p.font_style||"normal")+" "+v+"px "+(p.font_family||"sans-serif"),offsetX:parseInt(p.label_offset[0]||0,10),offsetY:parseInt(p.label_offset[1]||0,10),textAlign:p.label_align_hor,textBaseline:p.label_align_ver,scale:_,fill:new i.Fill({color:l.utils.getRgbaFromHexAndOpacity(p.font_color[0]||g,p.font_color[1])}),stroke:c};"1"===p.label_outl_box&&(b.backgroundFill=u,b.backgroundStroke=c),n=new i.Text(b)}o&&0!==_&&o.setScale&&o.setScale(_);var C,R=!1,S=parseInt(e.locStyleArr.label_minzoom,10),E=parseInt(e.locStyleArr.label_maxzoom,10);if(f>=S&&(E>=f||0===E)&&(R=!0),y&&R?(t&&t.get&&"function"==typeof t.get&&t.get("zIndex")&&(C=t.get("zIndex")),h.push(new i.Style({image:o,text:n,stroke:r,fill:s,zIndex:C}))):h.push(new i.Style({image:o,stroke:r,fill:s})),p.line_arrows&&t&&"function"==typeof t.getGeometry&&"Point"!==t.getGeometry().getType()&&"function"==typeof t.getGeometry().forEachSegment){var O=e.createLineArrowStyles(p,t,r,s);h=h.concat(O)}return h},this.fnStyleFunction&&(t=Function("feature","data","map",this.fnStyleFunction)),t}},{key:"getScaleFactor",value:function(e){var t,o,r,a,s=0,n=this.controller.mapController.map.getView().getZoom(),l="cust_icon_svgphoto".includes(e.styletype)?parseFloat(e.icon_scale):1;return e.icon_resize_zoom?(t=parseInt(e.icon_resize_src_zoom,10),o=parseFloat(e.icon_resize_scale_factor),r=parseFloat(e.icon_resize_min_scale),a=parseFloat(e.icon_resize_max_scale)):this.controller.resizeOnZoom&&(t=parseInt(this.controller.resizeOnZoom.srcZoom,10),o=parseFloat(this.controller.resizeOnZoom.scaleFactor),r=parseFloat(this.controller.resizeOnZoom.minScale),a=parseFloat(this.controller.resizeOnZoom.maxScale)),n>t?(s=l+o*(n-t))>a&&(s=a):n<t?(s=l-o*(t-n))<=r&&(s=r):s=l,s}},{key:"createImageStyle",value:function(e,t,o){var r;switch(e.styletype){case"square":r=new i.RegularShape({fill:o,stroke:t,points:4,radius:e.radius.value||10,angle:Math.PI/4});break;case"star":r=new i.RegularShape({fill:o,stroke:t,radius:e.radius.value||10,radius2:e.radius.value?Math.floor(.5*e.radius.value):4,points:5,angle:0});break;case"x":r=new i.RegularShape({stroke:t,points:4,radius:e.radius.value||10,radius2:0,angle:Math.PI/4});break;case"cross":r=new i.RegularShape({stroke:t,points:4,radius:e.radius.value||10,radius2:0,angle:0});break;case"triangle":r=new i.RegularShape({fill:o,stroke:t,points:3,radius:e.radius.value||10,rotation:Math.PI/4,angle:0});break;case"ol_icon":case"cust_icon":if(e.icon_src){var a,s,n,l;a=e.icon_size[0]*e.icon_scale,s=e.icon_size[1]*e.icon_scale,n=e.icon_offset[0]*e.icon_scale,l=e.icon_offset[1]*e.icon_scale;var c=1/(parseInt(a)/(-1*parseInt(n))),d=1/(parseInt(s)/(-1*parseInt(l)));r=new i.Icon({anchor:[c,d],opacity:parseFloat(e.icon_opacity.value)/100,src:e.icon_src,scale:parseFloat(e.icon_scale),size:[parseInt(e.icon_size[0],10),parseInt(e.icon_size[1],10)]})}break;case"cust_icon_svg":if(e.svgSrc&&e.icon_scale&&e.icon_size){var m,h,y,f;m=e.icon_size[0],h=e.icon_size[1],y=parseFloat(e.icon_offset[0]),f=parseFloat(e.icon_offset[1]);var g=1/(parseInt(m)/(-1*parseInt(y))),_=1/(parseInt(h)/(-1*parseInt(f)));r=new i.Icon({anchor:[g,_],src:e.svgSrc,crossOrigin:"anonymous"})}break;case"photo":r=new p.default({kind:e.photoKind,crop:!0,opacity:parseFloat(e.icon_opacity.value,10)/100,radius:parseFloat(e.radius.value,10),shadow:!0,stroke:t,src:e.icon_src});break;default:r=new u.default({fill:o,stroke:t,radius:e.radius.value||7})}return r}},{key:"createLineArrowStyles",value:function(e,t,o,r){var a=this,s=[],n=e.line_arrows_radius?2*parseInt(e.line_arrows_radius.value,10):0,l=n+e.line_arrows_radius.unit;return t.getGeometry().forEachSegment(function(t,u){var p=parseInt(e.line_arrows_minzoom,10),d=a.controller.mapController.map.getPixelFromCoordinate(t),m=a.controller.mapController.map.getPixelFromCoordinate(u),h=Math.sqrt(Math.pow(m[1]-d[1],2)+Math.pow(m[0]-d[0],2));(p<0&&n+parseInt(e.strokewidth.value,10)<h||p>=0&&a.controller.mapController.map.getView().getZoom()>=p)&&(s.push(new i.Style({geometry:new c.Point(u),text:new i.Text({text:"ᐳ",font:l+" sans-serif",offsetX:0,offsetY:1,fill:r,stroke:o,textAlign:"right",rotateWithView:!0,rotation:-Math.atan2(u[1]-t[1],u[0]-t[0])})})),e.line_arrows_back&&s.push(new i.Style({geometry:new c.Point(t),text:new i.Text({text:"ᐳ",font:l+" sans-serif",offsetX:0,offsetY:-1,fill:r,stroke:o,textAlign:"right",rotateWithView:!0,rotation:-Math.atan2(t[1]-u[1],t[0]-u[0])})})))}),s}},{key:"getStyleEditorConfig",value:function(e){var t;return(t={}).collect=e.editor_collect||void 0,t.iconSrc=e.editor_icon||void 0,t.vars=e.editor_vars||void 0,t.sort=e.editor_sort||!1,t.sort&&(t.sort=parseInt(t.sort,10)||!1),t}}])}()},"./src/Resources/public/js/c4g-maps-config.js"(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.OSM_REL_ATTRIBUTION=void 0;var r=o("./node_modules/ol/format.js"),a=o("./node_modules/ol/tilegrid.js"),s=t.OSM_REL_ATTRIBUTION='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="noopener">OpenStreetMap</a> contributors.';t.config={osm:{CycleMap:{attributions:'Style by <a target="_blank" rel="noopener" href="https://www.opencyclemap.org/">OpenCycleMap</a> '+s,crossOrigin:"anonymous",minZoom:0,maxZoom:19,url:"https://{a-c}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png"},German:{attributions:'Style by <a target="_blank" rel="noopener" href="https://www.openstreetmap.de/germanstyle.html">openstreetmap.de</a> '+s,crossOrigin:"anonymous",minZoom:0,maxZoom:19,url:"https://{a-c}.tile.openstreetmap.de/{z}/{x}/{y}.png"},LandscapeMap:{attributions:'Style by <a target="_blank" rel="noopener" href="https://www.opencyclemap.org/">OpenCycleMap</a> '+s,crossOrigin:"anonymous",minZoom:0,maxZoom:19,url:"https://{a-c}.tile.opencyclemap.org/landscape/{z}/{x}/{y}.png"},Mapnik:{attributions:s,crossOrigin:"anonymous"},NONE:""},stadiaMaps:{alidade_smooth:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"alidade_smooth",minZoom:0,maxZoom:20,retina:!0,crossOrigin:"anonymous"},alidade_smooth_dark:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"alidade_smooth_dark",minZoom:0,maxZoom:20,retina:!0,crossOrigin:"anonymous"},alidade_satellite:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"alidade_satellite",minZoom:0,maxZoom:20,retina:!0,crossOrigin:"anonymous"},outdoors:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"outdoors",minZoom:0,maxZoom:20,retina:!0,crossOrigin:"anonymous"},stamen_toner:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://stamen.com/" target="_blank">Stamen Design</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"stamen_toner",minZoom:0,maxZoom:16,retina:!0,crossOrigin:"anonymous"},stamen_terrain:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://stamen.com/" target="_blank">Stamen Design</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"stamen_terrain",minZoom:0,retina:!0,crossOrigin:"anonymous"},stamen_watercolor:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://stamen.com/" target="_blank">Stamen Design</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"stamen_watercolor",minZoom:0,maxZoom:16,crossOrigin:"anonymous"},osm_bright:{attributions:['<a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>','<a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>','<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'],layer:"osm_bright",minZoom:0,maxZoom:20,tilePixelRatio:2,crossOrigin:"anonymous"},NONE:""},mapquest:{MapQuestOpen:{layer:"osm"},MapQuestHyb:{layer:"hyb"},MapQuestSat:{layer:"sat"},NONE:""},mapbox:{Mapbox:{tileSize:[512,512],attributions:'© <a target="_blank" rel="noopener" href="https://www.mapbox.com/about/maps/">Mapbox</a> '+s,minZoom:0,maxZoom:22,crossOrigin:"anonymous"},MapboxClassic:{attributions:'© <a target="_blank" rel="noopener" href="https://www.mapbox.com/about/maps/">Mapbox</a> '+s,minZoom:0,maxZoom:22,crossOrigin:"anonymous"}},otm:{attributions:"Kartendaten: "+s+', SRTN | Kartendarstellung © <a target="_blank" rel="noopener" href="https://opentopomap.org/">OpenTopoMap</a> (<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'},mapz:{attributions:'© 2021 <a target="_blank" href="http://www.mapz.com">mapz.com </a> '+s,minZoom:0,maxZoom:22,tilePixelRatio:2},klokan:{OpenMapTiles:{format:new r.MVT,tileGrid:(0,a.createXYZ)({tileSize:512,maxZoom:22}),tilePixelRatio:8,attributions:'© <a target="_blank" rel="noopener" href="https://openmaptiles.org/">OpenMapTiles</a> '+s,minZoom:0,maxZoom:22,crossOrigin:"anonymous"},TileHosting:{format:new r.MVT,tileGrid:(0,a.createXYZ)({tileSize:512,maxZoom:22}),tilePixelRatio:8,attributions:'© <a target="_blank" rel="noopener" href="https://tilehosting.com/">TileHosting</a> '+s,minZoom:0,maxZoom:22,crossOrigin:"anonymous"}},here:{HERE:{tileSize:[512,512],attributions:"Map Tiles &copy; "+(new Date).getFullYear()+' <a target="_blank" rel="noopener" href="https://developer.here.com">HERE</a> '+s,minZoom:0,maxZoom:22,crossOrigin:"anonymous"}},thunderforest:{Thunderforest:{tileSize:[512,512],attributions:'Map Tiles © <a target="_blank" rel="noopener" href="https://www.thunderforest.com/">Thunderforest</a> '+s,minZoom:0,maxZoom:19,crossOrigin:"anonymous"}}}},"./src/Resources/public/js/c4g-maps-constant.js"(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.cssConstants=void 0,t.cssConstants={OPEN:"c4g-open",CLOSE:"c4g-close",CLOSEABLE:"c4g-closeable",ENABLED:"c4g-enabled",DISABLED:"c4g-disabled",HIDE:"c4g-hide",ICON:"c4g-icon",CONTROL:"c4g-control",COPY:"c4g-copy",REFRESH:"c4g-refresh",ACTIVE:"c4g-active",INACTIVE:"c4g-inactive",LOADING:"c4g-loading",ANIMATION_SPIN:"c4g-animation-spin",LARGE:"c4g-large",SMALL:"c4g-small",HORIZONTAL:"c4g-horizontal",VERTICAL:"c4g-vertical",ATTRIBUTION_LOGO:"c4g-attribution-logo",CONTROL_CONTAINER_TL:"c4g-control-container-top-left",CONTROL_CONTAINER_TR:"c4g-control-container-top-right",CONTROL_CONTAINER_BL:"c4g-control-container-bottom-left",CONTROL_CONTAINER_BL_SUB:"c4g-control-container-bottom-left-sub",CONTROL_CONTAINER_BR:"c4g-control-container-bottom-right",GEOSEARCH:"c4g-geosearch",GEOSEARCH_WRAPPER:"c4g-geosearch-wrapper",GEOSEARCH_TRIGGER:"c4g-geosearch-trigger",GEOSEARCH_START:"c4g-geosearch-start",GRATICULE:"c4g-graticule",MEASURETOOLS_VIEW_TRIGGER_SELECT:"c4g-measuretools-view-trigger-select",MEASURETOOLS_VIEW_TRIGGER_DRAW_LINESTRING:"c4g-measuretools-view-trigger-draw-line",MEASURETOOLS_VIEW_TRIGGER_DRAW_POLYGON:"c4g-measuretools-view-trigger-draw-polygon",MEASURETOOLS_VIEW_TRIGGER_DRAW_CIRCLE:"c4g-measuretools-view-trigger-draw-circle",MEASURETOOLS_VIEW_TRIGGER_DRAW_FREEHAND:"c4g-measuretools-view-trigger-draw-freehand",PRINT:"c4g-print",INFOPAGE_VIEW_TRIGGER:"c4g-infopage-view-trigger",INFOPAGE:"c4g-infopage",ADDITIONALPANEL_VIEW_TRIGGER:"c4g-additionalpanel-view-trigger",ADDITIONALPANEL:"c4g-additionalpanel",OVERVIEWMAP:"c4g-overviewmap",OVERVIEWMAP_WRAPPER:"c4g-overviewmap-wrapper",PERMALINK:"c4g-permalink",PERMALINK_POPUP:"c4g-permalink-popup",POPUP_CLOSE:"c4g-popup-close",POPUP_ROUTE_WRAPPER:"c4g-popup-route-wrapper",POPUP_ROUTE_FROM:"c4g-popup-route-from",POPUP_ROUTE_TO:"c4g-popup-route-to",PORTSIDE:"c4g-portside",PORTSIDE_CONTAINER:"c4g-portside-container",PORTSIDE_CONTROL:"c4g-portside-control",PORTSIDE_WRAPPER:"c4g-portside-wrapper",PORTSIDE_TITLEBAR:"c4g-portside-titlebar",PORTSIDE_TOP_TOOLBAR:"c4g-portside-top-toolbar",PORTSIDE_CONTENT_CONTAINER:"c4g-portside-content-container",PORTSIDE_BOTTOM_TOOLBAR:"c4g-portside-bottom-toolbar",PORTSIDE_STATUSBAR:"c4g-portside-statusbar",PORTSIDE_VIEWTRIGGERBAR:"c4g-portside-viewtriggerbar",PORTSIDE_HEADLINE:"c4g-portside-headline",PORTSIDE_BUTTONBAR:"c4g-portside-buttonbar",PORTSIDE_BUTTON:"c4g-portside-button",PORTSIDE_HIDE:"c4g-portside-hide",PORTSIDE_CLOSE:"c4g-portside-close",SPINNER:"c4g-spinner",STARBOARD:"c4g-starboard",STARBOARD_CONTAINER:"c4g-starboard-container",STARBOARD_CONTROL:"c4g-starboard-control",STARBOARD_WRAPPER:"c4g-starboard-wrapper",STARBOARD_TITLEBAR:"c4g-starboard-titlebar",STARBOARD_CONTENT_CONTAINER:"c4g-starboard-content-container",STARBOARD_BOTTOM_TOOLBAR:"c4g-starboard-bottom-toolbar",STARBOARD_STATUSBAR:"c4g-starboard-statusbar",STARBOARD_VIEWTRIGGERBAR:"c4g-starboard-viewtriggerbar",STARBOARD_HEADLINE:"c4g-starboard-headline",STARBOARD_BUTTONBAR:"c4g-starboard-buttonbar",STARBOARD_BUTTON:"c4g-starboard-button",STARBOARD_VIEW_TRIGGER_BASELAYERSWITCHER:"c4g-starboard-view-trigger-baselayerswitcher",STARBOARD_VIEW_TRIGGER_LAYERSWITCHER:"c4g-starboard-view-trigger-layerswitcher",STARBOARD_CLOSE:"c4g-starboard-close",STARBOARD_CONTENT_BASELAYERSWITCHER:"c4g-content-baselayerswitcher",STARBOARD_BASELAYERTREE:"c4g-baselayertree",STARBOARD_LAYERTREE:"c4g-layertree",STARBOARD_CONTENT_LAYERSWITCHER:"c4g-content-layerswitcher",STARBOARD_LOCSTYLE:"c4g-starboard-locstyle",STARBOARD_LOCSTYLE_POINT:"c4g-starboard-locstyle-point",STARBOARD_LOCSTYLE_SQUARE:"c4g-starboard-locstyle-square",STARBOARD_LOCSTYLE_STAR:"c4g-starboard-locstyle-star",STARBOARD_LOCSTYLE_X:"c4g-starboard-locstyle-x",STARBOARD_LOCSTYLE_CROSS:"c4g-starboard-locstyle-cross",STARBOARD_LOCSTYLE_TRIANGLE:"c4g-starboard-locstyle-triangle",TOOLTIP_POPUP:"c4g-tooltip-popup",ZOOM_LEVEL:"c4g-zoom-level",OL_CONTROL:"ol-control",OL_UNSELECTABLE:"ol-unselectable",OL_OVERLAYCONTAINER:"ol-overlaycontainer",OL_OVERLAYCONTAINER_SE:"ol-overlaycontainer-stopevent",OL_VIEWPORT:"ol-viewport",OL_ZOOM:"ol-zoom",OL_ZOOM_IN:"ol-zoom-in",OL_ZOOM_EXT:"ol-zoom-extent",OL_ZOOM_HOME:"ol-zoom-home",OL_ZOOM_POS:"ol-zoom-position",OL_ZOOM_WITH_EXT:"ol-zoom-with-extent",OL_ZOOM_WITH_HOME:"ol-zoom-with-home",OL_ZOOM_WITH_POS:"ol-zoom-with-position",OL_ZOOM_SLIDER:"ol-zoom-slider",OL_ZOOM_WITH_SLIDER:"ol-zoom-with-slider",NONE:""}},"./src/Resources/public/js/c4g-maps-control-zoomlevel.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.Zoomlevel=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),c=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),u=o("./src/Resources/public/js/c4g-maps-constant.js"),p=o("./node_modules/ol/control.js");function d(e,t,o){return t=(0,i.default)(t),(0,l.default)(e,m()?Reflect.construct(t,o||[],(0,i.default)(e).constructor):t.apply(e,o))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}t.Zoomlevel=function(e){function t(e){var o,r,a;if((0,s.default)(this,t),o=d(this,t,[e]),(0,n.default)(o),!e||!e.mapController)return console.warn("Zoomlevel control needs to know the map."),(0,l.default)(o,!1);var i=(e=jQuery.extend({className:u.cssConstants.ZOOM_LEVEL,undefinedHTML:""},e)).mapController.map.getView();return(r=document.createElement("div")).className=e.className,r.innerHTML=parseInt(i.getZoom()),a=function(){r.innerHTML=parseInt(i.getZoom())},e.mapController.map.getView().on("change:resolution",function(){a()}),o.view=i,d(this,t,[{element:r,target:e.target}])}return(0,c.default)(t,e),(0,a.default)(t)}(p.Control)},"./src/Resources/public/js/c4g-maps-controls.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.MapsControls=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=o("./src/Resources/public/js/c4g-maps-constant.js"),l=o("./src/Resources/public/js/c4g-maps-control-zoomlevel.js"),i=o("./src/Resources/public/js/c4g-maps-interaction-geopicker.js"),c=o("./src/Resources/public/js/c4g-maps-interaction-geopicker-geojson.js"),u=o("./node_modules/ol/proj.js"),p=o("./node_modules/ol/control.js"),d=o("./node_modules/ol/coordinate.js"),m=o("./src/Resources/public/js/c4g-maps-i18n.js"),h={};t.MapsControls=function(){return(0,s.default)(function e(t){(0,a.default)(this,e),this.mapController=t,this.controls={},this.leftSlideElements=[],this.rightSlideElements=[],h=(0,m.getLanguage)(t.data)},[{key:"init",value:function(){var e=this.mapController.map,t=(this.mapController.proxy,this.mapController.data),o=document.createElement("div");o.className=n.cssConstants.CONTROL_CONTAINER_TL+" "+n.cssConstants.OL_UNSELECTABLE,this.mapController.$overlaycontainer_stopevent.prepend(o),this.controlContainerTopLeft=o;var r=document.createElement("div");r.className=n.cssConstants.CONTROL_CONTAINER_BL+" "+n.cssConstants.OL_UNSELECTABLE,jQuery(o).after(r),this.leftSlideElements.push(r);var a=document.createElement("div");a.className=n.cssConstants.CONTROL_CONTAINER_TR+" "+n.cssConstants.OL_UNSELECTABLE,jQuery(r).after(a),this.rightSlideElements.push(a);var s=document.createElement("div");s.className=n.cssConstants.CONTROL_CONTAINER_BR+" "+n.cssConstants.OL_UNSELECTABLE,jQuery(a).after(s),this.rightSlideElements.push(s);var m,y=[{name:"layerswitcher",sort:t.layerswitcher.enable},{name:"baselayerswitcher",sort:t.baselayerswitcher.enable},{name:"geosearch",sort:t.geosearch.enable},{name:"legend",sort:t.legend.enable},{name:"measure",sort:t.measuretools.enable},{name:"permalink",sort:t.permalink.enable}];y.sort((m="sort",function(e,t){return e[m]>t[m]?1:t[m]>e[m]?-1:0}));for(var f=0;f<y.length;f++){var g=y[f];if(!(parseInt(g.sort)<=0)&&"overview"===g.name){var _=document.createElement("div");_.className="c4g-sideboard c4g-overviewmap-container c4g-close",this.mapController.$overlaycontainer_stopevent.append(_)}}if(!t.geopicker||"backend"!==t.geopicker.type&&"frontend"!==t.geopicker.type)t.geopicker&&t.geopicker.type&&(this.controls.geopicker=new c.GeoPickerGeoJSON({mapContainer:this.mapController}),this.mapController.map.addInteraction(this.controls.geopicker));else if(this.controls.geopicker=new i.GeoPicker({mapContainer:this.mapController}),this.mapController.map.addInteraction(this.controls.geopicker),"frontend"===t.geopicker.type&&t.geopicker.input_geo_x&&t.geopicker.input_geo_x){var v=document.getElementById(t.geopicker.input_geo_x.substring(1)),b=document.getElementById(t.geopicker.input_geo_y.substring(1));if(v&&b){var C=v.value,R=b.value;if(C&&R){var S=[parseFloat(C,10),parseFloat(R,10)],E=(0,u.transform)(S,(0,u.get)("EPSG:4326"),(0,u.get)("EPSG:3857"));this.mapController.map.getView().setCenter(E)}}}if(t.attribution.cfg_logo){var O=document.createElement("a");O.href="https://con4gis.org",O.title="built with con4gis",O.target="_blank",O.rel="noopener noreferrer",O.className=n.cssConstants.ATTRIBUTION_LOGO;var w=document.createElement("img");w.src="bundles/con4gismaps/images/logo_con4gis.svg",w.alt="con4gis logo",w.height="24px",w.width="67px",O.appendChild(w),r.appendChild(O)}if(t.scaleline&&(this.controls.scaleline=new p.ScaleLine({target:r}),e.addControl(this.controls.scaleline)),t.zoomlevel||t.mouseposition){var T=document.createElement("div");T.className=n.cssConstants.CONTROL_CONTAINER_BL_SUB+" "+n.cssConstants.OL_UNSELECTABLE,jQuery(r).append(T),t.zoomlevel&&(this.controls.zoomlevel=new l.Zoomlevel({mapController:this.mapController,target:T,undefinedHTML:"N/A"}),e.addControl(this.controls.zoomlevel)),t.mouseposition&&(this.controls.mouseposition=new p.MousePosition({projection:"EPSG:4326",coordinateFormat:d.toStringHDMS,target:T,undefinedHTML:"N/A"}),e.addControl(this.controls.mouseposition))}if(t.attribution.enable){var k={label:" ",tipLabel:h.CTRL_ATTRIBUTION,collapseLabel:" ",target:t.attribution.div?t.attribution.div:r,collapsible:!t.attribution.div&&!t.attribution.always_show};t.attribution.div&&(k.className="ol-attribution ol-attribution-ext-div"),this.controls.attribution=new p.Attribution(k),t.attribution.always_show||this.controls.attribution.setCollapsed(!t.attribution.div&&"1"===t.attribution.collapsed),e.addControl(this.controls.attribution)}}}])}()},"./src/Resources/public/js/c4g-maps-interaction-geopicker-geojson.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPickerGeoJSON=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),l=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),i=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),c=o("./node_modules/ol/interaction.js"),u=(o("./node_modules/ol/index.js"),o("./node_modules/ol/geom.js"),o("./node_modules/ol/style.js"),o("./node_modules/ol/layer.js")),p=o("./node_modules/ol/format.js"),d=o("./node_modules/ol/source.js");function m(e,t,o){return t=(0,l.default)(t),(0,n.default)(e,h()?Reflect.construct(t,o||[],(0,l.default)(e).constructor):t.apply(e,o))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(h=function(){return!!e})()}o("./node_modules/ol/proj.js"),t.GeoPickerGeoJSON=function(e){function t(e){var o;(0,s.default)(this,t);var r=e.mapContainer.data,a=new d.Vector({}),n=new u.Vector({source:a});if(e.mapContainer.map.addLayer(n),(o=m(this,t,[{type:r.geopicker.type,freehand:!0,source:a}])).vectorSource=a,o.$fieldGeoJSON=jQuery(r.geopicker.input_geojson),o.$fieldGeoJSON.val())try{var l=new p.GeoJSON({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).readFeature(o.$fieldGeoJSON.val());o.vectorSource.addFeature(l)}catch(e){console.log(e)}return o.on("drawstart",function(e){o.vectorSource.clear()}),o.on("drawend",function(e){var t=new p.GeoJSON({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).writeFeature(e.feature);o.$fieldGeoJSON.val(t)}),o}return(0,i.default)(t,e),(0,a.default)(t)}(c.Draw)},"./src/Resources/public/js/c4g-maps-interaction-geopicker.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPicker=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),l=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),i=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),c=o("./node_modules/ol/interaction.js"),u=o("./node_modules/ol/index.js"),p=o("./node_modules/ol/geom.js"),d=o("./node_modules/ol/style.js"),m=o("./node_modules/ol/layer.js"),h=o("./node_modules/ol/source.js"),y=o("./node_modules/ol/proj.js"),f=o("./node_modules/ol/extent.js");function g(e,t,o){return t=(0,l.default)(t),(0,n.default)(e,_()?Reflect.construct(t,o||[],(0,l.default)(e).constructor):t.apply(e,o))}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_=function(){return!!e})()}t.GeoPicker=function(e){function t(e){var o,r,s,l,i,c,d,_,v;return(0,a.default)(this,t),(o=g(this,t,[{handleEvent:e.handleEvent}])).options=e||{},o.options.mapContainer&&o.options.mapContainer.data?(r=o.options.mapContainer.data,s=o.options.mapContainer,o.$fieldGeoX=jQuery(r.geopicker.input_geo_x),o.$fieldGeoY=jQuery(r.geopicker.input_geo_y),o.opticLayerSource=new h.Vector({}),o.opticLayerVector=new m.Vector({source:o.opticLayerSource,style:o.geoPickerStyleFunction}),o.opticLayerFeature=null,o.$fieldGeoX.val()&&o.$fieldGeoY.val()?(l=o.$fieldGeoY.val(),i=o.$fieldGeoX.val(),r.geopicker.anonymous&&(o.$fieldGeoY.remove(),o.$fieldGeoX.remove(),c=l.indexOf("."),d=i.indexOf("."),l=l.replace(/\D/g,""),i=i.replace(/\D/g,""),_=Math.round(9999999998*Math.random()+1),v=Math.round(9999999998*Math.random()+1),l=_>4999999999?parseInt(l)-_:parseInt(l)+_,i=v<5e9?parseInt(i)-v:parseInt(i)+v,i+="",l=(l+="").substr(0,c)+"."+l.substr(c,l.length-c),i=i.substr(0,d)+"."+i.substr(d,i.length-d)),o.opticLayerFeature=new u.Feature({geometry:new p.Point((0,y.fromLonLat)([parseFloat(i),parseFloat(l)])),pickerColor:[0,180,100,1],anonymous:r.geopicker.anonymous}),o.opticLayerSource.addFeature(o.opticLayerFeature),(0,f.isEmpty)(o.opticLayerSource.getExtent())||s.map.getView().fit(o.opticLayerSource.getExtent(),s.map.getSize()),s.map.getView().setZoom(15)):r.geoLocation&&"function"==typeof r.geoLocation.setTracking&&r.geoLocation.setTracking(!0),s.map.addLayer(o.opticLayerVector),o):(console.warn('The GeoPicker needs a "mapContainer" in order to work.'),(0,n.default)(o,!1))}return(0,i.default)(t,e),(0,s.default)(t,[{key:"geoPickerStyleFunction",value:function(e,t,o){var r,a,s;return o?-1:(a=[255,255,255,1],r=e&&"function"==typeof e.get&&e.get("pickerColor")?e.get("pickerColor"):[200,0,0,.7],s=[],e&&"function"==typeof e.get&&!e.get("anonymous")&&(s.push(new d.Style({image:new d.Circle({radius:2,fill:new d.Fill({color:r}),stroke:new d.Stroke({color:a,width:2})}),zIndex:1/0})),s.push(new d.Style({image:new d.Circle({radius:20,stroke:new d.Stroke({color:a,width:4})}),zIndex:1/0})),s.push(new d.Style({image:new d.Circle({radius:20,stroke:new d.Stroke({color:r,width:2})}),zIndex:1/0})),s.push(new d.Style({image:new d.Circle({radius:40,stroke:new d.Stroke({color:a,width:4})}),zIndex:1/0})),s.push(new d.Style({image:new d.Circle({radius:40,stroke:new d.Stroke({color:r,width:2})}),zIndex:1/0}))),s.push(new d.Style({image:new d.Circle({radius:60,stroke:new d.Stroke({color:a,width:4})}),zIndex:1/0})),s.push(new d.Style({image:new d.Circle({radius:60,stroke:new d.Stroke({color:r,width:2})}),zIndex:1/0})),s)}},{key:"handleEvent",value:function(e){return!("singleclick"===e.type&&!this.options.disableClickEvent&&!this.options.mapContainer.data.geopicker.disabled&&this.pick(e.coordinate))}},{key:"pick",value:function(e){var t;return t=(0,y.toLonLat)(e),this.opticLayerFeature=new u.Feature({geometry:new p.Point(e)}),this.opticLayerSource.clear(),this.opticLayerSource.addFeature(this.opticLayerFeature),this.$fieldGeoX.val(t[0]),this.$fieldGeoY.val(t[1]),this.$fieldGeoX.change(),this.$fieldGeoY.change(),!0}}])}(c.Interaction)},"./src/Resources/public/js/c4g-maps-misc-maphover.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.MapHover=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/typeof.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=o("./src/Resources/public/js/c4g-maps-misc-tooltippopup.js"),i=o("./src/Resources/public/js/c4g-maps-utils.js"),c=o("./node_modules/ol/Observable.js");o("./src/Resources/public/js/c4g-maps-constant.js"),t.MapHover=function(){return(0,n.default)(function e(t){if((0,s.default)(this,e),this.options=t||{},this.options=jQuery.extend({activate:!0},this.options),!this.options.mapController)return console.warn("MapHover needs a mapController"),!1;this.listenerKey=!1,this.map=this.options.mapController.map,this.lastFeatureStyle=null,this.lastHoveredFeature=null,this.hoverTooltip=new l.TooltipPopUp({map:this.map,offset:[10,10],orientation:this.options.mapController.data.tooltipOrientation||"bottom-left",horizontal:!0,closeable:!1}),this.hoverTooltip.hide(),this.options.activate&&this.activate()},[{key:"activate",value:function(){this.listenerKey||(this.listenerKey=this.map.on("pointermove",this.getHoverFunction(),this))}},{key:"deactivate",value:function(){this.listenerKey&&((0,c.unByKey)(this.listenerKey),this.listenerKey=!1)}},{key:"isActive",value:function(){return!!this.listenerKey}},{key:"getHoverFunction",value:function(){var e=this;return function(t){var o,r,s,n,l,c,u,p=e.options.mapController.data,d=e.options.mapController.proxy;if(r=!1,o=e.map.forEachFeatureAtPixel(t.pixel,function(e,t){return{feature:e,layer:t}}),e.map.getView().getResolution(),!o)return e.hoverTooltip.hide(),u=document.querySelector(".ol-viewport"),jQuery(u).css("cursor","default"),"1"===p.hover_popups&&"1"!=p.hover_popups_stay&&e.options.mapController.proxy.popupController.removePopup(),e.lastHoveredFeature&&e.lastFeatureStyle&&(e.lastHoveredFeature.setStyle(!1),e.lastHoveredFeature=null),!1;if(u=document.querySelector(".ol-viewport"),o.feature.get("noCursor")||jQuery(u).css("cursor","pointer"),o.feature&&"function"==typeof o.feature.get&&o.feature.get("features")&&(o.feature.get("features")[1]?r=!0:o.feature=o.feature.get("features")[0]),o.feature.get("hover_location")||e.lastHoveredFeature&&e.lastHoveredFeature.get("hover_location")){if(e.lastHoveredFeature&&o.feature===e.lastHoveredFeature)return!1;if(e.lastFeatureStyle&&e.lastHoveredFeature&&o.feature!==e.lastHoveredFeature&&(e.lastFeatureStyle?e.lastHoveredFeature.setStyle(e.lastFeatureStyle):e.lastLayerStyle&&e.lastHoveredFeature.setStyle(e.lastLayerStyle)),o.feature&&(0,a.default)(o.feature.getStyleFunction)&&"function"==typeof o.feature.getStyleFunction&&"function"==typeof o.feature.getStyleFunction()){if(e.lastHoveredFeature=o.feature,(e.lastFeatureStyle=o.feature.getStyle())||(e.lastLayerStyle=o.layer.getStyle(),e.lastFeatureStyle=e.lastLayerStyle(e.lastHoveredFeature)),o.feature.get("hover_style")&&d.locationStyleController.arrLocStyles[o.feature.get("hover_style")])if(d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].fnStyleFunction)o.feature.setStyle(Function("feature","data","map",d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].fnStyleFunction)(o.feature));else{var m=d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].style(o.feature);o.feature.setStyle(m)}}else if(o.layer&&(0,a.default)(o.layer.getStyleFunction)&&"function"==typeof o.layer.getStyleFunction&&"function"==typeof o.layer.getStyleFunction()&&(o.feature?e.lastHoveredFeature=o.feature:(e.lastHoveredFeature=o.layer.getSource().getFeatures()[0],e.lastHoveredFeature=e.lastHoveredFeature.get("features")[0]),e.lastLayerStyle=o.layer.getStyle(),e.lastFeatureStyle=e.lastLayerStyle(e.lastHoveredFeature),o.feature.get("hover_style"))){if(!d.locationStyleController.arrLocStyles[o.feature.get("hover_style")]){var h=[];return h.push(o.feature.get("hover_style")),d.locationStyleController.loadLocationStyles(h),e.lastHoveredFeature=null,null}if(d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].fnStyleFunction)o.feature.setStyle(Function("feature","data","map",d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].fnStyleFunction)(o.feature));else{d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].style||(d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].style=d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].getStyleFunction());var y=d.locationStyleController.arrLocStyles[o.feature.get("hover_style")].style(o.feature);o.feature.setStyle(y)}}}if(o&&o.feature&&o.feature.get("styleUrl"))return!1;if(o&&o.layer&&"VECTOR_TILE"===o.layer.type)return!1;if(s=!1,!r&&o.feature&&"function"==typeof o.feature.get&&(o.feature.get("tooltip")||o.feature.get("graphicTitle"))?(s=o.feature.get("tooltip"))?"object"===(0,a.default)(s)&&s.element&&s.element.childNodes[1]&&(s=s.element.childNodes[1].innerHTML):s=o.feature.get("graphicTitle"):o.feature&&(0,a.default)(o.feature.getStyleFunction)&&o.feature.get("locstyle")&&d.locationStyleController.arrLocStyles&&d.locationStyleController.arrLocStyles[o.feature.get("locstyle")]&&d.locationStyleController.arrLocStyles[o.feature.get("locstyle")].tooltip?s=d.locationStyleController.arrLocStyles[o.feature.get("locstyle")].tooltip:o.layer&&(0,a.default)(o.layer.getStyleFunction)&&"function"==typeof o.layer.getStyleFunction&&"function"==typeof o.layer.getStyleFunction()&&d.locationStyleController.arrLocStyles&&d.locationStyleController.arrLocStyles[o.layer.getStyleFunction()()]&&d.locationStyleController.arrLocStyles[o.layer.getStyleFunction()()].tooltip?s=d.locationStyleController.arrLocStyles[o.layer.getStyleFunction()()].tooltip:o.layer&&"function"==typeof o.layer.getStyleFunction&&"function"==typeof o.layer.getStyleFunction()&&d.locationStyleController.arrLocStyles&&d.locationStyleController.arrLocStyles[o.layer.getStyleFunction()(null,null,1)]&&d.locationStyleController.arrLocStyles[o.layer.getStyleFunction()(null,null,1)].tooltip?s=d.locationStyleController.arrLocStyles[o.layer.getStyleFunction()(null,null,1)].tooltip:o.layer&&o.layer.tooltip&&(s=o.layer.tooltip),r&&o.feature.get("features"))if((l=o.feature.get("features"))[0].get("tooltip")&&l[0].get("tooltip_length")){s=l[0].get("tooltip"),c=parseInt(l[0].get("tooltip_length"));for(var f=1;f<l.length;f++)l[f].get("tooltip")&&""!=l[f].get("tooltip")&&(s=s+", "+l[f].get("tooltip"));s.length>c+3&&(s=s.slice(0,c))&&(s+="...")}else if(o.layer.tooltip&&o.layer.tooltip_length){for(n=s,s="",c=parseInt(o.layer.tooltip_length),f=0;f<l.length;f++){var g=i.utils.replaceAllPlaceholders(n,l[f],o.layer,p.lang);""!=g&&(s=""==s?g:s+", "+g)}s.length>c+3&&(s=s.slice(0,c))&&(s+="...")}if(s?(s=i.utils.decodeGeoJsonProperty(s),o.feature.get("features"),(s=i.utils.replaceAllPlaceholders(s,o.feature,o.layer,p.lang)).trim()?(e.hoverTooltip.setPosition(t.coordinate),e.hoverTooltip.setContent(s),e.hoverTooltip.show()):e.hoverTooltip.hide()):e.hoverTooltip.hide(),"1"===p.hover_popups&&!r&&o.feature){if(o.feature.get("popup"))o.feature.get("popup");else{if(o.feature.get("loc_linkurl"))return;if(!o.layer||!o.layer.popup)return;o.layer.popup}var _=o.feature.getGeometry().getCoordinates();if(!_||_&&_[0]&&_[0].length){var v=o.feature.getGeometry().getExtent();_=e.map.getCoordinateFromPixel(t.pixel),_=[(v[0]+v[2])/2,(v[1]+v[3])/2]}e.options.mapController.proxy.handlePopup(o.feature,o.layer)}}}},{key:"changeFeatureStyles",value:function(){}}])}()},"./src/Resources/public/js/c4g-maps-misc-spinner.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.Spinner=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=o("./src/Resources/public/js/c4g-maps-constant.js");t.Spinner=function(){return(0,s.default)(function e(t){var o,r;(0,a.default)(this,e),o=t||{},(o=jQuery.extend({className:"",target:"."+n.cssConstants.OL_VIEWPORT},o)).className&&(o.className=" "+o.className),this.element=document.createElement("div"),this.element.className=n.cssConstants.SPINNER+o.className+" "+n.cssConstants.HIDE,jQuery(o.target).append(this.element),(r=document.createElement("span")).className=n.cssConstants.ICON+" "+n.cssConstants.ANIMATION_SPIN,this.element.appendChild(r),this.additionalActivationCounter=0},[{key:"show",value:function(){jQuery(this.element).hasClass(n.cssConstants.HIDE)?jQuery(this.element).removeClass(n.cssConstants.HIDE):this.additionalActivationCounter+=1}},{key:"hide",value:function(){jQuery(this.element).hasClass(n.cssConstants.HIDE)||(0===this.additionalActivationCounter?jQuery(this.element).addClass(n.cssConstants.HIDE):this.additionalActivationCounter-=1)}}])}()},"./src/Resources/public/js/c4g-maps-misc-tooltippopup.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipPopUp=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=o("./src/Resources/public/js/c4g-maps-constant.js"),l=o("./node_modules/ol/index.js");t.TooltipPopUp=function(){return(0,s.default)(function e(t){var o,r,s;(0,a.default)(this,e),o=this,this.options=t||{},this.options=jQuery.extend({horizontal:!1,closeable:!1,offset:[1,-1],position:[0,0]},this.options),r="",this.options.className&&(r=" "+this.options.className),this.options.horizontal&&(r+=" "+n.cssConstants.HORIZONTAL),this.options.closeable&&(r+=" "+n.cssConstants.CLOSEABLE),this.element=document.createElement("div"),this.element.className=n.cssConstants.TOOLTIP_POPUP+r,this.options.closeable&&((s=document.createElement("button")).className=n.cssConstants.ICON+" "+n.cssConstants.POPUP_CLOSE,this.element.appendChild(s),jQuery(s).click(function(){o.close()})),this.contentContainer=document.createElement("div"),this.element.appendChild(this.contentContainer),this.overlay=new l.Overlay({element:this.element,insertFirst:!1,offset:this.options.offset,positioning:this.options.orientation}),this.options.map&&this.options.map.addOverlay(this.overlay),this.options.position&&this.overlay.setPosition(this.options.position)},[{key:"close",value:function(){"function"==typeof this.options.closeFunction&&this.options.closeFunction(),this.options.map&&this.options.map.removeOverlay(this.overlay)}},{key:"show",value:function(){jQuery(this.element).hasClass(n.cssConstants.HIDE)&&jQuery(this.element).removeClass(n.cssConstants.HIDE)}},{key:"hide",value:function(){jQuery(this.element).hasClass(n.cssConstants.HIDE)||jQuery(this.element).addClass(n.cssConstants.HIDE)}},{key:"getContent",value:function(){return this.contentContainer.innerHTML}},{key:"getPosition",value:function(){return this.overlay.getPosition()}},{key:"setContent",value:function(e){this.contentContainer.innerHTML=e}},{key:"setPosition",value:function(e){this.overlay.setPosition(e)}}])}()},"./src/Resources/public/js/c4g-maps-proxy.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.MapProxy=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/typeof.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=o("./src/Resources/public/js/c4g-baselayer-controller.js"),i=o("./src/Resources/public/js/c4g-layer-controller.js"),c=o("./src/Resources/public/js/c4g-locationstyle-controller.js"),u=o("./src/Resources/public/js/c4g-popup-controller.js"),p=o("./src/Resources/public/js/c4g-maps-utils.js"),d=(o("./src/Resources/public/js/c4g-maps-constant.js"),o("./src/Resources/public/js/c4g-maps-i18n.js")),m=o("./node_modules/ol/layer.js"),h=o("./node_modules/ol/geom.js"),y=o("./node_modules/ol/proj.js"),f=o("./node_modules/ol/style.js"),g=o("./node_modules/ol/index.js"),_=o("./node_modules/ol/source.js");t.MapProxy=function(){return(0,n.default)(function e(t){var o;if((0,s.default)(this,e),this.options=jQuery.extend({mapController:!1},t),!this.options.mapController)return!1;this.hook_baselayer_loaded=[],this.hook_baselayer_visibility=[],this.hook_layer_loaded=[],this.hook_layer_visibility=[],this.hook_map_click=[],this.hook_map_zoom=[],this.hook_locstyles_loaded=[],window.c4gMapsHooks=window.c4gMapsHooks||{},window.c4gMapsHooks.proxy_layer_loaded=window.c4gMapsHooks.proxy_layer_loaded||[],window.c4gMapsHooks.proxy_layer_drawn=window.c4gMapsHooks.proxy_layer_drawn||[],window.c4gMapsHooks.proxy_baselayer_loaded=window.c4gMapsHooks.proxy_baselayer_loaded||[],this.baselayerIds=[],this.layerIds=[],this.activeLayerIds={},this.requestFunctions={},this.request={},this.baselayers_loaded=!1,this.layers_loaded=!1,o=this.options.mapController.data,(0,d.getLanguage)(o),this.mapData=o,this.mapId=o.id,this.api_baselayer_url=this.options.mapController.data.api.baselayer+"/"+o.profile+"/"+this.mapData.lang,this.api_layer_url=this.options.mapController.data.api.layer+"/"+this.mapId+"/"+this.mapData.lang,this.api_layercontent_url=this.options.mapController.data.api.layercontent,this.api_layercontentdata_url="con4gis/layerContentDataService",this.api_locstyle_url=this.options.mapController.data.api.locstyle,this.api_infowindow_url=this.options.mapController.data.api.infowindow,this.options=t,this.clickObserverActive=!0},[{key:"initialize",value:function(){var e,t;e=this,t=this.options.mapController.map,this.baselayerController=new l.C4gBaselayerController(this),this.baselayerController.loadBaseLayers(),this.layerController=new i.BetterLayerController(this),this.layerController.loadLayers(),this.locationStyleController=new c.C4gLocationStyleController(this),this.popupController=new u.C4gPopupController(this),t.on("change:view",function(){t.getView().on("change:resolution",function(){var o;for(o in e.activeLayerIds)e.activeLayerIds.hasOwnProperty(o)&&e.layerController.arrLayers[o];p.utils.callHookFunctions(e.hook_map_zoom,e),e.options.mapController.data.caching&&t.getView().getZoom()&&p.utils.storeValue("zoom",t.getView().getZoom())})}),t.getView().on("change:resolution",function(){var o;for(o in e.activeLayerIds)e.activeLayerIds.hasOwnProperty(o)&&e.layerController.arrLayers[o];p.utils.callHookFunctions(window.c4gMapsHooks.hook_map_zoom,e),e.options.mapController.data.caching&&t.getView().getZoom()&&p.utils.storeValue("zoom",t.getView().getZoom())}),t.getView().on("change:center",function(o){if(e.options.mapController.data.caching){var r=(0,y.toLonLat)(t.getView().getCenter());r&&(p.utils.storeValue("lon",r[0]),p.utils.storeValue("lat",r[1]))}window.c4gMapsHooks.map_center_changed=window.c4gMapsHooks.map_center_changed||[],p.utils.callHookFunctions(window.c4gMapsHooks.map_center_changed,t.getView().getCenter())}),t.on("click",function(o){var r,a,s,n,l,i,c,u;if(!e.clickObserverActive)return!1;if(r=t.forEachFeatureAtPixel(o.pixel,function(e,t){return e},{hitTolerance:5}),s=t.forEachFeatureAtPixel(o.pixel,function(e,t){return t},{hitTolerance:5}),r&&r.get("closeCluster"))t.getView().dispatchEvent({type:"change:resolution"});else{if(s&&s.getStyle()&&"function"==typeof(c=s.getStyle())&&c(r,n)&&c(r,n)[0]&&(u=!(!c(r,n)||!c(r,n)[0])&&c(r,n)[0])&&u.getImage()&&u.getImage().setScale(.7*u.getImage().getScale()),(a=!!r&&r.get("features"))&&1===a.length)a&&1===a.length&&(r=a[0]);else if(a)if(1==a[0].get("cluster_popup"))if(t.getView().setCenter(o.coordinate),(n=t.getView().getZoom())>=(e.options.mapController.data.cluster_all?e.options.mapController.data.cluster_zoom:a[0].get("cluster_zoom"))){(i=[]).content="",i.async=!1;for(var d=0;d<a.length;d++)a[d].get&&a[d].get("popup")&&a[d].get("popup").content&&(i.content=i.content.concat(a[d].get("popup").content));(r=a[0].clone()).set("popup",i)}else t.getView().setZoom(n+1);else if(s.getSource().removeFeature(r),n=t.getView().getZoom(),l=t.getCoordinateFromPixel(o.pixel),n>=(a[0].get("cluster_zoom")||e.options.mapController.data.cluster_zoom)){var v=t.getView().getResolution(),b=a.length,C=v*(e.options.mapController.data.cluster_dist_spider?e.options.mapController.data.cluster_dist_spider:20)*(.5+b/4),R=new _.Vector;for(d=0;d<b;d++){var S=2*Math.PI*d/b;2!=b&&4!=b||(S+=Math.PI/4);var E=[l[0]+C*Math.sin(S),l[1]+C*Math.cos(S)],O=((0,y.toLonLat)(E),new g.Feature(new h.LineString([l,E])));O.set("closeCluster",!0),R.addFeature(O);var w=a[d].clone();w.setGeometry(new h.Point(E)),s.getSource().getSource().removeFeature(a[d]),R.addFeature(w)}var T=s.getStyle(),k=new m.Vector({zIndex:9000001,source:R,style:function(e,t){return e&&"LineString"===e.getGeometry().getType()?new f.Style({stroke:new f.Stroke({width:.3,color:"#000070"})}):T(e,t)}});t.getView().once("change:resolution",function(e){s.getSource().getSource().addFeatures(a),t.removeLayer(k)}),t.addLayer(k)}else n+=1,t.getView().animate({center:l,zoom:n,duration:500});if(e.options.mapController.mapsControls.controls.editor&&e.options.mapController.mapsControls.controls.editor.isOpen()&&r&&r.get("projectId"))return p.utils.callHookFunctions(e.hook_map_click,o),!1;if(r&&r.get("loc_linkurl")){for(var I=r.get("loc_linkurl");-1!=I.lastIndexOf("[");){var L=I.substring(I.lastIndexOf("[")+1,I.lastIndexOf("]")),j="";r.get(L)&&((j=r.get(L).toLowerCase()).replace(" ","-"),j=encodeURIComponent(j)),I=I.substring(0,I.lastIndexOf("["))+j+I.substring(I.lastIndexOf("]")+1)}"1"===e.options.mapController.data.link_newwindow?window.open(I):window.open(I,"_self")}else r&&r.get("zoom_onclick")&&0!=r.get("zoom_onclick")?(t.getView().setZoom(r.get("zoom_onclick")),t.getView().setCenter(r.getGeometry().getCoordinates())):s&&s.zoom_onclick&&0!=s.zoom_onclick&&(t.getView().setZoom(s.zoom_onclick),t.getView().setCenter(o.coordinate)),e.handlePopup(r,s),p.utils.callHookFunctions(window.c4gMapsHooks.hook_map_click,o)}})}},{key:"handlePopup",value:function(e,t){var o={},r=this;if(e&&e.get("popup")){if((o=e.get("popup"))&&"${FNfnStandardInfoPopup}"===o.content){var s="${FNfnStandardInfoPopup}";s=p.utils.replaceFunctionPlaceholders(s,e,t,this.options.mapController.data.lang,this),(o=o||{}).content=s,o.async=!1}}else{if(!t||!t.popup)return void(this.mapData.popupMultiple||this.popupController.removePopup());o=t.popup}if(this.mapData.caching&&parseInt(this.mapData.popupHandling,10)&&p.utils.storeValue("popupInfos",JSON.stringify(o)),!1===o.async||"0"==o.async){var n={};n.popup=o,n.feature=e,n.layer=t,void 0!==window.c4gMapsHooks&&"object"===(0,a.default)(window.c4gMapsHooks.proxy_fillPopup)&&p.utils.callHookFunctions(window.c4gMapsHooks.proxy_fillPopup,{popup:n,mapController:this.options.mapController}),this.mapData.popupMultiple?this.popupController.addPopup(n):this.popupController.setPopup(n)}else o.content&&"string"==typeof o.content&&-1!==o.content.indexOf(":")&&jQuery.ajax({dataType:"json",url:this.api_infowindow_url+"/"+o.content}).done(function(s){var n={async:o.async,content:s.content,popup:o.popup,routing_link:o.routing_link},l={};l.popup=n,l.feature=e,l.layer=t,void 0!==window.c4gMapsHooks&&"object"===(0,a.default)(window.c4gMapsHooks.proxy_fillPopup)&&p.utils.callHookFunctions(window.c4gMapsHooks.proxy_fillPopup,{popup:l,mapController:r.options.mapController}),r.mapData.popupMultiple?r.popupController.addPopup(l):r.popupController.setPopup(l)})}},{key:"activateClickObserver",value:function(){this.clickObserverActive=!0}},{key:"deactivateClickObserver",value:function(){this.clickObserverActive=!1}},{key:"checkLayerIsActiveForZoom",value:function(e,t){var o,r,a,s;if(!this.layerController.arrLayers[e])return!1;if(o=this.layerController.arrLayers[e],r=t||this.options.mapController.map.getView().getZoom()>-1&&this.options.mapController.map.getView().getZoom(),void 0===o.zoom&&o.content&&o.content.length>0)for(var n=0;n<o.content.length&&!((a=o.content[n]).locationStyle&&(s=this.locationStyleController.arrLocStyles[a.locationStyle])&&(o.zoom={},s.maxzoom&&(o.zoom.max=s.maxzoom),s.minzoom&&(o.zoom.min=s.minzoom),o.zoom.max||o.zoom.min));n++);return"number"!=typeof r||!o.zoom||!(o.zoom.min>r||o.zoom.max>0&&o.zoom.max<r)}}])}()},"./src/Resources/public/js/c4g-overlay-controller.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.OSM_REL_ATTRIBUTION=t.C4gOverlayController=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=o("./src/Resources/public/js/c4g-maps-config.js"),l=o("./node_modules/ol/source.js"),i=o("./node_modules/ol/layer.js"),c=r(o("./node_modules/ol-ext/source/GeoImage.js")),u=r(o("./node_modules/ol/source/GeoTIFF.js")),p=r(o("./node_modules/ol/layer/WebGLTile.js")),d=(r(o("./node_modules/ol/proj/Projection.js")),t.OSM_REL_ATTRIBUTION='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="noopener">OpenStreetMap</a> contributors.');t.C4gOverlayController=function(){return(0,s.default)(function e(t){(0,a.default)(this,e),this.baselayer=t,this.arrOverlays=[]},[{key:"showOverlayLayer",value:function(e){var t,o,r,a,s=n.config.osm,m=(n.config.stamen,n.config.stadiaMaps);switch(o={},r=new i.Tile({source:new l.OSM}),t=this.arrOverlays[e],window.isSecureContext&&(o.crossOrigin="anonymous"),t.provider){case"osm":s[t.style]?r=new i.Tile({source:new l.OSM(jQuery.extend(s[t.style],o))}):m[t.style]?r=new i.Tile({source:new l.StadiaMaps(jQuery.extend(m[t.style],o))}):"osm_custom"===t.style?(a=!0,t.attribution&&(o.attributions=t.attribution+" "+d),t.url?(o.url=t.url,a=!1):t.urls&&t.urls.length>0&&(o.urls=t.urls,a=!1),a?console.warn("custom url(s) missing -> switch to default"):r=new i.Tile({source:new l.XYZ(o)})):console.warn("unsupported osm-style -> switch to default");break;case"sea":a=!0,t.attribution&&(o.attributions=t.attribution+" "+d),t.urls&&(o.urls=t.urls,a=!1),a||(r=new i.Tile({source:new l.XYZ(o)}));break;case"wms":r=new i.Tile({source:new l.TileWMS({url:t.url,params:{LAYERS:t.params.layers,VERSION:t.params.version,TRANSPARENT:t.params.transparent},gutter:t.gutter,attributions:t.attribution+" "+d})});break;case"owm":r=new i.Tile({source:new l.XYZ({url:t.url+t.app_id+"/{z}/{x}/{y}?hash="+t.api_key,attributions:t.attribution+" "+d})});break;case"geoimage":var h=JSON.parse(t.geoImageJson);h.url=t.imageSrc?t.imageSrc:h.url,h.attributions=t.attribution,r=new i.Image({source:new c.default(h)});break;case"geotiff":var y=[{url:t.imageSrc?t.imageSrc:""}];r=new p.default({source:new u.default({sources:y,nodata:0}),zIndex:1e4});break;default:console.warn("unsupported provider")}return r.setZIndex(-1),this.arrOverlays[e].layer=r,this.arrOverlays[e].changeOpacity(t.opacity),this.arrOverlays[e].layer}}])}()},"./src/Resources/public/js/c4g-overlay.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.C4gOverlay=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js"));t.C4gOverlay=function(){return(0,s.default)(function e(t,o){(0,a.default)(this,e),this.id=t.id,this.pid=t.pid,this.name=t.name,this.provider=t.provider,this.style=t.style,this.url=t.url,this.urls=t.urls,this.opacity=t.opacity,this.attribution=t.attribution,this.infopage=t.infopage,this.gutter=t.gutter,this.params=t.params,this.imageSrc=t.image_src,this.geoImageJson=t.geoimage_json,this.layer=!1,this.overlayArr=t,this.mapController=o},[{key:"changeOpacity",value:function(e){var t;(t=this.layer)&&(this.mapController.map.removeLayer(t),t.setOpacity(e/100),this.mapController.map.addLayer(t))}}])}()},"./src/Resources/public/js/c4g-popup-controller.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.C4gPopupController=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),s=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=o("./src/Resources/public/js/c4g-popup.js"),l=o("./src/Resources/public/js/c4g-maps-utils.js");t.C4gPopupController=function(){return(0,s.default)(function e(t){(0,a.default)(this,e),this.mapController=t.options.mapController,this.mapData=t.options.mapController.data,this.popupHandling=parseInt(this.mapData.popupHandling,10),this.external=!!this.mapData.popupDiv,this.popups=[]},[{key:"addPopup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.popups.push(new n.C4gPopup(this)),e&&this.popups[this.popups.length-1].setContent(e),this.mapData.caching&&l.utils.storeValue("popupInfos","")}},{key:"setPopup",value:function(e){this.popups[0]||this.popups.push(new n.C4gPopup(this)),this.popups[0].setContent(e)}},{key:"removePopup",value:function(){this.popups[0]&&this.popups[0].popup&&this.popups[0].popup.getMap()?this.mapData.map.removeOverlay(this.popups[0].popup):this.popups[0]&&this.popups[0].popupComponent&&this.popups[0].popupComponent.close(!0)}}])}()},"./src/Resources/public/js/c4g-popup.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.C4gPopup=void 0;var s=r(o("./node_modules/@babel/runtime/helpers/typeof.js")),n=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),i=o("./node_modules/ol/index.js"),c=o("./src/Resources/public/js/c4g-maps-utils.js"),u=r(o("./node_modules/react-dom/index.js")),p=o("./src/Resources/public/js/components/c4g-popup-container.jsx"),d=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var o,r,s={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return s;if(o=t){if(o.has(e))return o.get(e);o.set(e,s)}for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&((r=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,n))&&(r.get||r.set)?o(s,n,r):s[n]=e[n]);return s}(e)}(o("./node_modules/react/index.js")),m=o("./node_modules/ol/geom.js");t.C4gPopup=function(){return(0,l.default)(function e(t){(0,n.default)(this,e);var o=this;this.popupController=t;var r=document.createElement("div");r.setAttribute("id","c4g_popup_"+t.mapData.mapId),r.className="c4g-popup-wrapper c4g-active";var a=document.createElement("button");a.className="c4g-popup-close c4g-icon",jQuery(a).click(function(e){e.preventDefault(),t.mapController.map.removeOverlay(o.popup)});var s=document.createElement("div");if(s.className="c4g-popup-content",r.appendChild(a),r.appendChild(s),this.popupContent=s,1===t.popupHandling||0===t.popupHandling){var l=1===t.popupHandling;this.popup=new i.Overlay({element:r,positioning:"center-center",offset:[-50,50],insertFirst:!1,autoPan:l,autoPanAnimation:{duration:250},autoPanMargin:200}),t.mapController.map.addOverlay(this.popup)}else if(2===t.popupHandling){jQuery(r).addClass("c4g-popup-wrapper-nonose");var c=t.mapController.map.getView().getCenter();this.popup=new i.Overlay({position:c,positioning:"center-center",element:r,offset:[-50,0],autoPan:!1}),t.mapController.map.addOverlay(this.popup)}else if(3===t.popupHandling){var m={open:!0,alwaysExtended:!1,hideOther:t.mapController.hideOtherComponents,activeComps:t.mapController.getActiveComponents(),mapData:t.mapData,mapController:t.mapController};this.popupContainer&&(u.default.unmountComponentAtNode(this.popupContainer),delete t.mapController.components.popup,t.external||this.popupContainer.parentNode.removeChild(this.popupContainer)),m.external=t.external,this.popupContainer=t.external?document.querySelector("."+t.mapData.popupDiv):document.createElement("div"),this.popupContainer||(this.popupContainer=document.createElement("div"),m.external=!1),this.popupComponent=u.default.render(d.createElement(p.PopupContainer,m),this.popupContainer),m.external||(t.mapController.$overlaycontainer_stopevent.append(this.popupContainer),t.mapController.hideOtherComponents(this.currentPopup)),this.currentPopup=this.popupComponent,t.mapController.components.popup=this.popupComponent}},[{key:"setContent",value:function(e){var t,o,r,a=e.feature,n=e.layer;if(a.get("features"))for(var l=a.get("features"),i=0;i<l.length;i++)t+=c.utils.replaceAllPlaceholders(e.popup.content,l[i],n,this.popupController.mapController.data.lang);else t=c.utils.replaceAllPlaceholders(e.popup.content,a,n,this.popupController.mapController.data.lang);if(o=document.createElement("div"),void 0!==window.c4gMapsHooks&&"object"===(0,s.default)(window.c4gMapsHooks.proxy_appendPopup)&&(r={popup:e,content:t,mapController:this.popupController.mapController,comp:this.popupComponent||null,div:o,callback:null},c.utils.callHookFunctions(window.c4gMapsHooks.proxy_appendPopup,r),r.content,t=r.content),this.popupController.popupHandling<3){if(this.popup.getMap()||this.popupController.mapController.map.addOverlay(this.popup),o.innerHTML=t,this.popupContent.innerHTML="",this.popupContent.appendChild(o),this.popupController.popupHandling<2){if(a.getGeometry()){var u=a.getGeometry();this.setPosition(u)}}else if(2==this.popupController.popupHandling){var p=this.popupController.mapController.map.getView().getCenter();new m.Point(p),this.setPosition(p)}}else if(this.popupComponent){var d=this.popupController.mapController.getActiveComponents();if(this.popupComponent.state.open||this.popupComponent.open(d),o.children.length>0){var h=document.createElement("div");h.innerHTML=t,o.appendChild(h),this.popupComponent.setContent(o.innerHTML),r&&r.callback&&"function"==typeof r.callback&&r.callback()}else this.popupComponent.setContent(t,e)}}},{key:"setPosition",value:function(e){var t=this.popupController.mapController.map,o=this.popup.getElement(),r=null;if(e&&"Point"===e.getType())r=e.getCoordinates();else if(e){var a=e.getExtent();r=[(a[0]+a[2])/2,(a[1]+a[3])/2]}else r=t.getView().getCenter();var s=t.getView().getCenter(),n="",l=[0,0];s[1]>=r[1]?n+="bottom":(l[1]=10,n+="top"),s[0]>=r[0]?(l[0]=-50,n+="-left"):(l[0]=100,n+="-right"),jQuery(o).removeClass("nose-top-left").removeClass("nose-top-right").removeClass("nose-bottom-left").removeClass("nose-bottom-right"),jQuery(o).addClass("nose-"+n),this.popup.setPositioning(n),this.popup.setOffset(l),this.popup.setPosition(r)}}])}()},"./src/Resources/public/js/c4g-router-time-conversions.js"(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.toHumanDistance=function(e){var t;return t=parseInt(e,10),(t/=1e3)>=100?t.toFixed(0)+" km":t>=10?t.toFixed(1)+" km":t>=.1?t.toFixed(2)+" km":(1e3*t).toFixed(0)+" m"},t.toHumanTime=function(e){var t,o,r;return t=parseInt(e,10),o=parseInt(t/60,10),t%=60,r=parseInt(o/60,10),o%=60,0===r&&0===o?t+" s":0===r?o+" min":r+" h "+o+" min"}},"./src/Resources/public/js/c4g-routing-permalink.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.RoutingPermalink=void 0;var a=r(o("./node_modules/@babel/runtime/regenerator/index.js")),s=r(o("./node_modules/@babel/runtime/helpers/slicedToArray.js")),n=r(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(o("./node_modules/@babel/runtime/helpers/defineProperty.js"));t.RoutingPermalink=function(){return(0,i.default)(function e(t){(0,l.default)(this,e),(0,c.default)(this,"_router",void 0),this._router=t,this.linkFragments={},this.rawFragments={}},[{key:"router",get:function(){return this._router},set:function(e){this._router=e}},{key:"updateLinkFragments",value:function(e,t){this.linkFragments||(this.linkFragments={}),this.linkFragments[e]=t,this.updateUrl()}},{key:"updateUrl",value:function(){var e="?mapsParams=",t=this.linkFragments;if(t.mode&&"area"===t.mode){e+=t.mode?"m:"+t.mode+"/":"",e+=t.addressArea?"a:"+t.addressArea[0]+","+t.addressArea[1]+"/":"",e+=t.detourArea?"d:"+t.detourArea+"/":"",e+=t.searchType?"s:"+t.searchType+"/":"",e+=t.forceStart?"f:"+t.forceStart:"";var o=window.location.pathname+e;history.pushState({},null,o)}else if(t.mode&&"route"===t.mode){e+=t.mode?"m:"+t.mode+"/":"",e+=t.fromAddress?"af:"+t.fromAddress[0]+","+t.fromAddress[1]+"/":"",e+=t.toAddress?"at:"+t.toAddress[0]+","+t.toAddress[1]+"/":"",e+=t.detourRoute?"d:"+t.detourRoute+"/":"",e+=t.searchType?"s:"+t.searchType+"/":"",e+=t.forceStart?"f:"+t.forceStart:"";var r=window.location.pathname+e;history.pushState({},null,r)}}},{key:"handleInitialParams",value:(t=(0,n.default)(a.default.mark(function e(){var t,o,r,n,l,i,c,u,p,d,m,h,y;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.rawFragments=this.router.props.mapController.data.initialParams,!this.rawFragments){e.next=7;break}return e.next=1,this.checkForOldParams();case 1:t=this.rawFragments.split("/").map(function(e){return e.split(":")}),o={},t.forEach(function(e){var t=(0,s.default)(e,2),r=t[0],a=t[1];return o[r]=a}),r=this.router.props.mapController.data.routerLayers,n="",d=a.default.keys(r);case 2:if((m=d()).done){e.next=6;break}if(l=m.value,!r.hasOwnProperty(l)){e.next=5;break}i=r[l],h=a.default.keys(i);case 3:if((y=h()).done){e.next=5;break}if(c=y.value,!i.hasOwnProperty(c)){e.next=4;break}if(u=i[c],p=o.s,u.mapLabel!==p){e.next=4;break}return n=c,e.abrupt("continue",6);case 4:e.next=3;break;case 5:e.next=2;break;case 6:this.desiredButtonRouting=n,"area"===o.m?this.handleInitialAreaSearch(o):"route"===o.m&&this.handleInitialRouteSearch(o);case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"checkForOldParams",value:(e=(0,n.default)(a.default.mark(function e(){var t,o,r,s,n,l;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",-1===(o=this.router.props.mapController.data.initialParams).indexOf("m:")){e.next=1;break}return e.abrupt("return");case 1:if(r=o.split("/"),t+="m:"+r[0]+"/","route"!==r[0]){e.next=4;break}return e.next=2,this.router.performGeoSearch(r[1]);case 2:return s=e.sent,e.next=3,this.router.performGeoSearch(r[2]);case 3:n=e.sent,t+="af:"+s.join()+"/",t+="at:"+n.join()+"/",t+="d:"+r[3]+"/",t+="s:"+r[4]+"/",t+="f:"+r[5]+"/",e.next=6;break;case 4:return e.next=5,this.router.performGeoSearch(r[1]);case 5:l=e.sent,t+="a:"+l.join()+"/",t+="d:"+r[2]+"/",t+="s:"+r[3]+"/",t+="f:"+r[4]+"/";case 6:this.rawFragments=t;case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"handleInitialAreaSearch",value:function(e){var t=e.d||this.router.props.detourRoute.initial;this.router.setState({mode:"area",detourArea:parseFloat(t)});var o=e.a;o&&(o=o.split(",")),t=e.d;var r=e.s,a=e.f;if((t||t>1)&&this.updateLinkFragments("detourArea",t),o&&2===o.length&&(this.updateLinkFragments("addressArea",o),this.router.setAreaPoint(parseFloat(o[0]),parseFloat(o[1]))),r){var s=this.router.mapData.routerLayers;e:for(var n in s)if(s.hasOwnProperty(n))for(var l in s[n])if(s[n].hasOwnProperty(l)&&(s[n][l].keys.includes(r)||s[n][l].labels.includes(r))){this.router.setState({layerArea:n,layerValueArea:l});break e}this.updateLinkFragments("searchType",r)}a&&this.updateLinkFragments("forceStart",a),jQuery(".c4g-portside-viewtriggerbar .c4g-area-search").click()}},{key:"handleInitialRouteSearch",value:function(e){var t=e.d||this.router.props.detourRoute.initial;this.router.setState({mode:"route",detourRoute:parseFloat(t)});var o=e.af?e.af.split(",").map(function(e){return parseFloat(e)}):null,r=e.at?e.at.split(",").map(function(e){return parseFloat(e)}):null;t=e.d;var a=e.s,s=e.f;if(t&&(jQuery(this.router.toggleDetourRoute).val(t),jQuery(this.router.toggleDetourRoute).trigger("input"),this.updateLinkFragments("detourRoute",e.d)),o&&this.updateLinkFragments("fromAddress",o),r&&this.updateLinkFragments("toAddress",r),a){var n=this.router.mapData.routerLayers;e:for(var l in n)if(n.hasOwnProperty(l))for(var i in n[l])if(n[l].hasOwnProperty(i)&&(n[l][i].keys.includes(a)||n[l][i].labels.includes(a))){this.router.setState({layerRoute:l,layerValueRoute:i});break e}this.updateLinkFragments("searchType",a)}s&&this.updateLinkFragments("forceStart",e.f),o&&r&&(this.router.setRouteFrom(o[0],o[1]),this.router.setRouteTo(r[0],r[1])),this.router.recalculateRoute(),jQuery(".c4g-portside-viewtriggerbar .c4g-route-search").click()}}]);var e,t}()},"./src/Resources/public/js/c4g-user-position.js"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.UserPosition=void 0;var a=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=(r(o("./node_modules/ol/Geolocation.js")),o("./node_modules/ol/source.js")),l=o("./node_modules/ol/layer.js"),i=o("./node_modules/ol/geom.js"),c=r(o("./node_modules/ol/Feature.js")),u=o("./src/Resources/public/js/c4g-maps-i18n.js");t.UserPosition=(0,a.default)(function e(t){(0,s.default)(this,e);var o=this;this.mapController=t;var r=(0,u.getLanguage)(t.data);this.feature=new c.default,this.feature.set("tooltip",r.TOOLTIP_POSITION),this.feature.set("noCursor",!0);var a=new l.Vector({source:new n.Vector({features:[this.feature]})});this.mapController.map.addLayer(a),this.mapController.data&&this.mapController.data.userLocationStyle&&this.mapController.proxy.locationStyleController.loadLocationStyles([this.mapController.data.userLocationStyle],{done:function(){if(o.mapController.proxy.locationStyleController.arrLocStyles[o.mapController.data.userLocationStyle].style){var e=o.mapController.proxy.locationStyleController.arrLocStyles[o.mapController.data.userLocationStyle].style;o.feature.setStyle(e)}else{var t=o.mapController.proxy.locationStyleController.arrLocStyles[o.mapController.data.userLocationStyle].getStyleFunction();o.mapController.proxy.locationStyleController.arrLocStyles[o.mapController.data.userLocationStyle].style=t,o.feature.setStyle(t)}}}),this.mapController.geolocation.on("change",function(e){var t=o.mapController.geolocation.getPosition();if(t){var r=new i.Point(t);o.feature.setGeometry(r)}else window.setTimeout(function(){o.mapController.geolocation.dispatchEvent("change")},200)}),this.mapController.geolocation.getTracking()&&this.mapController.geolocation.dispatchEvent("change")})},"./src/Resources/public/js/components/c4g-maps.jsx"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),n=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),i=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),c=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),u=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),p=o("./src/Resources/public/js/c4g-maps-proxy.js"),d=o("./src/Resources/public/js/c4g-maps-constant.js"),m=o("./src/Resources/public/js/c4g-maps-misc-spinner.js"),h=o("./src/Resources/public/js/c4g-maps-misc-maphover.js"),y=o("./node_modules/ol/layer.js"),f=r(o("./node_modules/ol/control/Control.js")),g=o("./src/Resources/public/js/c4g-maps-utils.js"),_=o("./src/Resources/public/js/c4g-maps-controls.js"),v=o("./src/Resources/public/js/c4g-maps-i18n.js"),b=o("./node_modules/ol/index.js"),C=o("./node_modules/ol/proj.js"),R=o("./node_modules/ol/interaction.js"),S=o("./node_modules/ol/control.js"),E=(o("./node_modules/ol/geom.js"),r(o("./node_modules/ol/Feature.js"))),O=o("./node_modules/ol/extent.js"),w=o("./node_modules/ol/events/condition.js"),T=r(o("./node_modules/react-dom/index.js")),k=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var o,r,s={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return s;if(o=t){if(o.has(e))return o.get(e);o.set(e,s)}for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&((r=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,n))&&(r.get||r.set)?o(s,n,r):s[n]=e[n]);return s}(e)}(o("./node_modules/react/index.js")),I=(r(o("./node_modules/ol/layer/Tile.js")),o("./src/Resources/public/js/routing-constant-i18n-en.js")),L=o("./src/Resources/public/js/routing-constant-i18n-de.js"),j=o("./src/Resources/public/js/c4g-user-position.js"),P=o("./src/Resources/public/js/components/c4g-router-view.jsx");function x(e,t,o){return t=(0,c.default)(t),(0,i.default)(e,A()?Reflect.construct(t,o||[],(0,c.default)(e).constructor):t.apply(e,o))}function A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(A=function(){return!!e})()}var F=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-geosearch_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-geosearch.jsx"))}),N=k.default.lazy(function(){return Promise.all([o.e("vendors-node_modules_opening_hours_build_opening_hours_js"),o.e("src_Resources_public_js_components_c4g-feature-filter_jsx")]).then(o.bind(o,"./src/Resources/public/js/components/c4g-feature-filter.jsx"))}),D=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-baselayerswitcher_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-baselayerswitcher.jsx"))}),U=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-starboard-panel_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-starboard-panel.jsx"))}),M=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-starboard-scope_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-starboard-scope.jsx"))}),G=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-infopage_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-infopage.jsx"))}),z=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-measuretools_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-measuretools.jsx"))}),H=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-permalink_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-permalink.jsx"))}),B=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-zoom_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-zoom.jsx"))}),V=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-zoom-extent_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-zoom-extent.jsx"))}),Z=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-zoom-home_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-zoom-home.jsx"))}),W=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-zoom-position_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-zoom-position.jsx"))}),Q=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-grid_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-grid.jsx"))}),X=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-rotate_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-rotate.jsx"))}),Y=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-fullscreen_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-fullscreen.jsx"))}),q=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-print_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-print.jsx"))}),K=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-overviewmap_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-overviewmap.jsx"))}),$=k.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-editor-component_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-editor-component.jsx"))}),J={},ee={arrFromPositions:[],arrFromNames:[],arrToPositions:[],arrToNames:[],arrOverPositions:{},arrOverNames:{}},te={};t.default=function(e){function t(e){var o;(0,n.default)(this,t),o=x(this,t,[e]);var r=e.mapData;o.state={objLayers:[],arrLayerStates:[],openComponent:null,objTabLayers:[],styleData:{},arrTabLayerStates:[],activeBaselayerId:null},o.setObjLayers=o.setObjLayers.bind(o),o.setBaselayerId=o.setBaselayerId.bind(o),o.setLayerStates=o.setLayerStates.bind(o),o.changeActiveLayers=o.changeActiveLayers.bind(o),o.setTabStates=o.setTabStates.bind(o),o.setLocStyles=o.setLocStyles.bind(o),o.changeCollapseState=o.changeCollapseState.bind(o),o.map=null,te=(0,v.getLanguage)(r);var a,s,l,c,u,I=o,L=!1,P=[],A=[];if("LOCATIONS"!==(r=jQuery.extend({api:{},addIdToDiv:!1,mapId:1,mapDiv:"c4g_map",center:{},calc_extent:"CENTERZOOM",attribution:{},editor:{},measuretools:{},infopage:{},account:"",starboard:{},layerswitcher:{},baselayerswitcher:{},geosearch:{}},r)).calc_extent&&"CENTERLOCS"!==r.calc_extent||(r=jQuery.extend({min_gap:25},r)),r.center=jQuery.extend({lat:52.22,lon:9.43,rotation:0,zoom:6},r.center),r.attribution=jQuery.extend({enable:!0,collapsed:!1,collapsible:!0},r.attribution),r.geosearch=jQuery.extend({enable:!1,div:!1},r.geosearch),r.permalink=jQuery.extend({enable:!1,get_parameter:!1},r.permalink),o.data=r,r.addIdToDiv&&(r.mapDiv+="_"+r.mapId),r.caching&&(window.onbeforeunload=function(){var e=I.getCurrentLayerStates(I.state.arrLayerStates);g.utils.storeValue("layers",e),g.utils.storeValue("tstampc4g",Date.now())}),window.MooTools&&Browser.Document&&(Document=Browser.Document),r.permalink.enable)if(L=g.utils.getUrlParam(r.permalink.get_parameter))switch((L=L.split("/")).length){case 6:L[0]=parseFloat(L[0]),r.center.lon=isNaN(L[0])?r.center.lon:L[0],L[1]=parseFloat(L[1]),r.center.lat=isNaN(L[1])?r.center.lat:L[1],L[2]=parseInt(L[2],10),r.center.zoom=isNaN(L[2])?r.center.zoom:L[2],L[3]=parseFloat(L[3]),r.center.rotation=isNaN(L[3])?r.center.rotation:L[3],L[4]=parseInt(L[4],10),r.baselayer=isNaN(L[4])?r.baselayer:L[4],r.layers=L[5].split(":"),r.layers=g.utils.deltaDecode(r.layers);break;case 3:L[0]=parseFloat(L[0]),r.center.lon=isNaN(L[0])?r.center.lon:L[0],L[1]=parseFloat(L[1]),r.center.lat=isNaN(L[1])?r.center.lat:L[1],L[2]=parseInt(L[2],10),r.center.zoom=isNaN(L[2])?r.center.zoom:L[2],r.calc_extent="CENTERZOOM";break;case 2:L[0]=parseInt(L[0],10),r.baselayer=isNaN(L[0])?r.baselayer:L[0],r.layers=L[1].split(":"),r.layers=g.utils.deltaDecode(r.layers);break;case 1:r.layers=L[0].split(":"),r.layers=g.utils.deltaDecode(r.layers);break;default:L=!1,r.layers=!1}else L=!1;else(L=g.utils.getUrlParam(r.permalink.get_parameter))&&(3===(L=L.split("/")).length?(L[0]=parseFloat(L[0]),r.center.lon=isNaN(L[0])?r.center.lon:L[0],L[1]=parseFloat(L[1]),r.center.lat=isNaN(L[1])?r.center.lat:L[1],L[2]=parseInt(L[2],10),r.center.zoom=isNaN(L[2])?r.center.zoom:L[2],r.calc_extent="CENTERZOOM"):4===L.length&&(L[0]=parseFloat(L[0]),r.center.lon=isNaN(L[0])?r.center.lon:L[0],L[1]=parseFloat(L[1]),r.center.lat=isNaN(L[1])?r.center.lat:L[1],L[2]=parseInt(L[2],10),r.center.zoom=isNaN(L[2])?r.center.zoom:L[2],L[3]=parseInt(L[3],10),r.default_baselayer=L[3],r.calc_extent="CENTERZOOM"),L=!1);o.proxy=new p.MapProxy({mapController:o}),o.components=o.components||{},o.hideOtherComponents=o.hideOtherComponents.bind(o),o.hideOtherBottomComponents=o.hideOtherBottomComponents.bind(o),o.getActiveComponents=o.getActiveComponents.bind(o),window.c4gMapsHooks.map_center_changed=window.c4gMapsHooks.map_center_changed||[];var F=null;window.c4gMapsHooks.map_center_changed.push(function(e){F&&window.clearTimeout(F),F=window.setTimeout(function(){var t=g.utils.getUrlParam(r.permalink.get_parameter);t&&t&&(t=t.split("/")).length>=3&&(e=(0,C.transform)(e,"EPSG:3857","EPSG:4326"),t[0]=e[0],t[1]=e[1],g.utils.setUrlParam(t.join("/"),r.permalink.get_parameter,!0))},100)}),window.c4gMapsHooks.hook_map_zoom=window.c4gMapsHooks.hook_map_zoom||[];var D=null;if(window.c4gMapsHooks.hook_map_zoom.push(function(e){D&&window.clearTimeout(D),D=window.setTimeout(function(){var e=g.utils.getUrlParam(r.permalink.get_parameter);e&&e&&(e=e.split("/")).length>=3&&(e[2]=parseInt(l.getZoom(),10)||e[2],g.utils.setUrlParam(e.join("/"),r.permalink.get_parameter,!0))},100)}),r.permalink.withoutGenerator&&!g.utils.getUrlParam(r.permalink.get_parameter)&&r.center){var U=[];U.push(r.center.lon),U.push(r.center.lat),U.push(r.center.zoom),g.utils.setUrlParam(U.join("/"),r.permalink.get_parameter,!0)}if(a=r.minZoom&&r.minZoom>0?r.minZoom:0,s=r.maxZoom&&r.maxZoom>0?r.maxZoom:19,r.caching&&g.utils.getValue("tstampc4g")&&g.utils.getValue("tstampc4g")+604800>Date.now()&&(g.utils.getValue("lon")&&g.utils.getValue("lat")&&(r.center.lon=g.utils.getValue("lon"),r.center.lat=g.utils.getValue("lat")),g.utils.getValue("zoom")&&(r.center.zoom=g.utils.getValue("zoom")),g.utils.getValue("layers")&&(r.layers=g.utils.getValue("layers"))),r.restr_bottomleft_lon&&r.restr_bottomleft_lat&&r.restr_topright_lon&&r.restr_topright_lat){var M=[parseFloat(r.restr_bottomleft_lon),parseFloat(r.restr_bottomleft_lat),parseFloat(r.restr_topright_lon),parseFloat(r.restr_topright_lat)];M=(0,C.transformExtent)(M,"EPSG:4326","EPSG:3857"),l=new b.View({extent:M,center:(0,C.transform)([parseFloat(r.center.lon),parseFloat(r.center.lat)],"EPSG:4326","EPSG:3857"),zoom:parseFloat(r.center.zoom),minZoom:parseInt(a,10),maxZoom:parseInt(s,10),rotation:parseFloat(r.center.rotation)})}else l=new b.View({center:(0,C.transform)([parseFloat(r.center.lon),parseFloat(r.center.lat)],"EPSG:4326","EPSG:3857"),zoom:parseFloat(r.center.zoom),minZoom:parseInt(a,10),maxZoom:parseInt(s,10),rotation:parseFloat(r.center.rotation)});if(o.geolocation=new b.Geolocation({tracking:!1,projection:l.getProjection()}),o.geolocation.on("change",function(e){for(var t in o.geolocation.arrFuncs)o.geolocation.arrFuncs.hasOwnProperty(t)&&o.geolocation.arrFuncs[t](e,t)}),r.geolocation&&!L&&(o.geolocation.once("change",function(e){var t=this.getPosition();if(r.geolocation_extent&&r.geolocation_extent[0]){var o=(0,C.fromLonLat)([r.geolocation_extent[0],r.geolocation_extent[1]]),a=(0,C.fromLonLat)([r.geolocation_extent[2],r.geolocation_extent[3]]),s=(0,O.boundingExtent)([o,a]);if(!t||!(0,O.containsCoordinate)(s,t))return}t&&l.setCenter(t),r.geolocation_zoom&&l.setZoom(parseInt(r.geolocation_zoom,10)),I.map&&(I.map.setView(l),I.$overlaycontainer_stopevent)}),o.geolocation.getTracking()&&o.geolocation.dispatchEvent("change")),r.profile||(P=(0,S.defaults)(),A=(0,R.defaults)()),r.geopicker&&"backend"===r.geopicker.type?(r.default_baselayer&&o.proxy.hook_baselayer_loaded.push(function(e){I.proxy.baselayerController.arrBaselayers.hasOwnProperty(r.default_baselayer)&&I.proxy.baselayerController.showBaseLayer(r.default_baselayer)}),o.map=new b.Map({controls:P,interactions:A,layers:[new y.Group({title:"Base maps",layers:[],checkSum:"baseMapsLayer"})],loadTilesWhileAnimating:!0,target:r.mapDiv,view:l})):(r.default_baselayer&&o.proxy.hook_baselayer_loaded.push(function(e){r.baselayer&&e.indexOf(r.baselayer.toString())>-1&&(r.default_baselayer=r.baselayer),r.caching&&g.utils.getValue("baselayer")&&(r.default_baselayer=g.utils.getValue("baselayer")),I.proxy.baselayerController.showBaseLayer(r.default_baselayer)}),o.map=new b.Map({controls:P,interactions:A,layers:[new y.Group({title:"Base maps",layers:[],checkSum:"baseMapsLayer"})],loadTilesWhileAnimating:!0,target:r.mapDiv,view:l})),window.c4gMapsHooks&&window.c4gMapsHooks.changeInitialView&&g.utils.callHookFunctions(window.c4gMapsHooks.changeInitialView,{mapData:r,view:l}),r.map=o.map,(c=document.getElementById(r.mapDiv))||(c=document.getElementById("#"+r.mapDiv))||(c=document.getElementById("."+r.mapDiv)),!c||!c.style)return console.warn("can not get element by id mapData.mapDiv"),(0,i.default)(o);if(r.width)if(r.margin){var G=r.margin.split(" "),z=0,H=0;switch(G.length){case 4:z=G[1],H=G[3];break;case 2:z=G[1],H=G[1];break;case 1:z=G[0],H=G[0]}0==H&&(H+="px"),0==z&&(z+="px"),c.style.width="calc("+r.width+" - "+H+" - "+z+")"}else c.style.width=r.width;if(r.height)c.style.height=r.height;else if(r.geopicker&&"backend"===r.geopicker.type){var B=c.parentElement.parentElement.offsetHeight;c.style.height="calc(100vh - "+B+"px)",c.style.minHeight="480px",c.style.maxWidth="100vw"}else if(c.parentElement&&c.parentElement.parentElement&&!c.parentElement.parentElement.offsetHeight)c.style.height="100vh";else if(c.parentElement&&c.parentElement.parentElement){var V=c.parentElement.parentElement.offsetHeight;V<320&&(V=320),c.style.height=V+"px"}if(r.margin&&(c.style.padding=r.margin),o.$overlaycontainer_stopevent=jQuery("#"+r.mapDiv+" ."+d.cssConstants.OL_OVERLAYCONTAINER_SE),o.map.updateSize(),o.proxy.initialize(),o.spinner=new m.Spinner({className:d.cssConstants.LARGE}),o.mapHover=new h.MapHover({mapController:o}),r.mouse_nav&&(r.mouse_nav.drag_pan&&(u=r.mouse_nav.kinetic?new b.Kinetic(-.005,.05,100):null,o.map.addInteraction(new R.DragPan({kinetic:u,condition:function(e){return!r.touch_nav.twoFingers||"mouse"===e.originalEvent.pointerType||!e.activePointers||1!==e.activePointers.length}}))),r.mouse_nav.wheel_zoom&&o.map.addInteraction(new R.MouseWheelZoom),r.mouse_nav.doubleclick_zoom&&o.map.addInteraction(new R.DoubleClickZoom),r.mouse_nav.drag_zoom&&o.map.addInteraction(new R.DragZoom({condition:w.shiftKeyOnly})),r.rotate)&&o.map.addInteraction(new R.DragRotateAndZoom({condition:function(e){var t=e.originalEvent;return t.ctrlKey&&t.shiftKey}})),r.touch_nav&&(r.touch_nav.rotate&&o.map.addInteraction(new R.PinchRotate),r.touch_nav.zoom&&o.map.addInteraction(new R.PinchZoom({constrainResolution:!0}))),r.keyboard_nav&&(r.keyboard_nav.pan&&o.map.addInteraction(new R.KeyboardPan),r.keyboard_nav.zoom&&o.map.addInteraction(new R.KeyboardZoom)),o.mapsControls=new _.MapsControls(o),o.mapsControls.init(),r.layerswitcher.enable&&(r.starboard.div?(o.reactContainer=document.querySelector("."+r.starboard.div),o.reactContainer?o.reactContainer.className+=" c4g-external ol-unselectable":(o.reactContainer=document.createElement("div"),o.reactContainer.className="c4g-sideboard c4g-starboard-container ol-unselectable",o.$overlaycontainer_stopevent.append(o.reactContainer))):(o.reactContainer=document.createElement("div"),o.reactContainer.className="c4g-sideboard c4g-starboard-container ol-unselectable",o.$overlaycontainer_stopevent.append(o.reactContainer)),r.starboard.open?o.reactContainer.className+=" c4g-open":o.reactContainer.className+=" c4g-close"),r.baselayerswitcher.enable&&(r.baselayerswitcher.div?(o.baselayerContainer=document.querySelector("."+r.baselayerswitcher.div),o.baselayerContainer?o.baselayerContainer.className+=" c4g-external c4g-baselayer-container ol-unselectable":(o.baselayerContainer=document.createElement("div"),o.baselayerContainer.className="c4g-sideboard c4g-baselayer-container ol-unselectable",o.$overlaycontainer_stopevent.append(o.baselayerContainer))):(o.baselayerContainer=document.createElement("div"),o.baselayerContainer.className="c4g-sideboard c4g-baselayer-container ol-unselectable",o.$overlaycontainer_stopevent.append(o.baselayerContainer)),r.starboard.open?o.baselayerContainer.className+=" c4g-open":o.baselayerContainer.className+=" c4g-close"),r.starboardscope.enable&&(r.starboardscope.div?(o.starboardscopeContainer=document.querySelector("."+r.starboardscope.div),o.starboardscopeContainer?o.starboardscopeContainer.className+=" c4g-external c4g-starboardscope-container ol-unselectable":(o.starboardscopeContainer=document.createElement("div"),o.starboardscopeContainer.className="c4g-sideboard c4g-starboardscope-container ol-unselectable",o.$overlaycontainer_stopevent.append(o.starboardscopeContainer))):(o.starboardscopeContainer=document.createElement("div"),o.starboardscopeContainer.className="c4g-sideboard c4g-starboardscope-container ol-unselectable",o.$overlaycontainer_stopevent.append(o.starboardscopeContainer)),r.starboardscope.open?o.starboardscopeContainer.className+=" c4g-open":o.starboardscopeContainer.className+=" c4g-close"),r.filterDiv&&(r.filterDiv="."===r.filterDiv[0]||"#"===r.filterDiv[0]?r.filterDiv:"."+r.filterDiv,o.filterContainerParent=document.querySelector(r.filterDiv),o.filterContainerParent&&(o.filterContainerParent.className+=" c4g-external",o.filterContainer=document.createElement("div"),T.default.render(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"loading..."')},k.default.createElement(N,{target:document.querySelector(r.filterDiv),mapController:o,direction:"top",className:"c4g-feature-filter"})),o.filterContainer),o.filterContainerParent.append(o.filterContainer))),r.legend.enable&&(r.legend.div?(o.infoPageContainer=document.querySelector("."+r.legend.div),o.infoPageContainer?o.infoPageContainer.className+=" c4g-external c4g-infopage-container ol-unselectable":(o.infoPageContainer=document.createElement("div"),o.infoPageContainer.className="c4g-sideboard c4g-infopage-container ol-unselectable c4g-close",o.$overlaycontainer_stopevent.append(o.infoPageContainer))):(o.infoPageContainer=document.createElement("div"),o.infoPageContainer.className="c4g-sideboard c4g-infopage-container ol-unselectable c4g-close",o.$overlaycontainer_stopevent.append(o.infoPageContainer))),r.measuretools.enable){var Z="measuretools"===r.initial_open_comp?"c4g-open":"c4g-close";r.measuretools.div?(o.measuretoolsContainer=document.querySelector("."+r.measuretools.div),o.measuretoolsContainer?o.measuretoolsContainer.className+=" c4g-external c4g-measuretools-container ol-unselectable":(o.measuretoolsContainer=document.createElement("div"),o.measuretoolsContainer.className="c4g-sideboard c4g-measuretools-container ol-unselectable "+Z,o.$overlaycontainer_stopevent.append(o.measuretoolsContainer))):(o.measuretoolsContainer=document.createElement("div"),o.measuretoolsContainer.className="c4g-sideboard c4g-measuretools-container ol-unselectable "+Z,o.$overlaycontainer_stopevent.append(o.measuretoolsContainer))}if(r.permalink.enable&&(r.permalink.div?(o.permalinkContainer=document.querySelector(".c4g-external-permalink-container"),o.permalinkContainer?o.permalinkContainer.className+=" c4g-external":(o.permalinkContainer=document.createElement("div"),o.permalinkContainer.className="c4g-sideboard c4g-permalink-container ol-unselectable c4g-close",o.$overlaycontainer_stopevent.append(o.permalinkContainer))):(o.permalinkContainer=document.createElement("div"),o.permalinkContainer.className="c4g-sideboard c4g-permalink-container ol-unselectable c4g-close",o.$overlaycontainer_stopevent.append(o.permalinkContainer))),r.overviewmap&&(o.overviewContainer=document.createElement("div"),o.overviewContainer.className="c4g-sideboard c4g-overviewmap-container c4g-close",o.$overlaycontainer_stopevent.append(o.overviewContainer)),r.geopicker&&r.geopicker.type,r.themeData){var W=document.getElementById(r.mapDiv);r.themeData.useglobal&&(W=document.getElementById("wrapper")||document.documentElement),c=document.getElementById(r.mapDiv);var Q="100%",X="100%";if(r.width&&(Q=r.width),X=r.height?r.height:c&&c.offsetHeight&&c.offsetHeight?"100%":"100vh",c&&c.style&&(c.style.setProperty("--map-height",X),c.style.setProperty("--map-width",Q)),r.themeData.maincolor){var Y=g.utils.getRgbaFromHexAndOpacity(r.themeData.maincolor,r.themeData.mainopacity),q=g.utils.getRgbaFromHexAndOpacity(r.themeData.fontcolor,r.themeData.fontopacity),K=g.utils.getRgbaFromHexAndOpacity(r.themeData.shadowcolor,r.themeData.shadowopacity),$=g.utils.getRgbaFromHexAndOpacity(r.themeData.popupMaincolor,r.themeData.popupMainopacity),J=g.utils.getRgbaFromHexAndOpacity(r.themeData.popupFontcolor,r.themeData.popupFontopacity);W&&W.style&&(W.style.setProperty("--main-color",Y),W.style.setProperty("--font-color",q),W.style.setProperty("--pu-main-color",$),W.style.setProperty("--pu-font-color",J),W.style.setProperty("--shadow-color",K))}W&&r.themeData.buttonradius&&(W.style.setProperty("--button-radius-percent",r.themeData.buttonradius+"%"),W.style.setProperty("--button-radius-pixel",r.themeData.buttonradius+"px")),W&&r.themeData.buttonsize&&W.style.setProperty("--button-size-pixel",r.themeData.buttonsize+"px"),W&&r.themeData.fontsize&&W.style.setProperty("--button-fontsize-pixel",r.themeData.fontsize+"px"),W&&r.themeData.popupMaxWidth&&W.style.setProperty("--popup-max-width",r.themeData.popupMaxWidth)}if(r.caching){var ee=g.utils.getValue("popupInfos");if(ee&&parseInt(r.popupHandling,10)){o.data.initial_open_comp="";var oe=JSON.parse(ee),re=new E.default;re.set("popup",oe);var ae=new y.Vector;window.setTimeout(function(){o.proxy.handlePopup(re,ae)},100)}}var se=o;if(o.map.on("change:size",function(){se.setState({}),se.map&&se.map.getSize()&&c&&c.style&&c.style.setProperty("--map-height",se.map.getSize()[1]+"px")}),r.userLocation&&new j.UserPosition(o),window.c4gMapsHooks.addControls){var ne=[];for(var le in g.utils.callHookFunctions(window.c4gMapsHooks.addControls,ne),ne)ne.hasOwnProperty(le)&&o.map.addControl(new f.default(ne[le]))}return o}return(0,u.default)(t,e),(0,l.default)(t,[{key:"setLayersInitial",value:function(e,t){this.setState({objLayers:e,arrLayerStates:t})}},{key:"setBaselayerId",value:function(e){this.setState({activeBaselayerId:e})}},{key:"setObjLayers",value:function(e){this.setState({objLayers:e})}},{key:"setLocStyles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?this.setState({styleData:e},t()):this.setState({styleData:e})}},{key:"setLayerStates",value:function(e){if(this._isMounted&&e&&e.length>0){var t=!1;if(e.length!==this.state.arrLayerStates.length)t=!0;else for(var o in e)if(e.hasOwnProperty(o)&&e[o]!==this.state.arrLayerStates[o]){t=!0;break}t&&this.setState({arrLayerStates:e})}}},{key:"getCurrentLayerStates",value:function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&(e[o].active&&t.push(e[o].id),e[o].childStates&&(t=t.concat(this.getCurrentLayerStates(e[o].childStates))));return t}},{key:"setLayerStateWithId",value:function(e,t){var o=structuredClone(this.state.arrLayerStates);for(var r in o)o.hasOwnProperty(r)&&(o[r]=this.getLayerStateWithId(o[r],e,t));this.setState({arrLayerStates:o})}},{key:"getLayerStateWithId",value:function(e,t,o){for(var r in e.id===t&&(e.active=o),e.childStates)e.childStates.hasOwnProperty(r)&&(e.childStates[r]=this.getLayerStateWithId(e.childStates[r],t,o));return e}},{key:"changeActiveLayers",value:function(e){var t=this.state.arrLayerStates;for(var o in t)if(t.hasOwnProperty(o)){if("all"!==this.state.objLayers[o].activeForBaselayers){var r=t[o].active;t[o].active=!!this.state.objLayers[o].activeForBaselayers.find(function(t){return t===e}),r!==t[o].active&&(t[o].active?this.proxy.layerController.show(this.state.objLayers[o].id,this.state.objLayers[o].features||this.state.objLayers[o].vectorLayer):this.proxy.layerController.hide(this.state.objLayers[o].id,this.state.objLayers[o].features||this.state.objLayers[o].vectorLayer))}for(var a in t[o].childStates)t[o].childStates.hasOwnProperty(a)&&(t[o].childStates[a]=this.changeActiveLayerChilds(t[o].childStates[a],this.state.objLayers[o].childs[a],e))}this.setState({arrLayerStates:t})}},{key:"changeActiveLayerChilds",value:function(e,t,o){if(t.activeForBaselayers&&"all"!==t.activeForBaselayers){var r=e.active;e.active=!!t.activeForBaselayers.find(function(e){return e===o}),r!==e.active&&(e.active?this.proxy.layerController.show(t.id,t.features||t.vectorLayer):this.proxy.layerController.hide(t.id,t.features||t.vectorLayer))}for(var a in e.childStates)e.childStates.hasOwnProperty(a)&&(e.childStates[a]=this.changeActiveLayerChilds(e.childStates[a],t.childs[a],o));return e}},{key:"setTabLayers",value:function(e,t){this.setState({objTabLayers:e,arrTabLayerStates:t})}},{key:"setTabStates",value:function(e){this.setState({arrTabLayerStates:e})}},{key:"hideOtherComponents",value:function(e){var t=this.components;for(var o in t)t.hasOwnProperty(o)&&t[o]&&t[o]!==e&&(t[o].close?t[o].close():t[o].setState({open:!1}))}},{key:"changeCollapseState",value:function(e,t){var o=(0,s.default)(this.state.arrLayerStates);o[e]=t,this.setState({arrLayerStates:o})}},{key:"hideOtherBottomComponents",value:function(e){var t=this.components;for(var o in t)t.hasOwnProperty(o)&&t[o]&&t[o]!==e&&t[o].setState({openResults:!1})}},{key:"getActiveComponents",value:function(){var e=this.components,t=[];for(var o in e)e.hasOwnProperty(o)&&e[o]&&e[o].state.open&&t.push(e[o]);return t}},{key:"render",value:function(){var e=this,t=this.data,o=document.querySelector("#"+t.mapDiv+" .c4g-control-container-top-left");this.arrComponents=this.arrComponents||[{name:"layerswitcher",sort:t.layerswitcher.enable},{name:"geosearch",sort:t.geosearch.enable},{name:"legend",sort:t.legend.enable},{name:"baselayerswitcher",sort:t.baselayerswitcher.enable},{name:"starboardscope",sort:t.starboardscope.enable},{name:"measuretools",sort:t.measuretools.enable},{name:"permalink",sort:t.permalink.enable},{name:"zoom",sort:t.zoom},{name:"zoomPosition",sort:t.zoomPosition},{name:"zoomHome",sort:t.zoomHome},{name:"zoomExtent",sort:t.zoomExtent},{name:"fullscreen",sort:t.fullscreen},{name:"print",sort:t.print},{name:"rotate",sort:t.rotate},{name:"graticule",sort:t.graticule},{name:"overview",sort:t.overviewmap},{name:"router",sort:t.router_enable},{name:"editor",sort:t.editor.enable}];var r="",a=this.data.caching?g.utils.getValue("panel"):"";a&&(t.initial_open_comp=""),t.layerswitcher.enable&&(r=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"Loading..."')},k.default.createElement(U,{ref:function(t){e.components.starboard=t},target:o,mapController:this,objLayers:this.state.objLayers,styleData:this.state.styleData,tabLayers:this.state.objTabLayers,tabStates:this.state.arrTabLayerStates,layerStates:this.state.arrLayerStates,parentCallback:this.setLayerStates,tabCallback:this.setTabStates,direction:"right",open:"starboard"===t.initial_open_comp||"StarboardPanel"===a,changeCollapseState:this.changeCollapseState,external:-1!==this.reactContainer.className.indexOf("c4g-external")})),this.reactContainer));var s="";if(t.geosearch.enable){var n=this.createGeosearchOptions();n.ref=function(t){e.components.geosearch=t},s=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"Loading..."')},k.default.createElement(F,n)),this.searchContainer)}var l="",i=void 0,c=void 0;this.proxy.baselayers_loaded&&(i=this.proxy.baselayerController.arrBaselayers[this.state.activeBaselayerId])&&i.hasOverlays&&(c=i.overlays[0]);var u=t.infopage;u&&i&&i.infopage?u=u+"<br/>"+i.infopage:i&&i.infopage&&(u=i.infopage),u&&c&&c.infopage?u=u+"<br/>"+c.infopage:c&&c.infopage&&(u=c.infopage),u&&t.legend.enable&&(l=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"Loading..."')},k.default.createElement(G,{ref:function(t){e.components.infopage=t},target:o,external:-1!==this.infoPageContainer.className.indexOf("c4g-external"),infoContent:u,mapController:this,open:"legend"===t.initial_open_comp||"Infopage"===a})),this.infoPageContainer));var p="";t.baselayerswitcher.enable&&(p=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"Loading..."')},k.default.createElement(D,{ref:function(t){e.components.baselayerSwitcher=t},target:o,open:"baselayers"===t.initial_open_comp||"BaselayerSwitcher"===a,changeActiveLayers:this.changeActiveLayers,external:-1!==this.baselayerContainer.className.indexOf("c4g-external"),mapController:this,baselayerController:this.proxy.baselayerController})),this.baselayerContainer));var d="";t.starboardscope.enable&&(d=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"Loading..."')},k.default.createElement(M,{ref:function(t){e.components.starboardScope=t},target:o,open:"starboardscope"===t.initial_open_comp||"StarboardScope"===a,mapController:this})),this.starboardscopeContainer));var m="";t.measuretools.enable&&(m=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"Loading..."')},k.default.createElement(z,{ref:function(t){e.components.measuretools=t},target:o,open:"measuretools"===t.initial_open_comp||"MeasureTools"===a,mapController:this})),this.measuretoolsContainer));var h="";t.permalink.enable&&(h=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,'"loading..."')},k.default.createElement(H,{ref:function(t){e.components.permalink=t},saveIds:t.permalink.saveIds,mapController:this,target:o,external:-1!==this.permalinkContainer.className.indexOf("c4g-external")})),this.permalinkContainer));var f="";if(t.overviewmap){var _;if(this.proxy.baselayers_loaded){var v=this.proxy.baselayerController.arrBaselayers[this.state.activeBaselayerId].layer;_=v instanceof y.Group?v.getLayers().getArray()[0].getSource():v.getSource()}f=T.default.createPortal(k.default.createElement(k.Suspense,{fallback:k.default.createElement("div",null,"Loading...")},k.default.createElement(K,{ref:function(t){e.components.overviewMap=t},mapController:this,target:o,source:_,ovmTarget:this.overviewContainer,collapsed:!0,key:23})),this.overviewContainer)}var b=[];this.arrComponents.sort(function(e,t){return e.sort>t.sort?1:-1}),this.arrComponents=this.arrComponents.filter(function(e){return e.sort&&e.sort>0});for(var C=0;C<this.arrComponents.length;C++)switch(this.arrComponents[C].name){case"measuretools":b.push(m);break;case"baselayerswitcher":b.push(p);break;case"geosearch":b.push(s);break;case"layerswitcher":b.push(r);break;case"starboardscope":b.push(d);break;case"legend":b.push(l);break;case"permalink":b.push(h);break;case"zoom":t.zoom&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(B,{mapController:this,target:o,key:C})));break;case"zoomExtent":t.zoomExtent&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(V,{mapController:this,target:o,key:C})));break;case"zoomHome":t.zoomHome&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(Z,{mapController:this,target:o,key:C})));break;case"zoomPosition":t.zoomPosition&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(W,{mapController:this,target:o,key:C})));break;case"fullscreen":t.fullscreen&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(Y,{mapController:this,target:o,key:C})));break;case"print":t.print&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(q,{mapController:this,target:o,key:C})));break;case"rotate":t.rotate&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(X,{mapController:this,target:o,key:C})));break;case"graticule":t.graticule&&b.push(k.default.createElement(k.Suspense,{key:C,fallback:k.default.createElement("div",null,'"loading...')},k.default.createElement(Q,{mapController:this,target:o,key:C})));break;case"overview":t.overviewmap&&b.push(f);break;case"router":if(this.data.router_enable){void 0!==this.data&&(J="de"===this.data.lang?L.routingConstantsGerman:(this.data.lang,I.routingConstantsEnglish));var R={target:document.querySelector("#"+this.data.mapDiv+" .c4g-control-container-top-left"),mapController:this,direction:"top",withPosition:!1,detourRoute:this.data.detourRoute,detourArea:this.data.detourArea,containerAddresses:ee,langConstants:J,ref:function(t){e.components.router=t},key:22,open:"routing"===t.initial_open_comp||"RouterView"===a},S="routing"===t.initial_open_comp||"RouterView"===a;if(this.routerContainer||(this.data.router_div?(this.routerContainer=document.querySelector("."+this.data.router_div),this.routerContainer?this.routerContainer.className+=" c4g-external":(this.routerContainer=document.createElement("div"),this.routerContainer.className="c4g-sideboard c4g-router-container-right "+(S?"c4g-open":"c4g-close"),jQuery(".ol-overlaycontainer-stopevent").append(this.routerContainer))):(this.routerContainer=document.createElement("div"),this.routerContainer.className="c4g-sideboard c4g-router-container-right "+(S?"c4g-open":"c4g-close"),jQuery(".ol-overlaycontainer-stopevent").append(this.routerContainer))),P.RouterView&&R){var E=k.default.createElement(P.RouterView,R);if(E&&this&&this.routerContainer){var O=T.default.createPortal(E,this.routerContainer);O&&b.push(O)}}}break;case"editor":if(t.feEditorProfile&&"0"!==t.feEditorProfile){if(!this.editorContainer)if(this.data.editor_div){this.editorContainer=document.querySelector("."+this.data.editor_div);var w="editor"===t.initial_open_comp||"EditorView"===a;this.editorContainer?this.editorContainer.className+=" c4g-external":(this.editorContainer=document.createElement("div"),this.editorContainer.className="c4g-sideboard c4g-editor-container-right "+(w?"c4g-open":"c4g-close"),jQuery(".ol-overlaycontainer-stopevent").append(this.editorContainer))}else{var j="editor"===t.initial_open_comp||"EditorView"===a;this.editorContainer=document.createElement("div"),this.editorContainer.className="c4g-sideboard c4g-editor-container-right "+(j?"c4g-open":"c4g-close"),jQuery(".ol-overlaycontainer-stopevent").append(this.editorContainer)}var x={tipLabel:te.CTRL_EDITOR,type:t.editor.type||"frontend",inputField:t.editor.inputField||!1,target:t.editor.target||document.querySelector("#"+this.data.mapDiv+" .c4g-control-container-top-left"),initOpen:t.editor.open||!1,config:t.editor.config||!1,dataField:t.editor.data_field||!1,caching:t.caching,ref:function(t){e.components.editor=t},mapController:this,open:"editor"===t.initial_open_comp||"EditorView"===a};b.push(T.default.createPortal(k.default.createElement($,x),this.editorContainer))}else if("backend"==t.editor.type){this.editorContainer||(this.data.editor_div?(this.editorContainer=document.querySelector("."+this.data.editor_div),this.editorContainer?this.editorContainer.className+=" c4g-external":(this.editorContainer=document.createElement("div"),this.editorContainer.className="c4g-sideboard c4g-editor-container-right c4g-close",jQuery(".ol-overlaycontainer-stopevent").append(this.editorContainer))):(this.editorContainer=document.createElement("div"),this.editorContainer.className="c4g-sideboard c4g-editor-container-right c4g-open",jQuery(".ol-overlaycontainer-stopevent").append(this.editorContainer)));var A={tipLabel:te.CTRL_EDITOR,type:t.editor.type||"frontend",inputField:t.editor.inputField||"#c4gGeoEditorGeoData",target:t.editor.target||document.querySelector("#"+this.data.mapDiv+" .c4g-control-container-top-left"),initOpen:t.editor.open||!1,config:t.editor.config||!1,dataField:t.editor.data_field||!1,caching:t.caching,mapController:this,open:!0};b.push(T.default.createPortal(k.default.createElement($,A),this.editorContainer))}}return k.default.createElement(k.default.Fragment,null,b)}},{key:"setOpenComponent",value:function(e){var t=this;this.setState({openComponent:e},function(){for(var o in t.components)if(t.components.hasOwnProperty(o)){var r=t.components[o];r&&r!==e&&(r.close?r.close():r.setState({open:!1}))}})}},{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentDidUpdate",value:function(e,t,o){var r=this,a=this.map.getControls().getArray(),s=function(e){r.arrComponents.hasOwnProperty(e)&&r.arrComponents[e].control&&(a.find(function(t){var o=t.element,a=r.arrComponents[e].control.element;return o.className==a.className})||r.map.addControl(r.arrComponents[e].control))};for(var n in this.arrComponents)s(n)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"createGeosearchOptions",value:function(){var e=this.data,t={};return e.geosearch&&e.geosearch.enable&&(this.searchContainer||(e.geosearch.div?(this.searchContainer=document.querySelector("."+e.geosearch.div),this.searchContainer.className+=" c4g-external",this.searchContainer||(this.searchContainer=document.createElement("div"),this.searchContainer.className="c4g-sideboard c4g-geosearch-container-right ",this.searchContainer.className+="c4g-close",this.$overlaycontainer_stopevent.append(this.searchContainer))):(this.searchContainer=document.createElement("div"),this.searchContainer.className="c4g-sideboard c4g-geosearch-container-right ",this.searchContainer.className+="c4g-close"),e.geosearch.div||this.$overlaycontainer_stopevent.append(this.searchContainer)),t={mapController:this,target:document.querySelector("#"+e.mapDiv+" .c4g-control-container-top-left"),extDiv:e.geosearch.div||!1,extResultsDiv:e.geosearch.div_results||!1,collapsible:!0,collapsed:"search"!==e.initial_open_comp,label:" ",collapsedLabel:"",searchZoom:e.geosearch.searchzoom,zoomBounds:e.geosearch.zoombounds,quicksearch:!0,animate:e.geosearch.animate,animateDuration:e.geosearch.animate_duration,markResult:e.geosearch.markresult,resultDuration:e.geosearch.result_duration,popup:e.geosearch.popup,autopick:e.geopicker,caching:e.caching,results:e.geosearch.results,resultCount:e.geosearch.result_count,resultsHeadline:e.geosearch.results_headline,headline:e.geosearch.headline,resultStyle:e.geosearch.result_locstyle,placeholder:e.geosearch.placeholder,external:-1!==this.searchContainer.className.indexOf("c4g-external")}),t}}])}(k.Component)},"./src/Resources/public/js/components/c4g-popup-container.jsx"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.PopupContainer=void 0;var s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),c=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),u=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var o,r,s={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return s;if(o=t){if(o.has(e))return o.get(e);o.set(e,s)}for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&((r=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,n))&&(r.get||r.set)?o(s,n,r):s[n]=e[n]);return s}(e)}(o("./node_modules/react/index.js")),p=o("./src/Resources/public/js/c4g-maps-i18n.js"),d=o("./src/Resources/public/js/c4g-maps-utils.js");function m(e,t,o){return t=(0,i.default)(t),(0,l.default)(e,h()?Reflect.construct(t,o||[],(0,i.default)(e).constructor):t.apply(e,o))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(h=function(){return!!e})()}var y=u.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-titlebar_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-titlebar.jsx"))});t.PopupContainer=function(e){function t(e){var o;return(0,s.default)(this,t),(o=m(this,t,[e])).state={content:"",open:e.open,detailsOpen:!1,activeComps:e.activeComps,conststr:!1},e.hideOther(o),o.routeButtons="",o.language=(0,p.getLanguage)(o.props.mapData),o.close=o.close.bind(o),o.toggleDetails=o.toggleDetails.bind(o),o}return(0,c.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this,t=this.props.external?"c4g-popup-container ":"c4g-sideboard c4g-popup-container ";this.state.open?t+="c4g-open ":t+="c4g-close",this.props.alwaysExtended||this.state.detailsOpen?t+=" c4g-details-open":t+=" c4g-details-closed";var o="c4g-popup-header",r=u.default.createElement("div",null);return this.state.conststr&&(o+=" c4g-routing",r=u.default.createElement(this.state.conststr,{config:this.state.config})),this.state.content?u.default.createElement("div",{className:t},u.default.createElement("div",{className:"c4g-popup-wrapper"},u.default.createElement(u.Suspense,{fallback:u.default.createElement("div",null,"Loading...")},u.default.createElement(y,{wrapperClass:o,headerClass:"c4g-popup-header-headline",header:this.props.mapData.popupHeadline||"",closeBtnClass:"c4g-titlebar-close",closeBtnCb:function(){e.close(!0)},closeBtnTitle:this.language.CLOSE,detailBtnClass:"",detailBtnCb:""},r)),u.default.createElement("div",{className:"c4g-popup-content",dangerouslySetInnerHTML:{__html:this.state.content}}))):null}},{key:"setAddButtons",value:function(e,t){this.setState({config:t,conststr:e})}},{key:"setContent",value:function(e,t){this.setState({content:e})}},{key:"open",value:function(e){this.props.external||this.props.hideOther(),this.setState({open:!0,activeComps:e})}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.props.mapData.caching&&d.utils.storeValue("popupInfos",""),e&&this.state.activeComps)for(var t in this.state.activeComps)this.state.activeComps.hasOwnProperty(t)&&this.state.activeComps[t].setState({open:!0});var o={open:!1,content:this.props.external?"":this.state.content};this.setState(o)}},{key:"toggleDetails",value:function(){this.setState({detailsOpen:!this.state.detailsOpen})}},{key:"componentDidUpdate",value:function(e,t,o){t.open&&!this.state.open&&this.props.mapData.caching&&d.utils.storeValue("popupInfos","")}}])}(u.Component)},"./src/Resources/public/js/components/c4g-router-popup-buttons.jsx"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.RouterPopupButtons=void 0;var s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),c=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),u=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var o,r,s={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return s;if(o=t){if(o.has(e))return o.get(e);o.set(e,s)}for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&((r=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,n))&&(r.get||r.set)?o(s,n,r):s[n]=e[n]);return s}(e)}(o("./node_modules/react/index.js")),p=o("./node_modules/ol/geom.js"),d=(o("./src/Resources/public/js/routing-constant-i18n.js"),o("./node_modules/ol/proj.js")),m=r(o("./node_modules/ol/format/GPX.js"));function h(e,t,o){return t=(0,i.default)(t),(0,l.default)(e,y()?Reflect.construct(t,o||[],(0,i.default)(e).constructor):t.apply(e,o))}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}t.RouterPopupButtons=function(e){function t(e){return(0,s.default)(this,t),h(this,t,[e])}return(0,c.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this,t=this,r=this.props.config.feature.getGeometry();if(r){if(r instanceof p.LineString)return u.default.createElement("div",null,u.default.createElement("button",{className:"c4g-icon c4g-popup-route-download",title:this.props.config.router.languageConstants.ROUTER_DOWNLOAD,onMouseUp:function(){!function(){var e=t.props.config.feature,o=(new m.default).writeFeatures([e],{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326",decimals:3}),r=document.createElement("a");r.setAttribute("href","data:text/xml;charset=utf-8,"+encodeURIComponent(o));var a=e.get("name")||"route";r.setAttribute("download",a+".gpx"),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}()}}),u.default.createElement("button",{className:"c4g-icon c4g-popup-route-edit",title:this.props.config.router.languageConstants.POPUP_ROUTE_EDIT,onMouseUp:function(){!function(){for(var a=r.getCoordinates(),s=1;a.length>15;)if(a=(r=r.simplify(s)).getCoordinates(),(s+=2)>42)return void Promise.all([o.e("vendors-CoreBundle_node_modules_sweetalert2_dist_sweetalert2_all_js"),o.e("CoreBundle_src_Resources_public_vendor_js_AlertHandler_js")]).then(o.bind(o,"../CoreBundle/src/Resources/public/vendor/js/AlertHandler.js")).then(function(e){(new e.AlertHandler).showInfoDialog(t.props.config.router.languageConstants.ROUTER_VIEW_ALERT_ERROR,t.props.config.router.languageConstants.ROUTER_ERROR_LINESTRING)});e.props.config.router.openControls(!0),e.props.config.router.setMode("route");var n=(0,d.toLonLat)(a[0],"EPSG:3857");e.props.config.router.setRouteFrom(n[0],n[1]);var l=a.slice(1,a.length-2);e.props.config.router.addOverPoints(l);var i=(0,d.toLonLat)(a[a.length-1],"EPSG:3857");e.props.config.router.setRouteTo(i[0],i[1])}()}}));var a;if(r instanceof p.Polygon){var s=r.getExtent();a=[(s[0]+s[2])/2,(s[1]+s[3])/2]}else a=r.getCoordinates();return u.default.createElement("div",null,u.default.createElement("button",{className:"c4g-icon c4g-popup-route-from",title:this.props.config.router.languageConstants.POPUP_ROUTE_FROM,onMouseUp:function(){!function(){e.props.config.router.openControls(!0),e.props.config.router.setMode("route");var t=(0,d.toLonLat)(a,"EPSG:3857");e.props.config.router.setRouteFrom(t[0],t[1])}()}}),u.default.createElement("button",{className:"c4g-icon c4g-popup-route-to",title:this.props.config.router.languageConstants.POPUP_ROUTE_TO,onMouseUp:function(){!function(){e.props.config.router.openControls(!0),e.props.config.router.setMode("route");var t=(0,d.toLonLat)(a,"EPSG:3857");e.props.config.router.setRouteTo(t[0],t[1])}()}}))}return null}}])}(u.Component)},"./src/Resources/public/js/components/c4g-router-result-container.jsx"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.RouterResultContainer=void 0;var s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),c=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),u=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var o,r,s={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return s;if(o=t){if(o.has(e))return o.get(e);o.set(e,s)}for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&((r=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,n))&&(r.get||r.set)?o(s,n,r):s[n]=e[n]);return s}(e)}(o("./node_modules/react/index.js")),p=r(o("./node_modules/ol/format/GPX.js")),d=r(o("./node_modules/ol/format/GeoJSON.js")),m=o("./src/Resources/public/js/c4g-router-time-conversions.js"),h=(o("./src/Resources/public/js/components/c4g-titlebar.jsx"),r(o("./node_modules/react-dom/index.js")));function y(e,t,o){return t=(0,i.default)(t),(0,l.default)(e,f()?Reflect.construct(t,o||[],(0,i.default)(e).constructor):t.apply(e,o))}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}var g=u.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-router-instructions-container_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-router-instructions-container.jsx"))}),_=u.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-router-feature-list_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-router-feature-list.jsx"))});t.RouterResultContainer=function(e){function t(e){var o;return(0,s.default)(this,t),(o=y(this,t,[e])).clickControl=o.clickControl.bind(o),o.profileTranslation={0:"car",1:"hgv",2:"bike",3:"bike",4:"bike",5:"bike",6:"bike",7:"bike",8:"foot",9:"foot",10:"wheelchair",11:"hgv",12:"scooter",13:"scooter"},window.c4gMapsHooks.hook_map_click=window.c4gMapsHooks.hook_map_click||[],window.c4gMapsHooks.hook_map_click.push(function(e){var t=o.props.mapController.map.forEachFeatureAtPixel(e.pixel,function(e,t){return e});if(t&&t.get("tid")){var r=t.get("tid");o.props.setResultFeat(e),o.props.setActiveId(r)}}),o}return(0,c.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this,t="",o="",r="",a="",s="";this.props.routerInstructions&&this.props.routerInstructions.instructions&&"route"===this.props.mode?(o=(0,m.toHumanTime)(this.props.routerInstructions.time),r=(0,m.toHumanDistance)(this.props.routerInstructions.distance)):this.props.featureList&&"area"===this.props.mode&&(a=this.props.detour,s=this.props.featureList.features.length);var n="",l=function(){var t="instr"===e.props.resultMode?".c4g-route-instructions-wrapper":".c4g-route-feature-wrapper",o=document.querySelector(t).cloneNode(!0);if("instr"===e.props.resultMode){var r=e.props.router.state.fromAddress,a=document.createElement("div"),s=document.createElement("label");s.innerHTML=e.props.lang.ROUTER_FROM+": ";var n=document.createElement("em");n.innerHTML=r,a.appendChild(s),a.appendChild(n),a.appendChild(document.createElement("em"));var l=e.props.router.state.toAddress,i=document.createElement("div"),c=document.createElement("label");c.innerHTML=e.props.lang.ROUTER_FROM+": ";var u=document.createElement("em");u.innerHTML=l,i.appendChild(c),i.appendChild(u),i.appendChild(document.createElement("em")),o.querySelector(".c4g-router-instructions-header").appendChild(a),o.querySelector(".c4g-router-instructions-header").appendChild(i)}o.querySelector(".c4g-router-print").remove();var p=window.open("","","left=0,top=0,width=800,height=900,toolbar=0,scrollbars=0,status=0");p.document.write(o.innerHTML),p.document.close(),p.focus(),p.print(),p.close()};if(o&&r&&"route"===this.props.mode){var i=null;this.props.mapController.data.editor&&this.props.mapController.data.editor.config&&this.props.mapController.data.editor.config.drawStyles&&this.props.mapController.data.editor.config.drawStyles.LineString&&this.props.mapController.data.editor.config.drawStyles.LineString.elements&&this.props.mapController.data.editor.config.drawStyles.LineString.elements.length>0&&(i=u.default.createElement("button",{className:"c4g-router-editor",title:this.props.lang.ROUTER_EDITOR,onMouseUp:function(){e.exportEditor()}})),n=u.default.createElement("div",{className:"c4g-router-instructions-header"},u.default.createElement("div",{className:"c4g-router-route-time"},u.default.createElement("label",null,this.props.lang.ROUTER_VIEW_LABEL_TIME),u.default.createElement("em",null,o)),u.default.createElement("div",{className:"c4g-router-route-distance"},u.default.createElement("label",null,this.props.lang.ROUTER_VIEW_LABEL_DISTANCE),u.default.createElement("em",null,r)),u.default.createElement("button",{className:"c4g-router-download",title:this.props.lang.ROUTER_DOWNLOAD,onMouseUp:function(){e.exportGpx()}}),u.default.createElement("button",{className:"c4g-router-print",title:this.props.lang.ROUTER_PRINT,onMouseUp:function(){l()}}),i)}else a&&s&&"area"===this.props.mode&&(n=u.default.createElement("div",{className:"c4g-router-instructions-header"},u.default.createElement("div",{className:"c4g-router-area-detour"},u.default.createElement("label",null,this.props.lang.AREA_DETOUR,":"),u.default.createElement("em",null,a," km")),u.default.createElement("div",{className:"c4g-router-area-featurecount"},u.default.createElement("label",null,this.props.lang.AREA_FEATURECOUNT,":"),u.default.createElement("em",null,s)),u.default.createElement("button",{className:"c4g-router-print",onMouseUp:function(){l()}})));if("instr"===this.props.resultMode&&this.props.routerInstructions&&"route"===this.props.mode?t=u.default.createElement(u.Suspense,{fallback:u.default.createElement("div",null,'"loading.."')},u.default.createElement(g,{className:"c4g-route-instructions-wrapper",mapController:this.props.mapController,routerInstructions:this.props.routerInstructions,routerWaySource:this.props.routerWaySource,routerHintSource:this.props.routerHintSource,open:this.props.open,header:n})):("feat"===this.props.resultMode||"area"===this.props.mode||!this.props.routerInstructions&&this.props.featureList)&&(t=u.default.createElement(u.Suspense,{fallback:u.default.createElement("div",null,'"loading.."')},u.default.createElement(_,{className:"c4g-route-feature-wrapper",activeId:this.props.activeId,setActiveId:this.props.setActiveId,routeMode:this.props.mode,layerRoute:this.props.layerRoute,layerArea:this.props.layerArea,featureList:this.props.featureList,mapController:this.props.mapController,featureSource:this.props.featureSource,layerValueRoute:this.props.layerValueRoute,layerValueArea:this.props.layerValueArea,header:n}))),this.props.open){var c=this.props.mapController.data.routerResultDiv?document.querySelector("."+this.props.mapController.data.routerResultDiv):null;return c?h.default.createPortal(u.default.createElement("div",{className:this.props.className+(this.props.open?" c4g-open":" c4g-close")+(this.props.open?" c4g-details-open":"")},t),c):u.default.createElement("div",{className:this.props.className+(this.props.open?" c4g-open":" c4g-close")+(this.props.open?" c4g-details-open":"")},t)}return null}},{key:"componentDidUpdate",value:function(e,t){if(!e.open&&this.props.open){var o=document.querySelector("."+this.props.mapController.data.routerResultDiv);o&&(o.parentElement.className=o.parentElement.className.replace("c4g-close","")+" c4g-open",this.props.mapController.map.updateSize())}else if(e.open&&!this.props.open&&!e.open&&this.props.open){var r=document.querySelector("."+this.props.mapController.data.routerResultDiv);r&&(r.parentElement.className=r.parentElement.className.replace("c4g-open","")+" c4g-close",this.props.mapController.map.updateSize())}var a=this.props.className+(this.props.open?" c4g-open":" c4g-close"),s=document.getElementsByClassName(a)[0],n=document.querySelector(".c4g-router-panel.c4g-open");n&&(n=n[0]);var l=!!document.querySelector(".c4g_map")&&document.querySelector(".c4g_map")[0];l&&s&&n&&s.offsetHeight+n.offsetHeight+84>l.offsetHeight&&(s.style.height=l.offsetHeight-n.offsetHeight),"area"===this.props.mode&&"feat"!==this.props.resultMode&&this.props.router.setState({resultMode:"feat"})}},{key:"open",value:function(){this.props.setOpen(!0)}},{key:"close",value:function(){this.props.setOpen(!1)}},{key:"clickControl",value:function(){this.props.open?this.close():this.open()}},{key:"exportGpx",value:function(){var e=this.props.router.routerWaySource,t=new p.default;if(e&&e.getFeatures&&e.getFeatures()){var o=t.writeFeatures(e.getFeatures(),{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326",decimals:3}),r=document.createElement("a");r.setAttribute("href","data:text/xml;charset=utf-8,"+encodeURIComponent(o)),r.setAttribute("download","route.gpx"),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),console.log(o)}}},{key:"exportEditor",value:function(){var e=this,t=this.props.router.routerWaySource;if(new d.default,t&&t.getFeatures&&t.getFeatures()){var r=t.getFeatures()[0],a={},s=this.props.mapController.data.editor.config.drawStyles.LineString.elements;for(var n in s)s.hasOwnProperty(n)&&(a[n]=s[n].name);Promise.all([o.e("vendors-CoreBundle_node_modules_sweetalert2_dist_sweetalert2_all_js"),o.e("CoreBundle_src_Resources_public_vendor_js_AlertHandler_js")]).then(o.bind(o,"../CoreBundle/src/Resources/public/vendor/js/AlertHandler.js")).then(function(t){(new t.AlertHandler).showSelectDialog(e.props.lang.ROUTER_EDITOR_ELEMENT,a,e.props.lang.ACCEPT,e.props.lang.CANCEL).then(function(t){var o=s[t].styleId;r.set("editorId",t),r.setId(),r.set("locstyle",o);var a=(new d.default).writeFeatureObject(r,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326",decimals:6});e.props.router.openControls(!1),e.props.mapController.editor.open(),e.props.mapController.editor.addFeature(a),e.props.mapController.editor.reRender()})})}}},{key:"slideInCollidingElements",value:function(){}},{key:"slideOutCollidingElements",value:function(){}}])}(u.Component)},"./src/Resources/public/js/components/c4g-router-view.jsx"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.RouterView=void 0;var s=r(o("./node_modules/@babel/runtime/regenerator/index.js")),n=r(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),d=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var o,r,s={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return s;if(o=t){if(o.has(e))return o.get(e);o.set(e,s)}for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&((r=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,n))&&(r.get||r.set)?o(s,n,r):s[n]=e[n]);return s}(e)}(o("./node_modules/react/index.js")),m=o("./src/Resources/public/js/components/c4g-router-result-container.jsx"),h=o("./src/Resources/public/js/routing-constants.js"),y=o("./node_modules/ol/index.js"),f=o("./node_modules/ol/geom.js"),g=o("./node_modules/ol/format.js"),_=o("./node_modules/ol/extent.js"),v=o("./node_modules/ol/proj.js"),b=o("./node_modules/ol/style.js"),C=o("./node_modules/ol/layer.js"),R=o("./node_modules/ol/source.js"),S=o("./node_modules/ol/geom/Polygon.js"),E=o("./node_modules/ol/interaction.js"),O=(r(o("./node_modules/ol/format/OSMXML.js")),o("./src/Resources/public/js/c4g-routing-permalink.js")),w=o("./src/Resources/public/js/routing-constant-i18n.js"),T=o("./src/Resources/public/js/c4g-maps-constant.js"),k=o("./src/Resources/public/js/c4g-maps-utils.js"),I=o("./src/Resources/public/js/components/c4g-router-popup-buttons.jsx");function L(e,t,o){return t=(0,u.default)(t),(0,c.default)(e,j()?Reflect.construct(t,o||[],(0,u.default)(e).constructor):t.apply(e,o))}function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(j=function(){return!!e})()}var P=d.default.lazy(function(){return Promise.resolve().then(o.bind(o,"./src/Resources/public/js/components/c4g-titlebar.jsx"))}),x=d.default.lazy(function(){return o.e("src_Resources_public_js_components_c4g-router-controls_jsx").then(o.bind(o,"./src/Resources/public/js/components/c4g-router-controls.jsx"))});t.RouterView=function(e){function t(e){var o;(0,l.default)(this,t),(o=L(this,t,[e])).setActiveId=o.setActiveId.bind(o),o.setOpen=o.setOpen.bind(o),o.close=o.close.bind(o),o.openControls=o.openControls.bind(o),o.resetFromPoint=o.resetFromPoint.bind(o),o.resetToPoint=o.resetToPoint.bind(o),o.resetAreaPoint=o.resetAreaPoint.bind(o),o.toggleResultDetails=o.toggleResultDetails.bind(o),o.setResultInstr=o.setResultInstr.bind(o),o.setResultFeat=o.setResultFeat.bind(o),o.recalculateRoute=o.recalculateRoute.bind(o);var r=o.props.mapController,a=[];for(var s in o.languageConstants=(0,w.getLanguage)(r.data),r.data.router_profiles)r.data.router_profiles.hasOwnProperty(s)&&a.push({id:s,text:r.data.router_profiles[s]});var n=null,i=null,c=null,u=null;if(r.data.showFeatures){var p=r.data.routerLayers;for(var d in p)p.hasOwnProperty(d)&&(n=n||d,c=Object.keys(p[n])[0]||c,i=i||d,u=Object.keys(p[i])[0]||u)}return o.state={router:e.router,objSettings:{proxyUrl:r&&r.data?r.data.proxyUrl:"",keyAutocomplete:r&&r.data?r.data.autocomplete:"",center:function(){var e=r.map.getView().getCenter();return e=(0,v.transform)(e,"EPSG:3857","EPSG:4326")},resultCount:r.data.geosearch.result_count,geosearchParams:r.data.geosearch.params},activeId:null,openResults:!1,containerAddresses:{arrFromPositions:[],arrFromNames:[],arrToPositions:[],arrToNames:[],arrAreaPositions:[],arrAreaNames:[],arrOverPositions:{},arrOverNames:{}},fromAddress:"",toAddress:"",areaAddress:"",layerRoute:n,layerArea:i,layerValueRoute:c,layerValueArea:u,detourRoute:!(!e.detourRoute||!e.detourRoute.initial)&&e.detourRoute.initial,detourArea:!(!e.detourArea||!e.detourArea.initial)&&e.detourArea.initial,featureList:{features:[],type:""},mode:r.data.initialMode,overPtCtr:0,overAddresses:[],featureSource:void 0,routerWaySource:void 0,areaCircleSource:void 0,routerHintSource:void 0,areaPoint:null,fromPoint:null,toPoint:null,overPoints:[],profiles:a||[],currentProfile:a&&a[0]&&a[0].id?a[0].id:0,open:"routing"===e.mapController.data.initial_open_comp||!1,openSettings:"routing"===e.mapController.data.initial_open_comp||!1,routerInstructions:{},resultMode:e.mapController.data.initialResultMode||"instr"},o.popupRouteButtonWrapper="",o.swapPoints=o.swapPoints.bind(o),r.data.usePermalink&&(o.permalink=new O.RoutingPermalink(o)),o.profileTranslation={0:"car",1:"hgv",2:"bike",3:"bike",4:"bike",5:"bike",6:"bike",7:"bike",8:"foot",9:"foot",10:"wheelchair",11:"hgv",12:"scooter",13:"scooter"},o.init(),o}return(0,p.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=this.props.mapController.data,o={waySource:this.state.routerWaySource,hintSource:this.state.routerHintSource,featureSource:this.state.featureSource},r={};"route"===this.state.mode?r={min:t.detourRoute&&t.detourRoute.min?t.detourRoute.min:0,max:t.detourRoute&&t.detourRoute.max?t.detourRoute.max:100,value:this.state.detourRoute,router:this}:"area"===this.state.mode&&(r={min:t.detourArea&&t.detourArea.min?t.detourArea.min:0,max:t.detourArea&&t.detourArea.max?t.detourArea.max:100,value:this.state.detourArea,router:this});var a,s={from:this.resetFromPoint,to:this.resetToPoint,area:this.resetAreaPoint},n=this.createOverSettings(),l="";"route"===this.state.mode?l=this.props.mapController.data.routerHeadline||this.languageConstants.ROUTER_DEFAULT_HEADLINE_ROUTE:"area"===this.state.mode&&(l=this.props.mapController.data.areaHeadline||this.languageConstants.ROUTER_DEFAULT_HEADLINE_AREA),this.props.mapController.data.areaSearch&&!this.props.mapController.data.areaSearchOnly&&(a=d.default.createElement("div",{className:"c4g-router-mode-switcher"},d.default.createElement("button",{id:"c4g-router-button-route",className:"route"===this.state.mode?"c4g-active":"c4g-inactive",onMouseUp:function(){e.setMode("route")},title:this.languageConstants.ROUTER_FIND_ROUTE}),d.default.createElement("button",{id:"c4g-router-button-area",className:"area"===this.state.mode?"c4g-active":"c4g-inactive",onMouseUp:function(){e.setMode("area")},title:this.languageConstants.AREA_NAME})));var i=this.state.routerInstructions.instructions,c="",u=[];return this.state.featureList.features.length>0&&(this.state.fromAddress&&this.state.toAddress&&"route"===this.state.mode||this.state.areaAddress&&"area"===this.state.mode)&&u.push(d.default.createElement("button",{id:"c4g-router-button-feature",className:"feat"===this.state.resultMode&&this.state.openResults?"c4g-active":"c4g-inactive",onMouseUp:this.setResultFeat,key:1,title:"Ergebnisliste anzeigen"})),i&&i.length>0&&"route"===this.state.mode&&u.push(d.default.createElement("button",{id:"c4g-router-button-instructions",className:"instr"===this.state.resultMode&&this.state.openResults?"c4g-active":"c4g-inactive",onMouseUp:this.setResultInstr,key:2,title:"Routenhinweise anzeigen"})),this.props.mapController.data.routerResultDiv||u.unshift(d.default.createElement("button",{className:"c4g-router-hide-form-button "+(this.state.openSettings?"c4g-active":"c4g-inactive"),onMouseUp:function(){e.setState({openSettings:!e.state.openSettings})},key:3,title:this.languageConstants.ROUTER_SETTINGS})),u.length>1&&(c=d.default.createElement("div",null,u)),d.default.createElement("div",{className:"c4g-router-wrapper"},d.default.createElement(d.Suspense,{key:0,fallback:d.default.createElement("div",null,"Loading...")},d.default.createElement(P,{wrapperClass:"c4g-router-header",header:l,headerClass:"c4g-router-headline",detailBtnClass:"c4g-router-extended-options",hideContainer:".c4g-router-container-right",detailBtnCb:this.toggleDetails,closeBtnClass:"c4g-router-close",closeBtnCb:this.close,closeBtnTitle:this.languageConstants.CLOSE})),d.default.createElement(d.default.Fragment,null,a,d.default.createElement("div",{className:"c4g-router-switcher"},c)),d.default.createElement(d.Suspense,{key:1,fallback:d.default.createElement("div",null,'"loading"')},d.default.createElement(x,{router:this,open:this.props.mapController.data.routerResultDiv||this.state.open&&this.state.openSettings,setOpen:this.openControls,profiles:this.state.profiles,className:"c4g-router-panel",objSettings:this.state.objSettings,objFunctions:this.objFunctions,overSettings:n,enableOverPoints:this.props.mapController.data.enableOverPoints,sources:o,layers:this.props.mapController.data.routerLayers,containerAddresses:this.state.containerAddresses,resetFunctions:s,mapController:this.props.mapController,currentProfile:this.state.currentProfile,fromAddress:this.state.fromAddress,switchTargets:this.props.mapController.data.enableTargetSwitch,toAddress:this.state.toAddress,areaAddress:this.state.areaAddress,mode:this.state.mode,sliderOptions:r,title:this.languageConstants.CTRL_ROUTER,target:this.props.target})),d.default.createElement(d.Suspense,{key:2,fallback:d.default.createElement("div",null,'"loading"')},d.default.createElement(m.RouterResultContainer,{visible:this.state.open,open:this.state.open&&this.state.openResults,setOpen:this.setOpen,direction:"bottom",className:"c4g-router-result-container",mapController:this.props.mapController,mode:this.state.mode,setResultFeat:this.setResultFeat,routerInstructions:this.state.routerInstructions,featureList:this.state.featureList,routerWaySource:this.state.routerWaySource,detour:this.state.detourArea,layerRoute:this.state.layerRoute,layerValueRoute:this.state.layerValueRoute,layerArea:this.state.layerArea,resultMode:this.state.resultMode,router:this,layerValueArea:this.state.layerValueArea,routerHintSource:this.state.routerHintSource,featureSource:this.state.featureSource,profile:this.state.currentProfile,activeId:this.state.activeId,setActiveId:this.setActiveId,detailOpen:this.state.resultDetailOpen,toggleDetailOpen:this.toggleResultDetails,headline:"Router Ergebnisse",lang:this.languageConstants})))}},{key:"setResultInstr",value:function(e){e.stopPropagation(),this.setState({resultMode:"instr",openResults:!0})}},{key:"setResultFeat",value:function(e){e.stopPropagation(),this.setState({resultMode:"feat",openResults:!0})}},{key:"close",value:function(){this.setState({open:!1})}},{key:"getProfileById",value:function(e){for(var t=0;t<this.state.profiles.length;t++)if(parseInt(this.state.profiles[t].id,10)===parseInt(e,10))return this.state.profiles[t];return null}},{key:"toggleResultDetails",value:function(){this.state.resultDetailOpen?this.setState({resultDetailOpen:!1}):this.setState({resultDetailOpen:!0})}},{key:"openControls",value:function(e){e?(this.props.mapController.setOpenComponent(this),this.setState({open:!0,openSettings:!0}),jQuery(this.props.mapController.routerContainer).removeClass("c4g-close").addClass("c4g-open")):this.setState({open:!1})}},{key:"componentDidMount",value:function(){this.props.mapController.data.usePermalink&&this.permalink.handleInitialParams(),this.props.mapController.data.router_div&&this.setState({open:!0})}},{key:"componentDidUpdate",value:function(e,t,o){if(this.props.mapController.data.usePermalink){var r=this.permalink.linkFragments;this.state.fromPoint&&r.fromAddress&&r.fromAddress[0]!==this.state.fromPoint.getCoordinates()[0]&&r.fromAddress[1]!==this.state.fromPoint.getCoordinates()[1]&&this.permalink.updateLinkFragments("fromAddress",this.state.fromPoint.getCoordinates()),this.state.toPoint&&r.toAddress&&r.toAddress[0]!==this.state.toPoint.getCoordinates()[0]&&r.toAddress[1]!==this.state.toPoint.getCoordinates()[1]&&this.permalink.updateLinkFragments("toAddress",this.state.toPoint.getCoordinates()),this.state.areaPoint&&r.addressArea&&r.addressArea[0]!==this.state.areaPoint.getCoordinates()[0]&&r.addressArea[1]!==this.state.areaPoint.getCoordinates()[1]&&this.permalink.updateLinkFragments("addressArea",this.state.areaPoint.getCoordinates()),r.mode!==this.state.mode&&this.permalink.updateLinkFragments("mode",this.state.mode),r.detourArea!==this.state.detourArea&&this.permalink.updateLinkFragments("detourArea",this.state.detourArea),r.detourRoute!==this.state.detourRoute&&this.permalink.updateLinkFragments("detourRoute",this.state.detourRoute)}if(!0===t.open&&!1===this.state.open&&(this.routerLayerGroup.setVisible(!1),this.modWayInteraction.setActive(!1),jQuery(this.props.mapController.routerContainer).removeClass("c4g-open").addClass("c4g-close")),this.state.open&&!t.open&&(this.props.mapController.hideOtherComponents(this),this.routerLayerGroup.setVisible(!0),this.modWayInteraction.setActive(!0),jQuery(this.props.mapController.routerContainer).addClass("c4g-open").removeClass("c4g-close"),this.state.openSettings||this.state.openResults||this.setState({openSettings:!0})),this.state.openSettings&&!t.openSettings&&this.setState({openResults:!1}),this.state.openResults&&!t.openResults&&this.setState({openSettings:!1}),this.state.openResults||this.state.openSettings||!t.openSettings||this.setState({openSettings:!0}),this.state.openSettings||this.state.openResults||!t.openResults||this.setState({openResults:!0}),"route"!==this.state.mode||this.state.fromAddress&&this.state.toAddress||!this.state.openResults||"area"!==t.mode||this.setState({openResults:!1}),this.props.mapController.data.caching){var a=k.utils.getValue("panel");"RouterView"!==a||this.state.open?"RouterView"!==a&&this.state.open&&k.utils.storeValue("panel","RouterView"):k.utils.storeValue("panel","")}if(t.activeId!==this.state.activeId){if(t.activeId){var s=this.routerFeaturesSource.getFeatureById(t.activeId);if(s){var n=s.get("oldStyle");s.setStyle(n)}}var l=this.routerFeaturesSource.getFeatureById(this.state.activeId);if(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.clickLocstyle]&&!this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.clickLocstyle].style&&(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.clickLocstyle].style=this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.clickLocstyle].getStyleFunction()),l&&this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.clickLocstyle]){l.set("oldStyle",l.getStyle());var i=this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.clickLocstyle].style;l.setStyle(i)}}}},{key:"setProfile",value:function(e){this.setState({currentProfile:e},this.updateRouteLayersAndPoints)}},{key:"setLayer",value:function(e){var t=this.props.mapController.data.routerLayers[e],o=Object.keys(t)[0];"route"===this.state.mode?this.setState({layerRoute:e,layerValueRoute:o},this.recalculateRoute):this.setState({layerArea:e,layerValueArea:o},this.performArea)}},{key:"setLayerValue",value:function(e){var t=this;"route"===this.state.mode?this.setState({layerValueRoute:e},function(){t.showFeatures(t.state.featureList.features,t.state.featureList.type,"router",!1)}):"area"===this.state.mode&&this.setState({layerValueArea:e},function(){t.showFeatures(t.state.featureList.features,t.state.featureList.type,"area",!1)})}},{key:"setActiveId",value:function(e){this.setState({activeId:e})}},{key:"setOpen",value:function(e){this.setState({openResults:e})}},{key:"setAreaPoint",value:function(e,t){var o=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.performReverseSearch("areaAddress",[e,t]);var r=new f.Point([e,t]);this.setState({areaPoint:r},function(){return o.updateRouteLayersAndPoints()})}},{key:"setRouteFrom",value:function(e,t){var o=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.performReverseSearch("fromAddress",[e,t]);var r=new f.Point([e,t]);this.setState({fromPoint:r},function(){o.updateRouteLayersAndPoints()})}},{key:"setRouteTo",value:function(e,t){var o=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.performReverseSearch("toAddress",[e,t]);var r=new f.Point([e,t]);this.setState({toPoint:r},function(){return o.updateRouteLayersAndPoints()})}},{key:"addOverPoint",value:function(e,t,o){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this,s=this.state.overAddresses,n=this.state.overPtCtr;n++,r?s.splice(o,1,e+", "+t):this.performReverseSearch("overAddress",[e,t],o);var l=new f.Point([e,t]),i=this.state.overPoints;i.splice(o,1,l),this.setState({overPoints:i,overAddresses:s,overPtCtr:n},function(){return a.updateRouteLayersAndPoints()})}},{key:"addOverPoints",value:function(e){for(var t=this,o=this.state.overAddresses,r=this.state.overPoints,a=this.state.overPtCtr,s=0;s<e.length;s++){var n=(0,v.toLonLat)(e[s],"EPSG:3857"),l=new f.Point([n[0],n[1]]);r.push(l),o.push(n[0]+", "+n[1]),a++}this.setState({overPoints:r,overAddresses:o,overPtCtr:a},function(){return t.updateRouteLayersAndPoints()})}},{key:"setMode",value:function(e){var t=this;if(this.state.mode!==e){var o={waySource:this.routerWaySource,altWaySource:this.routingAltWaySource,hintSource:this.state.routerHintSource,featureSource:this.state.featureSource,locationSource:this.locationsSource};this.setState({mode:e,openResults:!1,openSettings:!0},function(){for(var e in o)o.hasOwnProperty(e)&&o[e]&&o[e].clear();t.updateRouteLayersAndPoints()})}}},{key:"swapPoints",value:function(){var e=this.state.toPoint,t=this.state.toAddress,o=this.state.fromPoint,r=this.state.fromAddress,a=this.state.containerAddresses,s=a.arrFromNames,n=a.arrFromPositions;a.arrFromNames=a.arrToNames,a.arrFromPositions=a.arrToPositions,a.arrToNames=s,a.arrToPositions=n,this.setState({fromPoint:e,fromAddress:t,toPoint:o,toAddress:r,containerAddresses:a},this.updateRouteLayersAndPoints)}},{key:"createOverSettings",value:function(){var e=this,t={};t.overAddresses=this.state.overAddresses,t.overPoints=this.state.overPoints,t.overPtCtr=this.state.overPtCtr,t.overFunction=function(){var t=e.state.containerAddresses;t.arrOverNames[e.state.overPtCtr]=[],t.arrOverPositions[e.state.overPtCtr]=[],e.setState({overPtCtr:e.state.overPtCtr+1,containerAddresses:t})},t.swapPoints=this.swapPoints,t.objFunctions={};for(var o=0;o<this.state.overPtCtr;o++)t.objFunctions[o]=this.createAutocompleteFunctionsForOverField(o),t.overAddresses[o]||(t.overAddresses[o]=""),t.overPoints[o]||(t.overPoints[o]=null);return t}},{key:"createAutocompleteFunctionsForOverField",value:function(e){var t=this;return{selectListener:function(o,r){var a,s,n,l=r.item.value,i=t.state.containerAddresses.arrOverNames[e].findIndex(function(e){return e===l}),c=t.state.containerAddresses.arrOverPositions[e][i];(a=t.state.overAddresses)[e]=t.state.containerAddresses.arrOverNames[e][i],n=new f.Point([c[1],c[0]]),(s=t.state.overPoints)[e]=n,t.setState({overPoints:s,overAddresses:a},function(){t.updateRouteLayersAndPoints()})},deleteFunction:function(o){var r=t.state.containerAddresses;r.arrOverPositions[e]=[],r.arrOverNames[e]=[];var a=t.state.overPoints;a.splice(e,1);var s=t.state.overAddresses;s.splice(e,1),t.setState({overPoints:a,containerAddresses:r,overAddresses:s,overPtCtr:t.state.overPtCtr-1},function(){t.updateRouteLayersAndPoints()})},changeListener:function(){}}}},{key:"updateRouteLayersAndPoints",value:function(){var e=this;if(this.locationsSource.clear(),this.areaSource.clear(),"route"===this.state.mode){if(this.state.fromPoint){var t=new y.Feature({geometry:this.state.fromPoint.clone().transform("EPSG:4326","EPSG:3857")});this.props.mapController.data.router_from_locstyle&&this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_from_locstyle]?(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_from_locstyle].style||(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_from_locstyle].style=this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_from_locstyle].getStyleFunction()),t.setStyle(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_from_locstyle].style)):this.props.mapController.proxy.locationStyleController.loadLocationStyles([this.props.mapController.data.router_from_locstyle],{done:function(){e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_from_locstyle].style||(e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_from_locstyle].style=e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_from_locstyle].getStyleFunction()),t.setStyle(e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_from_locstyle].style)}}),this.locationsSource.addFeature(t)}if(this.state.toPoint){var o=new y.Feature({geometry:this.state.toPoint.clone().transform("EPSG:4326","EPSG:3857")});this.props.mapController.data.router_to_locstyle&&this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_to_locstyle]?(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_to_locstyle].style||(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_to_locstyle].style=this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_to_locstyle].getStyleFunction()),o.setStyle(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_to_locstyle].style)):this.props.mapController.proxy.locationStyleController.loadLocationStyles([this.props.mapController.data.router_to_locstyle],{done:function(){e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_to_locstyle].style||(e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_to_locstyle].style=e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_to_locstyle].getStyleFunction()),o.setStyle(e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_to_locstyle].style)}}),this.locationsSource.addFeature(o)}if(this.state.fromPoint&&this.state.toPoint||this.routerWaySource.clear(),this.state.overPoints&&Object.keys(this.state.overPoints).length>0)for(var r in this.state.overPoints)if(this.state.overPoints.hasOwnProperty(r)&&null!==this.state.overPoints[r]){var a=new y.Feature({geometry:this.state.overPoints[r].clone().transform("EPSG:4326","EPSG:3857")});this.props.mapController.data.router_interim_locstyle&&this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_interim_locstyle]&&(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_interim_locstyle].style||(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_interim_locstyle].style=this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_interim_locstyle].getStyleFunction()),a.setStyle(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.router_interim_locstyle].style)),this.locationsSource.addFeature(a)}this.props.mapController.data.routeStartButton||this.recalculateRoute()}else if("area"===this.state.mode){if(this.state.areaPoint){var s=new y.Feature({geometry:this.state.areaPoint.clone().transform("EPSG:4326","EPSG:3857")});this.props.mapController.data.areaCenterLocstyle&&this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.areaCenterLocstyle]?(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.areaCenterLocstyle].style||(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.areaCenterLocstyle].style=this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.areaCenterLocstyle].getStyleFunction()),s.setStyle(this.props.mapController.proxy.locationStyleController.arrLocStyles[this.props.mapController.data.areaCenterLocstyle].style)):this.props.mapController.proxy.locationStyleController.loadLocationStyles([this.props.mapController.data.areaCenterLocstyle],{done:function(){e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.areaCenterLocstyle].style||(e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.areaCenterLocstyle].style=e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.areaCenterLocstyle].getStyleFunction()),s.setStyle(e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.areaCenterLocstyle].style)}}),this.areaSource.addFeature(s)}this.performArea()}}},{key:"resetFromPoint",value:function(){var e=this,t=e.state.containerAddresses;t.arrFromPositions=[],t.arrFromNames=[],this.setState({fromPoint:null,containerAddresses:t,fromAddress:""},function(){e.updateRouteLayersAndPoints()})}},{key:"resetToPoint",value:function(){var e=this,t=e.state.containerAddresses;t.arrToPositions=[],t.arrToNames=[],this.setState({toPoint:null,containerAddresses:t,toAddress:""},function(){e.updateRouteLayersAndPoints()})}},{key:"resetAreaPoint",value:function(){var e=this,t=e.state.containerAddresses;t.arrAreaPositions=[],t.arrAreaNames=[],this.setState({areaPoint:null,containerAddresses:t,areaAddress:""},function(){e.updateRouteLayersAndPoints()})}},{key:"createAutocompleteFunctions",value:function(){var e={},t=this;return e.fromFunctions={selectListener:function(e,o){var r=o.item.value,a=t.state.containerAddresses.arrFromNames.findIndex(function(e){return e===r}),s=t.state.containerAddresses.arrFromPositions[a],n=new f.Point([s[1],s[0]]);t.setState({fromPoint:n,fromAddress:t.state.containerAddresses.arrFromNames[a]},function(){t.updateRouteLayersAndPoints(),t.recalculateRoute()})},deleteFunction:function(e){t.resetFromPoint()},changeListener:function(){}},e.toFunctions={selectListener:function(e,o){var r=o.item.value,a=t.state.containerAddresses.arrToNames.findIndex(function(e){return e===r}),s=t.state.containerAddresses.arrToPositions[a],n=new f.Point([s[1],s[0]]);t.setState({toPoint:n,toAddress:t.state.containerAddresses.arrToNames[a]},function(){t.updateRouteLayersAndPoints(),t.recalculateRoute()})},deleteFunction:function(e){t.resetToPoint()},changeListener:function(){}},e.areaFunctions={selectListener:function(e,o){var r=o.item.value,a=t.state.containerAddresses.arrAreaNames.findIndex(function(e){return e===r}),s=t.state.containerAddresses.arrAreaPositions[a],n=new f.Point([s[1],s[0]]);t.setState({areaPoint:n,areaAddress:t.state.containerAddresses.arrAreaNames[a]},function(){t.updateRouteLayersAndPoints(),t.performArea()})},deleteFunction:function(e){var o=t.state.containerAddresses;o.arrAreaPositions=[],o.arrAreaNames=[],t.setState({areaPoint:null,containerAddresses:o,areaAddress:""},function(){})},changeListener:function(){}},e}},{key:"addPopupHook",value:function(){var e=this;window.c4gMapsHooks.proxy_appendPopup=window.c4gMapsHooks.proxy_appendPopup||[],window.c4gMapsHooks.proxy_appendPopup.push(function(t){var o=t.mapController,r=t.popup;if(o.components.router&&r.popup.routing_link)if(3!==parseInt(o.data.popupHandling,10)){var a=function(t){var o=t.feature,r=e,a=function(e){if(r.openControls(!0),r.setMode("route"),jQuery(e.currentTarget).hasClass(T.cssConstants.POPUP_ROUTE_FROM)){var t=(0,v.toLonLat)(o.getGeometry().getCoordinates(),"EPSG:3857");r.setRouteFrom(t[0],t[1])}else{var a=(0,v.toLonLat)(o.getGeometry().getCoordinates(),"EPSG:3857");r.setRouteTo(a[0],a[1])}},s=document.createElement("div");s.className=T.cssConstants.POPUP_ROUTE_WRAPPER;var n=document.createElement("button");n.className=T.cssConstants.ICON+" "+T.cssConstants.POPUP_ROUTE_FROM,jQuery(n).click(a),s.appendChild(n);var l=document.createElement("span");n.appendChild(l);var i=document.createElement("button");i.className=T.cssConstants.ICON+" "+T.cssConstants.POPUP_ROUTE_TO,jQuery(i).click(a),s.appendChild(i);var c=document.createElement("span");return i.appendChild(c),s}(r);$(t.div).append(a)}else if(t.comp){var s={feature:r.feature,router:e};t.comp.setAddButtons(I.RouterPopupButtons,s)}})}},{key:"init",value:function(){var e=this;this.mapData=this.props.mapController.data;var t=[this.props.mapController.data.router_from_locstyle,this.props.mapController.data.router_to_locstyle,this.props.mapController.data.router_point_locstyle,this.props.mapController.data.areaCenterLocstyle,this.props.mapController.data.clickLocstyle];this.props.mapController.data.priorityFeatures&&(this.props.mapController.data.priorityLocstyle&&t.push(this.props.mapController.data.priorityLocstyle),this.props.mapController.data.negativePriorityLocstyle&&t.push(this.props.mapController.data.negativePriorityLocstyle)),this.props.mapController.proxy.locationStyleController.loadLocationStyles(t);var o=this.props.mapController.data;for(var r in this.objLayers={},o.routerLayers)o.routerLayers.hasOwnProperty(r)&&(this.objLayers[r]=o.routerLayers[r][Object.keys(o.routerLayers[r])[0]]);this.routingAltWaySource=new R.Vector,this.routerWaySource=new R.Vector,this.areaCircleSource=new R.Vector;var a=this.mapData.areaCircleColor,s=parseInt(this.mapData.areaCircleOpacity)||0===parseInt(this.mapData.areaCircleOpacity)?this.mapData.areaCircleOpacity:50,n=new b.Style({fill:new b.Fill({color:k.utils.getRgbaFromHexAndOpacity(a,s)})});this.areaCircleLayer=new C.Vector({source:this.areaCircleSource,zIndex:-1,style:[n,new b.Style({stroke:new b.Stroke({color:"rgba(0, 51, 119, 0.9)",width:4}),zIndex:-1})]}),this.routerWayLayer=new C.Vector({source:this.routerWaySource,zIndex:1,style:[new b.Style({stroke:new b.Stroke({color:"rgba(255, 255, 255, 0.6)",width:8})}),new b.Style({stroke:new b.Stroke({color:"rgba(0, 51, 119, 0.9)",width:4})})]}),this.routerAltWayLayer=new C.Vector({source:this.routingAltWaySource,zIndex:0,style:[new b.Style({stroke:new b.Stroke({color:"rgba(255, 255, 255, 0.6)",width:8})}),new b.Style({stroke:new b.Stroke({color:"rgba(0, 51, 119, 0.4)",width:4})})]});var l=new E.Select({style:[new b.Style({stroke:new b.Stroke({color:"rgba(255, 255, 255, 0.0)",width:8})}),new b.Style({stroke:new b.Stroke({color:"rgba(255, 51, 119, 0.0)",width:4})})]});l.on("select",function(t){var o=t.selected[0];if(o){var r=o.getGeometry();r&&"LineString"===r.getType()?e.showAltRoute(e.response,o.getId()):o&&e.clickFeatureEntryForFeature(o)}}),this.mapSelectInteraction=l,this.modWayInteraction=new E.Modify({source:this.routerWaySource,style:[new b.Style({stroke:new b.Stroke({color:"rgba(255, 255, 255, 0.0)",width:8})}),new b.Style({stroke:new b.Stroke({color:"rgba(255, 51, 119, 0.0)",width:4})})]}),this.modWayInteraction.on("modifystart",function(t){!0===e.state.open&&(e.modifyStartPoint=new f.Point(t.mapBrowserEvent.coordinate).transform("EPSG:3857","EPSG:4326"))}),this.modWayInteraction.on("modifyend",function(t){if(!0===e.state.open){var o,r=new f.Point(t.mapBrowserEvent.coordinate).transform("EPSG:3857","EPSG:4326"),a=1/0,s=Object.keys(e.state.overPoints);if(s.length>0){for(var n in e.state.overPoints)if(e.state.overPoints.hasOwnProperty(n)){var l=e.calcDistance(e.modifyStartPoint.getCoordinates(),e.state.overPoints[n].getCoordinates());l<a&&(a=l,o=n)}var i=e.calcDistance(e.state.fromPoint.getCoordinates(),e.modifyStartPoint.getCoordinates()),c=e.calcDistance(e.state.toPoint.getCoordinates(),e.modifyStartPoint.getCoordinates()),u=e.calcDistance(e.state.fromPoint.getCoordinates(),e.state.overPoints[0].getCoordinates()),p=s[s.length-1],d=e.calcDistance(e.state.toPoint.getCoordinates(),e.state.overPoints[p].getCoordinates());i<u?o=0:c<d&&o++}else o=0;e.performReverseSearch("overAddress",r.getCoordinates(),o),e.addOverPoint(r.getCoordinates()[0],r.getCoordinates()[1],o)}}),e.props.mapController.map.addInteraction(l),this.props.mapController.data.enableOverPoints&&e.props.mapController.map.addInteraction(this.modWayInteraction),l.setActive(!1),this.routerHintSource=new R.Vector,this.routerHintLayer=new C.Vector({source:this.routerHintSource,style:function(t,o){return!e.props.mapController.proxy||e.props.mapController.proxy.locationStyleController.arrLocStyles[e.props.mapController.data.router_point_locstyle].style(t,o)}}),this.locationsSource=new R.Vector,this.locationsLayer=new C.Vector({source:this.locationsSource,zIndex:2}),this.areaSource=new R.Vector,this.areaLayer=new C.Vector({source:this.areaSource,zIndex:2}),this.routerFeaturesSource=new R.Vector,this.routerFeaturesLayer=new C.Vector({source:this.routerFeaturesSource,zIndex:20}),this.routerLayerGroup=new C.Group({layers:new y.Collection([this.routerWayLayer,this.areaCircleLayer,this.routerAltWayLayer,this.locationsLayer,this.routerHintLayer,this.routerFeaturesLayer,this.locationsLayer,this.areaLayer]),visible:!0}),this.props.mapController.map.addLayer(this.routerLayerGroup),"route"===this.props.mapController.data.initialMode||this.viewArea,this.routeInstructions={};var i=this.props.mapController.data.profile;this.geoSearchApi=this.props.mapController.data.api.geosearch+"/"+i,this.geoReverseSearchApi=this.props.mapController.data.api.geosearch_reverse+"/"+i,this.routingApi=this.props.mapController.data.api.routing+"/"+i,this.usePermalink&&this.permalinkHandler.handleInitialParams(),this.objFunctions=this.createAutocompleteFunctions(),this.addPopupHook(),this.addMapInputInteraction()}},{key:"calcDistance",value:function(e,t){var o,r;return o=Math.pow(e[0]-t[0],2),r=Math.pow(e[1]-t[1],2),Math.sqrt(o+r)}},{key:"showRouteInstructions",value:function(e,t,o,r){t=t||0;var a,s,n,l="",i="",c="",u="";if(this.props.mapController.data.showInstructions&&((s=document.createElement("div")).className=h.routingConstants.ROUTER_INSTRUCTIONS_HEADER,e)){if(e.features&&e.features.length>0&&this.props.mapController.data.showFeatures||jQuery(".c4g-router-instructions-wrapper").css("display","block"),"1"==this.props.mapController.data.router_api_selection||"1"==e.routeType)e.routes[t].legs[0].summary&&(l=e.routes[t].legs[0].summary.split(",")[0],i=e.routes[t].legs[0].summary.split(",")[1],e.routes[t].legs[1]&&(i=e.routes[t].legs[1].summary.split(",")[1])),c=e.routes[t].distance,u=e.routes[t].duration;else if("0"==this.props.mapController.data.router_api_selection||"0"==e.routeType)e.route_name&&(l=e.route_name[0],i=e.route_name[1]),e.route_summary&&(c=e.route_summary.total_distance,u=e.route_summary.total_time);else if("2"==this.props.mapController.data.router_api_selection||"2"==e.routeType){u=e.routes[t].summary.duration,c=e.routes[t].summary.distance;for(var p=[],d=e.routes[t].segments,m=0;m<d.length;m++)for(var y=d[m],f=0;f<y.steps.length;f++){var g=y.steps[f];g.length=g.distance/1e3,p.push(g)}this.routeInstructions[t]={time:u,distance:c,instructions:p},this.setState({routerInstructions:this.routeInstructions[t],routerWaySource:o,routerHintSource:r})}else if("3"==this.props.mapController.data.router_api_selection||"3"==e.routeType){c=e.paths[t].distance,u=e.paths[t].time/1e3;for(var _=[],v=e.paths[t].instructions,b=0;b<v.length;b++){var C=v[b];C.length=C.distance/1e3,C.instruction=C.text,C.type=C.sign,_.push(C)}this.routeInstructions[t]={time:u,distance:c,instructions:_},this.setState({routerInstructions:this.routeInstructions[t],routerWaySource:o,routerHintSource:r})}else"4"!=this.props.mapController.data.router_api_selection&&"4"!=e.routeType&&"6"!=this.props.mapController.data.router_api_selection&&"6"!=e.routeType||(c=1e3*e.trip.summary.length,u=e.trip.summary.time,this.routeInstructions[t]={time:u,distance:c,instructions:e.trip.legs[t].maneuvers},this.setState({routerInstructions:this.routeInstructions[t],routerWaySource:o,routerHintSource:r}));l&&i?s.innerHTML="<label>"+this.languageConstants.ROUTER_VIEW_LABEL_ROUTE+"</label> <em>"+l+" &#8594; "+i+"</em><br><label>"+this.languageConstants.ROUTER_VIEW_LABEL_DISTANCE+"</label> <em>"+c+"</em><br><label>"+this.languageConstants.ROUTER_VIEW_LABEL_TIME+"</label> <em>"+u+"</em><br>":this.routeProfile&&this.routeProfile.active&&Array.isArray(this.routeProfile.active)&&(s.innerHTML="<label>"+this.languageConstants.ROUTER_VIEW_LABEL_PROFILE+"</label> <em>"+this.props.mapController.data.router_profiles[this.routeProfile.active]+"</em><br><label>"+this.languageConstants.ROUTER_VIEW_LABEL_DISTANCE+"</label> <em>"+c+"</em><br><label>"+this.languageConstants.ROUTER_VIEW_LABEL_TIME+"</label> <em>"+u+"</em><br>"),a=document.createElement("div"),n='<table class="'+h.routingConstants.ROUTER_INSTRUCTIONS_TABLE+'" cellpadding="0" cellspacing="0">',"1"===this.props.mapController.data.router_api_selection||"1"==e.routeType||"0"===this.props.mapController.data.router_api_selection||"0"==e.routeType||"2"===this.props.mapController.data.router_api_selection||"2"==e.routeType||"3"===this.props.mapController.data.router_api_selection||"3"==e.routeType||"4"===this.props.mapController.data.router_api_selection||e.routeType,n+="</table>",a.innerHTML=n,this.adjustInstructionMapInteraction()}}},{key:"performGeoSearch",value:(r=(0,n.default)(s.default.mark(function e(t){var r,a,n,l,i,c;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(r=this).geoSearchApi+"?format=json&limit=1&q="+encodeURI(t),n=r.props.mapController.map,l=n.getView().calculateExtent(n.getSize()),l=(0,v.transformExtent)(l,n.getView().getProjection(),"EPSG:4326"),i="&viewbox="+l[0]+","+l[1]+","+l[2]+","+l[3],this.mapData&&this.mapData.geosearch&&this.mapData.geosearch.searchKey&&this.mapData.geosearch.url&&(a=this.mapData.geosearch.url+"search.php?key="+this.mapData.geosearch.searchKey+"&format=json&limit=1&q="+encodeURI(t)+i),this.mapData.geosearch.params)for(c in this.mapData.geosearch.params)this.mapData.geosearch.params.hasOwnProperty(c)&&(a+="&"+c+"="+this.mapData.geosearch.params[c]);return e.next=1,fetch(a).then(function(e){if(e)return e.json().then(function(e){return[parseFloat(e[0].lon),parseFloat(e[0].lat)]});Promise.all([o.e("vendors-CoreBundle_node_modules_sweetalert2_dist_sweetalert2_all_js"),o.e("CoreBundle_src_Resources_public_vendor_js_AlertHandler_js")]).then(o.bind(o,"../CoreBundle/src/Resources/public/vendor/js/AlertHandler.js")).then(function(e){(new e.AlertHandler).showInfoDialog(r.props.langConstants.ROUTER_VIEW_ALERT_ERROR,r.props.langConstants.ROUTER_VIEW_ALERT_ADDRESS)})}).catch(function(){Promise.all([o.e("vendors-CoreBundle_node_modules_sweetalert2_dist_sweetalert2_all_js"),o.e("CoreBundle_src_Resources_public_vendor_js_AlertHandler_js")]).then(o.bind(o,"../CoreBundle/src/Resources/public/vendor/js/AlertHandler.js")).then(function(e){(new e.AlertHandler).showInfoDialog(r.props.langConstants.ROUTER_VIEW_ALERT_ERROR,r.props.langConstants.ROUTER_VIEW_ALERT_ADDRESS)})});case 1:return e.abrupt("return",e.sent);case 2:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"performSearch",value:function(e,t,r){var a,s,n,l,i;if(l=this,""===e.val())return delete l[t],"";if(s=(a=l.props.mapController.map).getView().calculateExtent(a.getSize()),n="&viewbox="+(s=(0,v.transformExtent)(s,a.getView().getProjection(),"EPSG:4326"))[0]+","+s[1]+","+s[2]+","+s[3],i=l.geoSearchApi+"?format=json&limit=1&q="+encodeURI(e.val())+n,this.mapData&&this.mapData.geosearch&&this.mapData.geosearch.searchKey&&this.mapData.geosearch.url&&(i=this.mapData.geosearch.url+"search.php?key="+this.mapData.geosearch.searchKey+"&format=json&limit=1&q="+encodeURI(e.val())+n),this.mapData.geosearch.params)for(var c in this.mapData.geosearch.params)this.mapData.geosearch.params.hasOwnProperty(c)&&(i+="&"+c+"="+this.mapData.geosearch.params[c]);return jQuery.ajax({url:i}).done(function(a){if(a.length>0)if("overValue"===t){l.overValue||(l.overValue=[]);for(var s=new f.Point([parseFloat(a[0].lon),parseFloat(a[0].lat)]),n=e.next()[0];!jQuery(n).hasClass("c4g-router-input-clear");)n=jQuery(n).next()[0];n.id=s.ol_uid,l.overValue.push(s),l.$buttonOver.prop("disabled",!1)}else{var i=[parseFloat(a[0].lon),parseFloat(a[0].lat)],c=new f.Point(i);"fromValue"===t?l.setState({fromPoint:c,fromAddress:e.val()},function(){return l.updateRouteLayersAndPoints()}):"toValue"===t?l.setState({toPoint:c,toAddress:e.val()},function(){return l.updateRouteLayersAndPoints()}):"areaValue"===t&&l.setState({areaPoint:c,areaAddress:e.val()})}else Promise.all([o.e("vendors-CoreBundle_node_modules_sweetalert2_dist_sweetalert2_all_js"),o.e("CoreBundle_src_Resources_public_vendor_js_AlertHandler_js")]).then(o.bind(o,"../CoreBundle/src/Resources/public/vendor/js/AlertHandler.js")).then(function(e){(new e.AlertHandler).showInfoDialog(l.props.langConstants.ROUTER_VIEW_ALERT_ERROR,l.props.langConstants.ROUTER_VIEW_ALERT_ADDRESS)});r&&"function"==typeof r&&r()}).fail(function(){Promise.all([o.e("vendors-CoreBundle_node_modules_sweetalert2_dist_sweetalert2_all_js"),o.e("CoreBundle_src_Resources_public_vendor_js_AlertHandler_js")]).then(o.bind(o,"../CoreBundle/src/Resources/public/vendor/js/AlertHandler.js")).then(function(e){(new e.AlertHandler).showInfoDialog(l.props.langConstants.ROUTER_VIEW_ALERT_ERROR,l.props.langConstants.ROUTER_VIEW_ALERT_ADDRESS)})}),""}},{key:"performReverseSearch",value:function(e,t,o){var r,a=this;r=this.geoReverseSearchApi+"?format=json&lat="+t[1]+"&lon="+t[0],this.mapData&&this.mapData.geosearch&&this.mapData.geosearch.reverseKey&&this.mapData.geosearch.url&&(r=this.mapData.geosearch.url+"reverse.php?key="+this.mapData.geosearch.reverseKey+"&format=json&lat="+t[1]+"&lon="+t[0]),jQuery.ajax({url:r}).done(function(t){if(t){var r="";switch(t.address&&((t.address.road||t.address.path||t.address.pedestrian)&&(r+=t.address.road||t.address.path||t.address.pedestrian,t.address.house_number&&(r+=" "+t.address.house_number)),(t.address.city||t.address.town)&&(r+=r?", ":"",r+=t.address.city||t.address.town)),""===r&&(r=t.display_name),e){case"areaAddress":a.setState({areaAddress:r},function(){""===jQuery("#areaInput").val()&&jQuery("#areaInput").val(r)});break;case"fromAddress":a.setState({fromAddress:r},function(){""===jQuery("#routingFrom").val()&&jQuery("#routingFrom").val(r)});break;case"toAddress":a.setState({toAddress:r},function(){""===jQuery("#routingTo").val()&&jQuery("#routingTo").val(r)});break;case"overAddress":var s=a.state.overAddresses;s.splice(o,1,r),a.setState({overAddresses:s})}}})}},{key:"performArea",value:function(){var e=this,t=this.state.areaPoint;if(t){if(this.mapData.drawCircle){(0,v.transform)(t.getCoordinates(),"EPSG:4326","EPSG:3857");var o=(0,S.circular)(t.getCoordinates(),1e3*this.state.detourArea,128).transform("EPSG:4326","EPSG:3857"),r=new y.Feature(o);this.areaCircleSource.clear(),this.areaCircleSource.addFeature(r)}var a=[t.getCoordinates()[1],t.getCoordinates()[0]],s="con4gis/areaService/"+this.props.mapController.data.profile+"/"+this.state.layerArea+"/"+this.state.detourArea+"/"+a;s+="?profile="+this.state.currentProfile,e.areaAjax&&e.areaAjax.abort(),e.areaAjax=jQuery.ajax({url:s}).done(function(t){if(e.response=t,t){var o=e.showFeatures(t[0],t[1],"area",!1);e.setState({featureList:{features:o,type:t[1]},featureSource:e.routerFeaturesSource,openResults:!0},function(){e.showFeatures(t[0],t[1],"area",!1)})}})}}},{key:"performViaRoute",value:function(e,t,r){var a,s,n,l,i;if(s=this,this.state.featureSource&&this.state.featureSource.clear(),this.mapSelectInteraction.getFeatures().clear(),e||(e=this.fromPoint)){if(!t){if(!t)return;t=this.toPoint}if(r||this.overPoints&&(r=this.overPoints),n=[e.getCoordinates()[1],e.getCoordinates()[0]],l=[t.getCoordinates()[1],t.getCoordinates()[0]],r&&Object.keys(r).length>0)for(var c in i=[],r)r.hasOwnProperty(c)&&r[c]&&i.push([r[c].getCoordinates()[1],r[c].getCoordinates()[0]]);if(this.props.mapController.data.router_api_selection>="1"){var u=this.props.mapController.data.profile;if(a="con4gis/routeService/"+this.props.mapController.data.lang+"/"+u+"/"+this.state.layerRoute+"/"+this.state.detourRoute+"/"+n,r)for(var p=0;p<i.length;p++)a+=";"+i[p];return a+=";"+l,a+="?profile="+this.state.currentProfile,s.routeAjax&&s.routeAjax.abort(),s.routeAjax=jQuery.ajax({url:a}).done(function(e){if(s.response=e,e)if(e.error)Promise.all([o.e("vendors-CoreBundle_node_modules_sweetalert2_dist_sweetalert2_all_js"),o.e("CoreBundle_src_Resources_public_vendor_js_AlertHandler_js")]).then(o.bind(o,"../CoreBundle/src/Resources/public/vendor/js/AlertHandler.js")).then(function(t){(new t.AlertHandler).showInfoDialog(s.props.langConstants[e.error])});else if(s.showRouteLayer(e),s.showRouteInstructions(e,0,s.routerWaySource,s.routerHintSource),e.features&&(e.features.elements||e.features.length>0)){var t=s.showFeatures(e.features,e.type,"router");s.setState({featureList:{features:t,type:e.type},featureSource:s.routerFeaturesSource,openResults:!0})}else s.setState({openResults:!0})}).always(function(){s.routeAjax=void 0,s.props.mapController.data.closeAfterSearch}),""}try{return a="con4gis/routeService/"+profileId+"?output=json&instructions=true&alt=false&loc_from="+n+"&loc_to="+l,jQuery.ajax({url:a}).done(function(e){e&&s.showRoute(e)}),""}catch(e){console.log("Please use a more modern API-Version for the Routeservice")}}}},{key:"recalculateRoute",value:function(){"route"===this.state.mode?this.state.fromPoint&&this.state.toPoint&&(this.state.overPoints&&Object.keys(this.state.overPoints).length>0?this.performViaRoute(this.state.fromPoint,this.state.toPoint,this.state.overPoints):this.performViaRoute(this.state.fromPoint,this.state.toPoint)):this.performArea()}},{key:"getActiveLayer",value:function(e){return this.objLayers[e]}},{key:"showFeatures",value:function(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"table",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"router",a=this;if((arguments.length>3?arguments[3]:void 0)||this.routerFeaturesSource.clear(),!(e=e.elements)||0===e.length){var s;if(this.mapData.drawCircle){var n=this.areaCircleSource.getFeatures()[0];if(n&&n.getGeometry()&&n.getGeometry().getExtent()&&(s=n.getGeometry().getExtent()),s&&(0,_.getArea)(s)>0){var l=jQuery(".c4g-sideboard.c4g-open").css("width");l?(l=l.split("."),l=Array.isArray(l)?l[0]:l,l=parseInt(l)+50):l=50;var i=[50,l,50,50];this.props.mapController.map.getView().fit(s,{padding:i})}}return[]}var c=this.mapData,u="route"===this.state.mode?this.state.layerRoute:this.state.layerArea,p="route"===this.state.mode?this.state.layerValueRoute:this.state.layerValueArea,d=this.getActiveLayer(u).layerData,m=[],h=[],g=e.length?e.slice():e.elements.slice(),b=[],C=[];if(this.bestFeatureIds=[],this.worstFeatureIds=[],c.priorityFeatures&&c.priorityLocstyle&&e.length>0){g.sort(function(e,t){return parseFloat(e[c.routerLayers[u][p].mapLabel])-parseFloat(t[c.routerLayers[u][p].mapLabel])});for(var R=parseInt(c.priorityFeatures,10),S=R>g.length?g.length:R,E=R+S>g.length?g.length-S:R,O=0;O<S;O++)b[O]=g[O],this.bestFeatureIds.push(g[O].id);for(var w=g.length-1;w>g.length-1-E;w--)C[w]=g[w],this.worstFeatureIds.push(g[w].id)}t=g,"petrols"===o&&"area"!==r&&(e=e.elements);var T=(0,_.createEmpty)();if("overpass"!==o){for(var k=0;e&&k<e.length;k++)if(e[k].id){var I,L="",j=e[k],P=void 0;I=(0,v.transform)([parseFloat(j.geox),parseFloat(j.geoy)],"EPSG:4326","EPSG:3857");var x=new f.Point(I);(P=new y.Feature(x)).setId(j.id),P.set("loc_linkurl",d.loc_linkurl),P.set("locstyle",d.locstyle),P.set("hover_location",d.hover_location),P.set("hover_style",d.hover_style),P.set("zoom_onclick",d.zoom_onclick),P.set("tid",j.id),c.routerLayers[u]&&c.routerLayers[u][p]&&c.routerLayers[u][p].mapLabel&&j[c.routerLayers[u][p].mapLabel]?L=j[c.routerLayers[u][p].mapLabel]:c.routerLayers[u]&&c.routerLayers[u][p]&&c.routerLayers[u][p].mapLabel&&j.tags&&j.tags[c.routerLayers[u][p].mapLabel]&&(L=j.tags[c.routerLayers[u][p].mapLabel]);var A=j.locstyle||d.locstyle;for(var F in c.priorityFeatures&&c.priorityLocstyle&&(b.includes(j)?A=c.priorityLocstyle:c.negativePriorityLocstyle&&C.includes(j)&&(A=c.negativePriorityLocstyle)),P.set("locationStyle",A),P.set("locstyle",A),P.set("zIndex",k),P.set("label",L),A&&a.props.mapController.proxy.locationStyleController.arrLocStyles[A]?(a.props.mapController.proxy.locationStyleController.arrLocStyles[A].style||(a.props.mapController.proxy.locationStyleController.arrLocStyles[A].style=a.props.mapController.proxy.locationStyleController.arrLocStyles[A].getStyleFunction()),P.setStyle(a.props.mapController.proxy.locationStyleController.arrLocStyles[A].style),a.props.mapController.data.hideFeaturesWithoutLabel?L&&""!==L&&m.push(P):m.push(P)):(P.set("styleId",A),a.props.mapController.data.hideFeaturesWithoutLabel?L&&""!==L&&(m.push(P),h[A]=A):(m.push(P),h[A]=A)),j.tags)j.tags.hasOwnProperty(F)&&P.set(F,j.tags[F]);P&&P.getGeometry()&&P.getGeometry().getExtent()&&(T=(0,_.extend)(T,P.getGeometry().getExtent()))}}else{a.props.mapController.map.getView().getProjection();for(var N=0;N<e.length;N++){var D=new y.Feature;D.set("tid",e[N].id),D.set("id",""+e[N].id),D.setGeometry(new f.Point((0,v.fromLonLat)([e[N].lon,e[N].lat]))),D.set("tags",e[N].tags),D.setId(""+e[N].id),e[N].distance&&D.set("distance",e[N].distance),m.push(D)}var U=c.routerLayers[u][p].mapLabel,M=[];for(var G in m)if(m.hasOwnProperty(G)){m[G].set("loc_linkurl",d.loc_linkurl),m[G].set("locstyle",d.locstyle),m[G].set("hover_location",d.hover_location),m[G].set("hover_style",d.hover_style),m[G].set("zoom_onclick",d.zoom_onclick),m[G].get("id")&&Array.isArray(m[G].get("id"))&&m[G].get("id").includes("/")?m[G].set("tid",parseInt(m[G].get("id").split("/")[1])):m[G].set("tid",m[G].getId());var z={id:m[G].get("tid"),tags:m[G].get("tags")};m[G].get("distance")&&(z.distance=m[G].get("distance")),M.push(z),m[G].set("label",m[G].get(U)),a.props.mapController.proxy.locationStyleController.arrLocStyles[d.locstyle]&&(a.props.mapController.proxy.locationStyleController.arrLocStyles[d.locstyle].style||(a.props.mapController.proxy.locationStyleController.arrLocStyles[d.locstyle].style=a.props.mapController.proxy.locationStyleController.arrLocStyles[d.locstyle].getStyleFunction()),m[G].setStyle(a.props.mapController.proxy.locationStyleController.arrLocStyles[d.locstyle].style)),m[G]&&m[G].getGeometry().getExtent()&&(T=(0,_.extend)(T,m[G].getGeometry().getExtent()))}t=M}if(h&&h.length>0&&a.props.mapController.proxy.locationStyleController.loadLocationStyles(h,{done:function(){for(var e=0;e<m.length;e++){var t=m[e].get("locstyle");a.props.mapController.proxy.locationStyleController.arrLocStyles[t].style||(a.props.mapController.proxy.locationStyleController.arrLocStyles[t].style=a.props.mapController.proxy.locationStyleController.arrLocStyles[t].getStyleFunction()),m[e].setStyle(a.props.mapController.proxy.locationStyleController.arrLocStyles[t].style)}a.setState({featureSource:a.routerFeaturesSource}),h=void 0}}),m&&m.length>0&&this.routerFeaturesSource.addFeatures(m),this.mapData.drawCircle){var H=this.areaCircleSource.getFeatures()[0];H&&H.getGeometry()&&H.getGeometry().getExtent()&&(T=(0,_.extend)(T,H.getGeometry().getExtent()))}if((0,_.getArea)(T)>0){var B=jQuery(".c4g-sideboard.c4g-open").css("width");B?(B=B.split("."),B=Array.isArray(B)?B[0]:B,B=parseInt(B)+50):B=50;var V=[50,B,50,50];this.props.mapController.map.getView().fit(T,{padding:V})}return t}},{key:"showRoute",value:function(e){this.showRouteLayer(e,0),this.showRouteInstructions(e,0)}},{key:"showAltRoute",value:function(e,t){this.showRouteLayer(e,t),this.showRouteInstructions(e,t)}},{key:"showRouteLayer",value:function(e,t){var o,r,a,s;if(t=t||0,e&&(this.routerWaySource.clear(),this.routingAltWaySource.clear(),o=this.props.mapController.map.getView(),"1"==this.props.mapController.data.router_api_selection||"2"==this.props.mapController.data.router_api_selection||"1"==e.routeType||"2"==e.routeType?(r=new g.Polyline,e.routes&&(e.routes[1]&&(1===t?(s=r.readFeatures(e.routes[0].geometry,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(0):(s=r.readFeatures(e.routes[1].geometry,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(1)),(a=r.readFeatures(e.routes[t].geometry,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(t))):"0"==this.props.mapController.data.router_api_selection||"0"==e.routeType?a=(r=new g.Polyline({factor:this.props.mapController.data.router_viaroute_precision||1e6})).readFeatures(e.route_geometry,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}):"3"==this.props.mapController.data.router_api_selection?(r=new g.Polyline,e.paths&&e.paths[1]&&(1==t?(s=r.readFeatures(e.paths[0].points,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(0):(s=r.readFeatures(e.paths[1].points,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(1)),(a=r.readFeatures(e.paths[t].points,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(t)):"4"!=this.props.mapController.data.router_api_selection&&"4"!=e.routeType||(r=new g.Polyline({factor:1e6}),e.trip&&e.trip.legs&&e.trip.legs[1]&&(1==t?(s=r.readFeatures(e.trip.legs[1].shape,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(0):(s=r.readFeatures(e.trip.legs[1].shape,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(1)),(a=r.readFeatures(e.trip.legs[t].shape,{dataProjection:"EPSG:4326",featureProjection:o.getProjection()}))[0].setId(t)),"1"==this.props.mapController.data.router_alternative&&(e.routes&&e.routes.length>1&&e.routes[1]||e.paths&&e.paths.length>1&&e.paths[1])&&this.routingAltWaySource.addFeatures(s),a)){this.routerWaySource.addFeatures(a),this.props.mapController.map.renderSync(),o.animate({start:+new Date,duration:2e3,resolution:o.getResolution(),center:[0,0]});var n=jQuery(".c4g-starboard-container").css("width");n?(n=n.split("."),n=Array.isArray(n)?n[0]:n,n=parseInt(n)+50):n=50,o.fit(a[0].getGeometry(),{size:this.props.mapController.map.getSize(),padding:[50,n,50,50]})}}},{key:"adjustInstructionMapInteraction",value:function(e){var t,o,r,a=this;t=function(e){a.routerHintSource.clear();var t=a.routerWaySource.getFeatures()[0].getGeometry().getCoordinates(),o=e.data("pos");if(o){var r=o.split(",");r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1]);var s=(0,v.fromLonLat)(r),n=new y.Feature({geometry:new f.Point(s)});a.routerHintSource.addFeature(n),a.options.mapController.map.getView().setCenter(s)}if(t){var l=e.data("start"),i=e.data("end");if(i){var c=new f.LineString(t.slice(l,i));(n=new y.Feature({geometry:c})).setStyle(new b.Style({stroke:new b.Stroke({color:"rgba(255, 0, 0, 1)",width:20})}));var u=a.options.mapController.map.getView().getZoom();a.routerHintSource.addFeature(n),a.options.mapController.map.getView().fit(c);var p=a.options.mapController.map.getView().getZoom(),d=Math.round((u+p)/2);d=d>p?p:d,a.options.mapController.map.getView().setZoom(d)}}},o=function(e){var t;if(a.routerWaySource&&a.routerWaySource.getFeatures()&&"0"==a.options.mapController.data.router_api_selection&&(t=a.routerWaySource.getFeatures()[0])){a.routerHintSource.clear();var o=new y.Feature({geometry:new f.Point(t.getGeometry().getCoordinates()[e.data("pos")])});a.routerHintSource.addFeature(o)}if(a.routerWaySource&&a.routerWaySource.getFeatures()&&a.options.mapController.data.router_api_selection>="1"&&(t=a.routerWaySource.getFeatures()[0])){a.routerHintSource.clear();var r=e.data("pos");if(r){var s=r.split(",");s[0]=parseFloat(s[0]),s[1]=parseFloat(s[1]);var n=(0,v.fromLonLat)(s);o=new y.Feature({geometry:new f.Point(n)}),a.routerHintSource.addFeature(o)}var l=(t=a.routerWaySource.getFeatures()[0]).getGeometry().getCoordinates();if(l){var i=e.data("start"),c=e.data("end");c&&((o=new y.Feature({geometry:new f.LineString(l.slice(i,c))})).setStyle(new b.Style({stroke:new b.Stroke({color:"rgba(255, 0, 0, 1)",width:15})})),a.routerHintSource.addFeature(o))}}},r=function(){a.routerHintSource.clear()},jQuery("[data-start]",e).each(function(e,a){var s=jQuery(a);s.click(function(){t(s)}),s.on("mouseenter",function(){o(s)}),s.on("mouseleave",function(){r()})}),jQuery("[data-pos]",e).each(function(e,a){var s=jQuery(a);s.click(function(){t(s)}),s.on("mouseenter",function(){o(s)}),s.on("mouseleave",function(){r()})})}},{key:"addMapInputInteraction",value:function(){var e,t=this;t.fnMapRouterInteraction=function(o){if(!0===t.state.open){var r=t.props.mapController.map.forEachFeatureAtPixel(o.pixel,function(e,t){return e});if(r&&r.getId()){var a=r.getId().search&&r.getId().search("/")?parseFloat(r.getId().substring(r.getId().search("/")+1)):r.getId();t.setState({activeId:a,openResults:!0},function(){if(document.querySelector(".c4g-route-feature-wrapper")){var e=document.querySelector(".c4g-route-feature-wrapper"),t=document.querySelector("li.route-features-list-element.c4g-active");e&&t&&e.scrollTo(0,t.offsetTop)}})}else if(e=(0,v.toLonLat)(o.coordinate),t.areaSource.clear(),"route"===t.state.mode){if(""===t.state.fromAddress)t.setRouteFrom(e[0],e[1]),t.recalculateRoute();else if(""===t.state.toAddress)t.setRouteTo(e[0],e[1]),t.recalculateRoute();else if(t.state.overPtCtr>0)for(var s=0;s<t.state.overPtCtr;s++)if(!t.state.overPoints[s]){t.addOverPoint(e[0],e[1],s);break}}else"area"===t.state.mode&&""===t.state.areaAddress&&t.setAreaPoint(e[0],e[1])}},this.props.mapController.map.on("click",t.fnMapRouterInteraction)}}]);var r}(d.Component)},"./src/Resources/public/js/components/c4g-titlebar.jsx"(e,t,o){var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),l=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),c=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),u=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var o,r,s={__proto__:null,default:e};if(null===e||"object"!=a(e)&&"function"!=typeof e)return s;if(o=t){if(o.has(e))return o.get(e);o.set(e,s)}for(var n in e)"default"!==n&&{}.hasOwnProperty.call(e,n)&&((r=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,n))&&(r.get||r.set)?o(s,n,r):s[n]=e[n]);return s}(e)}(o("./node_modules/react/index.js"));function p(e,t,o){return t=(0,i.default)(t),(0,l.default)(e,d()?Reflect.construct(t,o||[],(0,i.default)(e).constructor):t.apply(e,o))}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(d=function(){return!!e})()}t.default=function(e){function t(e){return(0,s.default)(this,t),p(this,t,[e])}return(0,c.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this,t="";this.props.detailBtnClass&&this.props.detailBtnCb&&(t=u.default.createElement("button",{className:this.props.detailBtnClass,onMouseUp:this.props.detailBtnCb}));var o="";this.props.closeBtnClass&&this.props.closeBtnCb&&(o=u.default.createElement("button",{className:this.props.closeBtnClass,onMouseUp:this.props.closeBtnCb,title:this.props.closeBtnTitle}));var r="";return this.props.hideContainer&&(r=u.default.createElement("button",{className:"c4g-sideboard-hide",onMouseUp:function(){jQuery(e.props.hideContainer).removeClass("c4g-open").addClass("c4g-close")}})),u.default.createElement("div",{className:this.props.wrapperClass},u.default.createElement("span",{className:this.props.headerClass},this.props.header),r,o,t,this.props.children)}}])}(u.Component)},"./src/Resources/public/js/routing-constant-i18n-de.js"(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.routingConstantsGerman=void 0,t.routingConstantsGerman={CTRL_ROUTER:"Router öffnen/schließen",ROUTER_VIEW_ADDRESS_INPUT:"Route finden",ROUTER_FROM_LABEL:"Start",ROUTER_OVER_LABEL:"Zwischenziel",ROUTER_TO_LABEL:"Ziel",ROUTER_CLEAR_TITLE:"Löschen",ROUTER_CLEAR_HTML:"",ROUTER_Label_Interim:"Zwischenziel",ROUTER_DEFAULT_HEADLINE_ROUTE:"Router",ROUTER_DEFAULT_HEADLINE_AREA:"Umkreissuche",ROUTER_SWITCH:"Wechsel von Start und Ziel",ROUTER_OVER:"Zwischenziel hinzufügen",ROUTER_PRINT:"Routenbeschreibung drucken",ROUTER_DOWNLOAD:"Route als GPX herunterladen",ROUTER_EDITOR:"Route in den Editor exportieren",ROUTER_EDITOR_ELEMENT:"Element im Editor.",ROUTER_VIEW_LABEL_ROUTE:"Route:",ROUTER_VIEW_LABEL_DISTANCE:"Entfernung:",ROUTER_VIEW_LABEL_TIME:"Zeit:",ROUTER_VIEW_LABEL_PROFILE:"Profil:",ROUTER_VIEW_ALERT_ERROR:"Fehler",ROUTER_VIEW_ALERT_ADDRESS:"Adresse nicht gefunden.",ROUTER_VIEW_ALERT_GOCODING:"Zugriff auf Geocoder fehlgeschlagen.",ROUTER_ERROR_POLYLINE:"Route konnte nicht berechnet werden.",ROUTER_ERROR_LINESTRING:"Strecke lässt sich nicht im Router.",POPUP_ROUTE_FROM:"Route von hier",POPUP_ROUTE_TO:"Route hierhin",POPUP_ROUTE_EDIT:"Strecke im Router öffnen",ROUTER:"Router",ROUTER_N:"Norden",ROUTER_E:"Ost",ROUTER_S:"Süden",ROUTER_W:"Westen",ROUTER_NE:"Nordost",ROUTER_SE:"Südost",ROUTER_SW:"Südwest",ROUTER_NW:"Nordwest",ROUTER_DIRECTION_0:"Unbekannte Anweisung[ auf <b>%s</b>]",ROUTER_DIRECTION_1:"Geradeaus weiterfahren[ auf <b>%s</b>]",ROUTER_DIRECTION_2:"Leicht rechts abbiegen [auf <b>%s</b>]",ROUTER_DIRECTION_3:"Rechts abbiegen[ auf <b>%s</b>]",ROUTER_DIRECTION_4:"Scharf rechts abbiegen[ auf <b>%s</b>]",ROUTER_DIRECTION_5:"Wenden[ auf <b>%s</b>]",ROUTER_DIRECTION_6:"Scharf links abbiegen[ auf <b>%s</b>]",ROUTER_DIRECTION_7:"Links abbiegen[ auf <b>%s</b>]",ROUTER_DIRECTION_8:"Leicht links abbiegen[ auf <b>%s</b>]",ROUTER_DIRECTION_10:"Fahren Sie Richtung <b>%d</b>[ auf <b>%s</b>]","ROUTER_DIRECTION_11-1":"In den Kreisverkehr einfahren und bei erster Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-2":"In den Kreisverkehr einfahren und bei zweiter Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-3":"In den Kreisverkehr einfahren und bei dritter Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-4":"In den Kreisverkehr einfahren und bei vierter Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-5":"In den Kreisverkehr einfahren und bei fünfter Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-6":"In den Kreisverkehr einfahren und bei sechster Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-7":"In den Kreisverkehr einfahren und bei siebter Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-8":"In den Kreisverkehr einfahren und bei achter Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-9":"In den Kreisverkehr einfahren und bei neunter Möglichkeit[ in Richtung <b>%s</b>] verlassen","ROUTER_DIRECTION_11-x":"In den Kreisverkehr einfahren und bei einer der vielen Möglichkeiten[ in Richtung <b>%s</b>] verlassen",ROUTER_DIRECTION_15:"Sie haben Ihr Ziel erreicht","ROUTER_5.X_TYPE_0":" %m fahren[ auf <b>%s</b>]","ROUTER_5.X_TYPE_1":" %m dem Straßenverlauf folgen[ als <b>%s</b>]","ROUTER_5.X_TYPE_2":" Fahren Sie[ auf <b>%s</b>] los","ROUTER_5.X_TYPE_3":" Das Ziel befindet sich <b>%m</b>","ROUTER_5.X_TYPE_4":" Weiterfahren[ auf <b>%s</b>]","ROUTER_5.X_TYPE_5":" %m [auf <b>%s</b> ]auffahren","ROUTER_5.X_TYPE_6":" %m [auf <b>%s</b> ]abfahren","ROUTER_5.X_TYPE_7":" Den Fahrstreifen %m benutzen [auf <b>%s</b>]","ROUTER_5.X_TYPE_8":" %m abbiegen [auf <b>%s</b>]","ROUTER_5.X_TYPE_9":" Den Fahrstreifen %m benutzen [auf <b>%s</b>]","ROUTER_5.X_TYPE_10":" %m fahren um auf der Straße zu bleiben","ROUTER_5.X_TYPE_11":" Im Kreisverkehr die <b>%z.</b> Ausfahrt nehmen [auf <b>%s</b>]","ROUTER_5.X_TYPE_12":" Im Kreisverkehr die <b>%z.</b> Ausfahrt nehmen [auf <b>%s</b>]","ROUTER_5.X_TYPE_13":" %m fahren [auf <b>%s</b>]","ROUTER_5.X_TYPE_14":" abbiegen[ auf <b>%s</b>]","ROUTER_5.X_MOD_0":"Uturn","ROUTER_5.X_MOD_1":"Scharf rechts","ROUTER_5.X_MOD_2":"Rechts","ROUTER_5.X_MOD_3":"Leicht rechts","ROUTER_5.X_MOD_4":"Geradeaus","ROUTER_5.X_MOD_5":"Leicht links","ROUTER_5.X_MOD_6":"Links","ROUTER_5.X_MOD_7":"Scharf links","ROUTER_5.X_MOD_8":"in der Nähe",ROUTER_FROM:"Start",ROUTER_TO:"Ziel",ROUTER_CENTER:"Zentrum",ROUTER_FIND_ROUTE:"Route finden",ROUTER_LOC_ROUTE_TO:"Route hierhin",ROUTER_ROUTEDESC:"Routenbeschreibung",ROUTER_ROUTENAME:"Route",ROUTER_DISTANCE:"Distanz",ROUTER_TIME:"Zeit",ROUTER_REV_GEOCODING:"Ermittle Adresse...",ROUTER_ERROR_REV_GEOCODING:"Fehler beim Ermitteln der Adresse",ROUTER_SEARCHING:"Suche Adresse...",ROUTER_ERROR_SEARCHING:"Fehler beim Suchen der Adresse",ROUTER_CALC_ROUTE:"Berechne Route...",ROUTER_ERROR_CALC_ROUTE:"Fehler beim Berechnen der Route",ROUTER_SETTINGS:"Routeneinstellungen",AREA_NAME:"Umkreissuche",AREA_PROFILE:"Profil",AREA_FEATURECOUNT:"Gefundene Elemente",ROUTE_DETOUR:"Umweg",AREA_DETOUR:"Radius",INSTRUCTION_HEADLINE:"Routenbeschreibung",FEATURES_HEADLINE:"Lokationen",ROUTE_POSITION:"Position ermitteln",START_ROUTE:"Suche starten",REMOVE_ADDRESS:"Adresse löschen",CAR:"Auto",BIKE:"Fahrrad",ROADBIKE:"Rennrad",MOUNTAINBIKE:"Mountainbike",ELECTRICBIKE:"E-Bike",TRUCK:"Lastkraftwagen",WALK:"FußgängerIn",WANDER:"WandererIn",WHEEL:"Rollstuhl",SCOOT:"Roller",MOTORBIKE:"Motorrad",CLOSE:"Schließen",NONE:""}},"./src/Resources/public/js/routing-constant-i18n-en.js"(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.routingConstantsEnglish=void 0,t.routingConstantsEnglish={ROUTER_VIEW_ADDRESS_INPUT:"Find route",ROUTER_FROM_LABEL:"Start",ROUTER_TO_LABEL:"End",ROUTER_CLEAR_TITLE:"Delete",ROUTER_CLEAR_HTML:"",ROUTER_Label_Interim:"Interim Goal",ROUTER_DEFAULT_HEADLINE_ROUTE:"Router",ROUTER_DEFAULT_HEADLINE_AREA:"Area search",ROUTER_SWITCH:"Switch between Start and End",ROUTER_OVER:"Add interim goal",ROUTER_PRINT:"Print route description",ROUTER_DOWNLOAD:"Download route as GPX",ROUTER_EDITOR:"Export route into the editor",ROUTER_EDITOR_ELEMENT:"Element in the editor",POPUP_ROUTE_FROM:"Route from here",POPUP_ROUTE_TO:"Route to here",POPUP_ROUTE_EDIT:"Open line in router",ROUTER_VIEW_LABEL_ROUTE:"Route:",ROUTER_VIEW_LABEL_DISTANCE:"Distance:",ROUTER_VIEW_LABEL_TIME:"Time:",ROUTER_VIEW_LABEL_PROFILE:"Profile",ROUTER_VIEW_ALERT_Error:"Error",ROUTER_VIEW_ALERT_ADDRESS:"Address not found.",ROUTER_VIEW_ALERT_GOCODING:"No access to geocoding.",ROUTER_ERROR_POLYLINE:"Could not calculate route.",ROUTER_ERROR_LINESTRING:"Could not open line in router.",ROUTER:"Router",ROUTER_N:"Head north",ROUTER_E:"Head east",ROUTER_S:"Head south",ROUTER_W:"Head west",ROUTER_NE:"Head northeast",ROUTER_SE:"Head southeast",ROUTER_SW:"Head southwest",ROUTER_NW:"Head northwest",ROUTER_DIRECTION_0:"unknown direction[ onto <b>%s</b>]",ROUTER_DIRECTION_1:"straight ahead[ onto <b>%s</b>]",ROUTER_DIRECTION_2:"slight right[ onto <b>%s</b>]",ROUTER_DIRECTION_3:"right[ onto <b>%s</b>]",ROUTER_DIRECTION_4:"sharp right[ onto <b>%s</b>]",ROUTER_DIRECTION_5:"turn[ onto <b>%s</b>]",ROUTER_DIRECTION_6:"sharp turn left[ onto <b>%s</b>]",ROUTER_DIRECTION_7:"turn left[ onto <b>%s</b>]",ROUTER_DIRECTION_8:"light turn left[ onto <b>%s</b>]",ROUTER_DIRECTION_10:"drive in direction of <b>%d</b>[ onto <b>%s</b>]","ROUTER_DIRECTION_11-1":"Take the first exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-2":"Take the 2nd exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-3":"Take the 3rd exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-4":"Take the 4th exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-5":"Take the 5th exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-6":"Take the 6th exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-7":"Take the 7th exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-8":"Take the 8th exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-9":"Take the 9th exit in the roundabout[ onto <b>%s</b>]","ROUTER_DIRECTION_11-x":"Take one of the exits in the roundabout[ onto <b>%s</b>]",ROUTER_DIRECTION_15:"Destination reached","ROUTER_5.X_TYPE_0":" Turn %m on[ <b>%s</b>]","ROUTER_5.X_TYPE_1":" Follow the course of the road %m[ as <b>%s</b>]","ROUTER_5.X_TYPE_2":" Depart[ on <b>%s</b>]","ROUTER_5.X_TYPE_3":" Arrive <b>%m</b>","ROUTER_5.X_TYPE_4":" Continue driving[ on <b>%s</b>]","ROUTER_5.X_TYPE_5":" Take the ramp %m[ on <b>%s</b>]","ROUTER_5.X_TYPE_6":" Take the ramp %m[ to exit on<b>%s</b>]","ROUTER_5.X_TYPE_7":" Take the %m site of the fork to[ <b>%s</b>]","ROUTER_5.X_TYPE_8":" Turn %m[ on <b>%s</b>]","ROUTER_5.X_TYPE_9":" Take the lane %m[ on <b>%s</b>]","ROUTER_5.X_TYPE_10":" Turn %m to stay on the road","ROUTER_5.X_TYPE_11":" Leave the roundabout on the %z. exit[ to <b>%s</b>]","ROUTER_5.X_TYPE_12":" Leave the roundabout on the %z. exit[ to <b>%s</b>]","ROUTER_5.X_TYPE_13":" Turn %m[ on <b>%s</b>]","ROUTER_5.X_TYPE_14":" Follow the road %m","ROUTER_5.X_MOD_0":"Uturn","ROUTER_5.X_MOD_1":"sharp right","ROUTER_5.X_MOD_2":"right","ROUTER_5.X_MOD_3":"slight right","ROUTER_5.X_MOD_4":"straight","ROUTER_5.X_MOD_5":"slight left","ROUTER_5.X_MOD_6":"left","ROUTER_5.X_MOD_7":"sharp left","ROUTER_5.X_MOD_8":"somehow",ROUTER_FROM:"Start",ROUTER_TO:"End",ROUTER_CENTER:"Center",ROUTER_FIND_ROUTE:"Find route",ROUTER_LOC_ROUTE_TO:"Route to here",ROUTER_ROUTEDESC:"Description",ROUTER_ROUTENAME:"Route",ROUTER_DISTANCE:"Distance",ROUTER_TIME:"Time",ROUTER_REV_GEOCODING:"Identified address...",ROUTER_ERROR_REV_GEOCODING:"Fault! Can not identifiy address",ROUTER_SEARCHING:"Search address...",ROUTER_ERROR_SEARCHING:"Fault! Can not find address",ROUTER_CALC_ROUTE:"Calc route...",ROUTER_ERROR_CALC_ROUTE:"Fault! Can not calc address",ROUTER_SETTINGS:"Routing settings",CTRL_ROUTER:"Toggle router",AREA_NAME:"Search perimeter",AREA_PROFILE:"Profile",AREA_FEATURECOUNT:"Found features",ROUTE_DETOUR:"Detour",AREA_DETOUR:"Radius",INSTRUCTION_HEADLINE:"Route Instructions",FEATURES_HEADLINE:"Locations",ROUTE_POSITION:"Get user position",START_ROUTE:"Start search",CAR:"Car",BIKE:"Bike",ROADBIKE:"Road bike",MOUNTAINBIKE:"Mountain bike",ELECTRICBIKE:"E-Bike",TRUCK:"Truck",WALK:"Pedestrian",WANDER:"Wanderer",WHEEL:"Wheelchair",SCOOT:"Router",MOTORBIKE:"Motorbike",CLOSE:"Close",NONE:""}},"./src/Resources/public/js/routing-constant-i18n.js"(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.getLanguage=function(e){if(void 0!==e)return"de"===e.lang?jQuery.extend(r.routingConstantsGerman,s.langConstantsGerman):jQuery.extend(a.routingConstantsEnglish,n.langConstantsEnglish)};var r=o("./src/Resources/public/js/routing-constant-i18n-de.js"),a=o("./src/Resources/public/js/routing-constant-i18n-en.js"),s=o("./src/Resources/public/js/c4g-maps-constant-i18n-de.js"),n=o("./src/Resources/public/js/c4g-maps-constant-i18n-en.js")},"./src/Resources/public/js/routing-constants.js"(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.routingConstants=void 0,t.routingConstants={ROUTER_INPUT_WRAPPER:"c4g-router-input-wrapper",ROUTER_PROFILE_WRAPPER:"c4g-router-profile-wrapper",ROUTER_INPUT_FROM:"c4g-router-input-from",ROUTER_INPUT_TO:"c4g-router-input-to",ROUTER_INPUT_OVER:"c4g-router-input-over",ROUTER_INPUT_CLEAR:"c4g-router-input-clear",ROUTER_BUTTONBAR:"c4g-router-buttonbar",ROUTER_ATTRIBUTION_WRAPPER:"c4g-router-attribution-wrapper",ROUTER_INSTRUCTIONS_WRAPPER:"c4g-router-instructions-wrapper",ROUTER_INSTRUCTIONS_HEADER:"c4g-router-instructions-header",ROUTER_SWITCH:"c4g-router-switch",ROUTER_OVER:"c4g-router-over",ROUTER_PRINT:"c4g-router-print",ROUTER_PROFILE_CAR:"c4g-router-profile-car",ROUTER_PROFILE_TRUCK:"c4g-router-profile-hgv",ROUTER_PROFILE_BIKE:"c4g-router-profile-bike",ROUTER_PROFILE_FOOT:"c4g-router-profile-foot",ROUTER_PROFILE_WHEELCHAIR:"c4g-router-profile-wheelchair",ROUTER_PROFILE_SCOOTER:"c4g-router-profile-scooter",ROUTER_INSTRUCTIONS_TABLE:"c4g-router-instruction-table",ROUTER_INSTRUCTIONS_ITEM:"c4g-router-instruction-item",ROUTER_INSTRUCTIONS_ITEM_ODD:"c4g-router-instruction-item--odd",ROUTER_INSTRUCTIONS_ITEM_EVEN:"c4g-router-instruction-item--even",ROUTER_INSTRUCTIONS_ITEM_DIRECTION:"c4g-router-instruction-item_direction",ROUTER_INSTRUCTIONS_ITEM_DIRECTION_ICON:"c4g-router-instruction-item_direction-icon",ROUTER_INSTRUCTIONS_ITEM_DIRECTION_TEXT:"c4g-router-instruction-item_text",ROUTER_INSTRUCTIONS_ITEM_DIRECTION_DISTANCE:"c4g-router-instruction-item_distance",ROUTE_LAYER_VALUES:"c4g-routing-layer-values",ROUTE_LAYERS_SELECT:"c4g-routing-layers-select",ROUTE_TOGGLE:"c4g-routing-toggle",OUTPUT_DETOUR:"c4g-routing-output",ROUTE_START_BUTTON:"c4g-route-search-start",ROUTER_SEARCH:"c4g-router-search",ROUTE_POSITION:"c4g-router-position",ROUTE_ERROR:"c4g-routing-error",NONE:""}}}]);