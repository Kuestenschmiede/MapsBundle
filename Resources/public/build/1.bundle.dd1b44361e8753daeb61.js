(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"./Resources/public/js/components/c4g-feature-filter-item.jsx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureFilterItem=void 0;var s=f(r("./node_modules/babel-runtime/core-js/object/get-prototype-of.js")),a=f(r("./node_modules/babel-runtime/helpers/classCallCheck.js")),i=f(r("./node_modules/babel-runtime/helpers/createClass.js")),n=f(r("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js")),l=f(r("./node_modules/babel-runtime/helpers/inherits.js")),u=r("./node_modules/react/index.js"),o=f(u),c=r("./Resources/public/js/c4g-maps-utils.js");function f(e){return e&&e.__esModule?e:{default:e}}
/*
 * This file is part of con4gis,
 * the gis-kit for Contao CMS.
 *
 * @package   	con4gis
 * @version        6
 * @author  	    con4gis contributors (see "authors.txt")
 * @license 	    LGPL-3.0-or-later
 * @copyright 	Küstenschmiede GmbH Software & Design
 * @link              https://www.con4gis.org
 *
 */t.FeatureFilterItem=function(e){function t(e){return(0,a.default)(this,t),(0,n.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=this;return o.default.createElement("div",{className:"c4g-filter-form-element"},o.default.createElement("label",null,o.default.createElement("input",{type:"radio",onChange:function(r){e.props.filterLayers(t.props.feature.identifier,t.props.parentId,t.props.feature.value)},checked:t.props.checked.identifier===t.props.feature.identifier,value:this.props.feature.identifier}),c.utils.decodeHTML(this.props.feature.translation)))}}]),t}(u.Component)},"./Resources/public/js/components/c4g-feature-filter-list.jsx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureFilterList=void 0;var s=d(r("./node_modules/babel-runtime/core-js/object/get-prototype-of.js")),a=d(r("./node_modules/babel-runtime/helpers/classCallCheck.js")),i=d(r("./node_modules/babel-runtime/helpers/createClass.js")),n=d(r("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js")),l=d(r("./node_modules/babel-runtime/helpers/inherits.js")),u=r("./node_modules/react/index.js"),o=d(u),c=r("./Resources/public/js/c4g-maps-utils.js"),f=r("./Resources/public/js/components/c4g-feature-filter-item.jsx");function d(e){return e&&e.__esModule?e:{default:e}}t.FeatureFilterList=function(e){function t(e){return(0,a.default)(this,t),(0,n.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=null,r="";if(this.props.feature.filters.length>2){this.props.open?(r="c4g-open",t=o.default.createElement("form",null,this.props.feature.filters.map((function(t,r){return o.default.createElement(f.FeatureFilterItem,{feature:t,parentId:e.props.id,checked:e.props.checkedItem,filterLayers:e.props.filterLayers,key:r})})))):r="c4g-close",r+=" fi_"+c.utils.removeUmlauts(this.props.feature.name);var s="all"===this.props.checkedItem.identifier?"":"c4g-item-checked";return o.default.createElement("li",{className:s},o.default.createElement("strong",{className:r,onMouseUp:function(t){e.props.setOpen(e.props.id),t.stopPropagation(),t.preventDefault()}},o.default.createElement("span",null),c.utils.decodeHTML(this.props.feature.name)),t)}r=" fi_"+c.utils.removeUmlauts(this.props.feature.name);var a="c4g-item-checked";return a+="all"===this.props.checkedItem.identifier?"":" clicked",o.default.createElement("li",{className:a},o.default.createElement("img",{src:this.props.feature.image}),o.default.createElement("strong",{className:r,onMouseUp:function(t){e.props.filterLayers(e.props.feature.filters[1].identifier!==e.props.checkedItem.identifier?e.props.feature.filters[1].identifier:"all",e.props.id,e.props.feature.filters[1].identifier!==e.props.checkedItem.identifier?e.props.feature.filters[1].value:void 0),t.stopPropagation(),t.preventDefault()}},c.utils.decodeHTML(this.props.feature.name)))}}]),t}(u.Component);
/*
                      * This file is part of con4gis,
                      * the gis-kit for Contao CMS.
                      *
                      * @package   	con4gis
                      * @version        6
                      * @author  	    con4gis contributors (see "authors.txt")
                      * @license 	    LGPL-3.0-or-later
                      * @copyright 	Küstenschmiede GmbH Software & Design
                      * @link              https://www.con4gis.org
                      *
                      */},"./Resources/public/js/components/c4g-feature-filter-multicheckbox.jsx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureFilterMultiCheckbox=void 0;var s=d(r("./node_modules/babel-runtime/core-js/object/get-prototype-of.js")),a=d(r("./node_modules/babel-runtime/helpers/classCallCheck.js")),i=d(r("./node_modules/babel-runtime/helpers/createClass.js")),n=d(r("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js")),l=d(r("./node_modules/babel-runtime/helpers/inherits.js")),u=r("./node_modules/react/index.js"),o=d(u),c=r("./Resources/public/js/c4g-maps-utils.js"),f=r("./Resources/public/js/components/c4g-feature-multicheckbox-item.jsx");function d(e){return e&&e.__esModule?e:{default:e}}t.FeatureFilterMultiCheckbox=function(e){function t(e){return(0,a.default)(this,t),(0,n.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=null,r=void 0;if(this.props.feature.filters.length>2){this.props.open?(r="c4g-open",t=o.default.createElement("form",null,this.props.feature.filters.map((function(t,r){var s=!!e.props.checkedItems.find((function(e){return e.identifier===t.identifier&&e.value===t.value}));return o.default.createElement(f.FeatureFilterMultiCheckboxItem,{feature:t,parentId:e.props.id,checked:s,filterLayers:e.props.filterLayers,key:r})})))):r="c4g-close";var s=null;if(this.props.checkedItems.length>0){var a="all"===this.props.checkedItems[0].identifier?this.props.checkedItems.length-1:this.props.checkedItems.length;s=o.default.createElement("span",{className:"sum"}," ",a," ")}r+=" fi_"+c.utils.removeUmlauts(this.props.feature.name);return o.default.createElement("li",{className:"c4g-item-checked"},o.default.createElement("strong",{className:r,onMouseUp:function(t){e.props.setOpen(e.props.id),t.stopPropagation(),t.preventDefault()}},o.default.createElement("span",null),c.utils.decodeHTML(this.props.feature.name)),s,t)}r+=" fi_"+c.utils.removeUmlauts(this.props.feature.name);var i="c4g-item-checked";return i+=0===this.props.checkedItems.length?"":" clicked",o.default.createElement("li",{className:i},o.default.createElement("img",{src:this.props.feature.image}),o.default.createElement("strong",{className:r,onMouseUp:function(t){e.props.filterLayers(e.props.feature.filters[1].identifier,e.props.id,!0),t.stopPropagation(),t.preventDefault()}},c.utils.decodeHTML(this.props.feature.name)))}}]),t}(u.Component);
/*
                      * This file is part of con4gis,
                      * the gis-kit for Contao CMS.
                      *
                      * @package   	con4gis
                      * @version        6
                      * @author  	    con4gis contributors (see "authors.txt")
                      * @license 	    LGPL-3.0-or-later
                      * @copyright 	Küstenschmiede GmbH Software & Design
                      * @link              https://www.con4gis.org
                      *
                      */},"./Resources/public/js/components/c4g-feature-filter.jsx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=v(r("./node_modules/babel-runtime/core-js/json/stringify.js")),a=v(r("./node_modules/babel-runtime/core-js/object/get-prototype-of.js")),i=v(r("./node_modules/babel-runtime/helpers/classCallCheck.js")),n=v(r("./node_modules/babel-runtime/helpers/createClass.js")),l=v(r("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js")),u=v(r("./node_modules/babel-runtime/helpers/inherits.js")),o=r("./node_modules/react/index.js"),c=v(o),f=r("./Resources/public/js/components/c4g-feature-filter-list.jsx"),d=r("./Resources/public/js/components/c4g-feature-filter-multicheckbox.jsx"),p=(r("./node_modules/ol/style.js"),r("./node_modules/ol/source.js")),h=r("./Resources/public/js/c4g-maps-i18n.js"),m=v(r("./node_modules/opening_hours/build/opening_hours.js"));function v(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,i.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return r.filterLayers=r.filterLayers.bind(r),r.filterLayersMulti=r.filterLayersMulti.bind(r),r.setOpen=r.setOpen.bind(r),r.wrapperRef=c.default.createRef(),r.ulRef=c.default.createRef(),r.handleClickOutside=r.handleClickOutside.bind(r),r.handleClickInside=r.handleClickInside.bind(r),r.filterLayer=r.filterLayer.bind(r),r.filterLayerMulti=r.filterLayerMulti.bind(r),r.hideFeature=r.hideFeature.bind(r),r.hideFeatureMulti=r.hideFeatureMulti.bind(r),r.loadFilters(),r.state={filters:[],open:!0,arrChecked:[],openedList:-1},r.features=[],r.langConstants=(0,h.getLanguage)(e.mapController.data),r.props.mapController.filter=r,r}return(0,u.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this,t=this,r=this.state.filters,s=!1,a=document.querySelector(".c4g-feature-filter-list");s=a?!(a.scrollWidth<=a.clientWidth):t.props.target&&!(t.props.target.scrollWidth<=t.props.target.clientWidth);var i=null;if(parseFloat(this.props.mapController.data.filterResetButton)&&(i=c.default.createElement("button",{className:"c4g-feature-filter-reset",onMouseUp:function(t){return e.resetFilter()}},this.langConstants.RESET_FILTER)),parseFloat(this.props.mapController.data.filterHandling)){if(r&&r.length>0){var n=r.map((function(r,s){var a=t.state.arrChecked[s]||[],i=t.state.openedList===s;return c.default.createElement(d.FeatureFilterMultiCheckbox,{feature:r,open:i,setOpen:e.setOpen,checkedItems:a,filterLayers:e.filterLayersMulti,id:s,key:s})}));return s?c.default.createElement("div",{className:"c4g-feature-filter",ref:this.wrapperRef},c.default.createElement("button",{className:"c4g-btn-nav-previous",onMouseUp:function(t){return e.ulRef.current.scrollLeft-=100}}),c.default.createElement("button",{className:"c4g-btn-nav-next",onMouseUp:function(t){return e.ulRef.current.scrollLeft+=100}}),c.default.createElement("ul",{className:"c4g-feature-filter-list c4g-overflowed",onMouseUp:function(t){return e.handleClickInside(t)},ref:this.ulRef},n),i):c.default.createElement("div",{className:"c4g-feature-filter",ref:this.wrapperRef},c.default.createElement("ul",{className:"c4g-feature-filter-list c4g-not-overflowed",onMouseUp:function(t){return e.handleClickInside(t)},ref:this.ulRef},n),i)}}else if(r&&r.length>0){var l=r.map((function(r,s){var a=t.state.arrChecked[s],i=t.state.openedList===s;return c.default.createElement(f.FeatureFilterList,{feature:r,open:i,setOpen:e.setOpen,checkedItem:a,filterLayers:e.filterLayers,id:s,key:s})}));return s?c.default.createElement("div",{className:"c4g-feature-filter",ref:this.wrapperRef},c.default.createElement("button",{className:"c4g-btn-nav-previous",onMouseUp:function(t){return e.ulRef.current.scrollLeft-=100}}),c.default.createElement("button",{className:"c4g-btn-nav-next",onMouseUp:function(t){return e.ulRef.current.scrollLeft+=100}}),c.default.createElement("ul",{className:"c4g-feature-filter-list c4g-overflowed",onMouseUp:function(t){return e.handleClickInside(t)},ref:this.ulRef},l),i):c.default.createElement("div",{className:"c4g-feature-filter",ref:this.wrapperRef},c.default.createElement("ul",{className:"c4g-feature-filter-list c4g-not-overflowed",onMouseUp:function(t){return e.handleClickInside(t)},ref:this.ulRef},l),i)}return c.default.createElement("div",null)}},{key:"filterLayers",value:function(e,t,r){var s=this,a=this.state.arrChecked;a[t]={identifier:e,value:r},this.setState({arrChecked:a},(function(){s.props.mapController.map.getLayers().getArray().map((function(e,t){s.filterLayer(e)}));for(var e=0;e<s.features.length;e++){if(s.features.hasOwnProperty(e))s.showFeature(s.features[e],e)&&e--}}))}},{key:"filterLayersMulti",value:function(e,t,r){var a=this,i=this.state.arrChecked,n=i[t],l=n.find((function(t){return t.identifier===e&&t.value===r}));if(l)if("all"===e)n=[];else{var u=n.indexOf(l);u>-1&&n.splice(u,1)}else"all"===e?n=JSON.parse((0,s.default)(this.state.filters[t].filters)):n.push({identifier:e,value:r});i[t]=n,this.setState({arrChecked:i},(function(){a.props.mapController.map.getLayers().getArray().map((function(e,t){a.filterLayerMulti(e)}));for(var e=0;e<a.features.length;e++){if(a.features.hasOwnProperty(e))a.showFeatureMulti(a.features[e],e)&&e--}}))}},{key:"setOpen",value:function(e){this.state.openedList===e?this.setState({openedList:-1}):this.setState({openedList:e})}},{key:"resetFilter",value:function(){var e=this,t=[];for(var r in this.state.arrChecked)this.state.arrChecked.hasOwnProperty(r)&&t.push([]);this.setState({arrChecked:t},(function(){for(var t=0;t<e.features.length;t++){if(e.features.hasOwnProperty(t))e.resetFeature(e.features[t],t)&&t--}}))}},{key:"filterLayer",value:function(e){var t=this;if(e.getLayers&&"function"==typeof e.getLayers)e.getLayers().getArray().map((function(e,r){t.filterLayer(e)}));else if(e.getStyle&&"function"==typeof e.getSource){var r=e.getSource()instanceof p.Cluster?e.getSource().getSource():e.getSource();r.forEachFeature((function(e){return t.hideFeature(e,r)}))}}},{key:"filterLayerMulti",value:function(e){var t=this;if(e.getLayers&&"function"==typeof e.getLayers)e.getLayers().getArray().map((function(e,r){t.filterLayerMulti(e)}));else if(e.getStyle&&"function"==typeof e.getSource){var r=e.getSource()instanceof p.Cluster?e.getSource().getSource():e.getSource();r.forEachFeature((function(e){return t.hideFeatureMulti(e,r)}))}}},{key:"checkFeature",value:function(e,t){var r=t.identifier;return"opening_hours"===t.value&&e.get("opening_hours")?new m.default(e.get("opening_hours"),{address:{country_code:"de"}}).getState():!!("all"===r||e.get(r)&&!t.value||t.value==e.get(r)&&t.value)}},{key:"checkFeatureMulti",value:function(e,t){}},{key:"hideFeature",value:function(e,t){var r=this;if(e.get("features")){e.get("features").forEach((function(e){return r.hideFeature(e,t)}))}else{if(e.get("noFilter"))return;var s=!0;for(var a in this.state.arrChecked)this.state.arrChecked.hasOwnProperty(a)&&s&&(s=this.checkFeature(e,this.state.arrChecked[a]));s||(e.set("source",t),this.features.push(e),t.removeFeature(e))}}},{key:"hideFeatureMulti",value:function(e,t){var r=this;if(e.get("features")){e.get("features").forEach((function(e){return r.hideFeatureMulti(e,t)}))}else{if(e.get("noFilter"))return;var s=!1,a=!1;for(var i in this.state.arrChecked)if(this.state.arrChecked.hasOwnProperty(i)){var n=this.state.arrChecked[i];for(var l in n)if(n.hasOwnProperty(l)){a=!0;var u=n[l],o=u.identifier;if(e.get(o)){var c=e.get(o);(u.value&&u.value===c||!u.value)&&(s=!0)}}}!s&&a&&(e.set("source",t),this.features.push(e),t.removeFeature(e))}}},{key:"showFeature",value:function(e,t){var r=!0;for(var s in this.state.arrChecked)this.state.arrChecked.hasOwnProperty(s)&&r&&(r=this.checkFeature(e,this.state.arrChecked[s]));if(r){var a=e.get("source");return e.set("source",!1),a.addFeature(e),this.features.splice(t,1),!0}return!1}},{key:"resetFeature",value:function(e,t){var r=e.get("source");return e.set("source",!1),r.addFeature(e),this.features.splice(t,1),!0}},{key:"showFeatureMulti",value:function(e,t){var r=!1,s=!1;for(var a in this.state.arrChecked)if(this.state.arrChecked.hasOwnProperty(a)){var i=this.state.arrChecked[a];for(var n in i)if(i.hasOwnProperty(n)){s=!0;var l=i[n],u=l.identifier;if(e.get(u)){var o=e.get(u);(l.value&&l.value===o||!l.value)&&(r=!0)}}}if(r||!s){var c=e.get("source");return e.set("source",!1),c.addFeature(e),this.features.splice(t,1),!0}return!1}},{key:"loadFilters",value:function(){var e=this,t=this.props.mapController.data.api.filter+this.props.mapController.data.id+"/"+this.props.mapController.data.lang;fetch(t).then((function(t){return t.json().then((function(t){for(var r=[],s=0;s<t.length;s++)parseFloat(e.props.mapController.data.filterHandling)?r.push([]):r.push({identifier:"all"});e.setState({filters:t,arrChecked:r})}))}))}},{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"handleClickOutside",value:function(e){this.wrapperRef&&this.wrapperRef.current&&!this.wrapperRef.current.contains(e.target)&&this.setState({openedList:-1})}},{key:"handleClickInside",value:function(e){e.nativeEvent.path[0]===e.currentTarget&&this.setState({openedList:-1})}}]),t}(o.Component);
/*
                      * This file is part of con4gis,
                      * the gis-kit for Contao CMS.
                      *
                      * @package   	con4gis
                      * @version        6
                      * @author  	    con4gis contributors (see "authors.txt")
                      * @license 	    LGPL-3.0-or-later
                      * @copyright 	Küstenschmiede GmbH Software & Design
                      * @link              https://www.con4gis.org
                      *
                      */t.default=g},"./Resources/public/js/components/c4g-feature-multicheckbox-item.jsx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureFilterMultiCheckboxItem=void 0;var s=f(r("./node_modules/babel-runtime/core-js/object/get-prototype-of.js")),a=f(r("./node_modules/babel-runtime/helpers/classCallCheck.js")),i=f(r("./node_modules/babel-runtime/helpers/createClass.js")),n=f(r("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js")),l=f(r("./node_modules/babel-runtime/helpers/inherits.js")),u=r("./node_modules/react/index.js"),o=f(u),c=r("./Resources/public/js/c4g-maps-utils.js");function f(e){return e&&e.__esModule?e:{default:e}}
/*
 * This file is part of con4gis,
 * the gis-kit for Contao CMS.
 *
 * @package   	con4gis
 * @version        6
 * @author  	    con4gis contributors (see "authors.txt")
 * @license 	    LGPL-3.0-or-later
 * @copyright 	Küstenschmiede GmbH Software & Design
 * @link              https://www.con4gis.org
 *
 */t.FeatureFilterMultiCheckboxItem=function(e){function t(e){return(0,a.default)(this,t),(0,n.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this;return o.default.createElement("div",{className:"c4g-filter-form-element"},o.default.createElement("label",null,o.default.createElement("input",{type:"checkbox",checked:this.props.checked,onChange:function(e){e.stopPropagation()},onClick:function(t){e.props.filterLayers(e.props.feature.identifier,e.props.parentId,e.props.feature.value)},value:this.props.feature.identifier}),c.utils.decodeHTML(this.props.feature.translation)))}}]),t}(u.Component)}}]);